define("kg/home-2017/1.4.15/common/inject",["kg/pattern/2.1.3/index","kg/home-2017/1.4.15/common/head/index","util"],function(e,o,n){var i=e("kg/pattern/2.1.3/index"),m=e("kg/home-2017/1.4.15/common/head/index"),t=e("util");t.mix(i.prototype,m)});define("kg/home-2017/1.4.15/c/shop/index",["kg/pattern/2.1.3/index","util","url","node","kg/home-2017/1.4.15/c/shop/item.jst.html"],function(t,e,r){function n(t,e){this.el=t,this.conf=e,n.superclass.constructor.apply(this)}var o=t("kg/pattern/2.1.3/index"),i=t("util"),s=t("url"),a=t("node"),l=a.all,u="shop",c="cache-"+u,h=t("kg/home-2017/1.4.15/c/shop/item.jst.html");o.extend(n,{init:function(){var t=this;this.pageSize=5,this.fetch().then(function(e){var r=t.conf,n=t.link;i.each(e,function(e){if(n){var r=t.getArgsStr(e.url),o=n.indexOf("?")>-1?"&":"?";e.url=n+o+"categoryId="+e.categoryId+"&shopId="+e.shopId,r&&(e.url+="&"+r)}});var o=l(".list",t.el);t.render(h,{list:e,moduleinfo:r.moduleinfo},o)})["catch"](function(e){t.reportError({extra:e&&e.message})})},fetch:function(){var t=this;return this.xctrl({data:this.conf,key:["list","modules"],request:"taobao"}).then(function(e){t.el.empty(),t.renderHead(e.modules);var r=e.modules&&e.modules[0];return r&&r.link&&(t.link=r.link),e&&e.list&&e.list.length>=t.pageSize?(t.offline.setItem(c,JSON.stringify(e.list)),e.list):t.getCache()},function(e){return t.el.empty(),t.renderHead(),t.getCache()})},getCache:function(){var t=this.offline.getItem(c);return t?(this.reportCache(),JSON.parse(t)):this.backup()},backup:function(){var t=this;return this.use("p/tbh-"+this.name+"/index",function(e){return t.reportCDN(),e},function(e){t.reportError()})},getArgsStr:function(t){var e=[];try{var r=s.parse(t,!0);return r.query.algArgs&&e.push("algArgs="+r.query.algArgs),r.query.rpos&&e.push("rpos="+r.query.rpos),e.join("&")}catch(n){}},defaults:function(){return{name:"shop",category:"ERR_Shop_DATA_NULl",title:"\u6bcf\u65e5\u597d\u5e97",subtitle:"\u53d1\u73b0\u6df1\u85cf\u7684\u597d\u5e97",logo:"//img.alicdn.com/tfs/TB1_EXwb3oQMeJjy0FpXXcTxpXa-162-48.png",link:"//www.taobao.com/markets/tbhome/cool-shop"}}}),r.exports=n});define("kg/home-2017/1.4.15/c/sale/index",["node","kg/pattern/2.1.3/lib/reporter"],function(e,a,r){function t(e){this.el=e;var a=n("#J_SaleBd",this.el);if(!a.length)return void o({category:"ERROR_Sale_Hook_NotFound",msg:"\u6a21\u5757 Sale \u6e32\u67d3\u94a9\u5b50\u6ca1\u627e\u5230\uff0c\u670d\u52a1\u5668\u6e32\u67d3\u51fa\u4e86\u95ee\u9898"});var r=a.attr("data-use");KISSY.use(r,function(e,a){a?(new a,n(".sale-wrapper").removeClass("loading")):o({category:"ERROR_Sale_Crash",msg:"Sale \u6a21\u5757\u52a0\u8f7d\u521d\u59cb\u5316\u811a\u672c\u5931\u8d25"})})}var l=e("node"),o=e("kg/pattern/2.1.3/lib/reporter"),n=l.all;r.exports=t});define("kg/home-2017/1.4.15/c/live/index",["kg/pattern/2.1.3/index","node","util","kg/home-2017/1.4.15/c/live/item.jst.html","cookie","kg/home-2017/1.4.15/common/pipe/index"],function(e,t,i){function n(e,t){this.conf=t,this.el=e,n.superclass.constructor.apply(this)}var o=e("kg/pattern/2.1.3/index"),a=e("node"),r=e("util"),l=a.all,c=e("kg/home-2017/1.4.15/c/live/item.jst.html"),s=(e("cookie"),e("kg/home-2017/1.4.15/common/pipe/index"));o.extend(n,r.mix({init:function(){var e=this;this.load({len:4,validator:function(t){var i=[],n=[];return r.each(t,function(t){var o=t.data;"video"===t.type&&(e.validator.array.minItems(o.itemList,2)?i.push(t):n.push(o.id))}),i.length>=4?{valid:!0,list:i}:e.validatorError(t,i,n)},normal:!0}).then(function(t){var i=l(".list",e.el);e.render(c,{list:t},i)})["catch"](function(t){e.reportError("render"+t&&t.message)})},defaults:function(){return{name:"live",cacheKey:"TB_Live",cdnKey:"p/tbh-live/index",category:"ERROR_LIVE_Data_err",title:"\u6dd8\u5b9d\u76f4\u64ad",subtitle:"\u4f60\u7684\u7231\u8c46\u76f4\u64ad\u7b49\u4f60\u54df\uff01",logo:"//img.alicdn.com/tfs/TB1cmpCb3MPMeJjy1XdXXasrXXa-204-42.png",noEXP:!0}}},s)),i.exports=n});define("kg/home-2017/1.4.15/c/hotsale/index",["kg/pattern/2.1.3/index","kg/datalazyload/6.0.10/index","node","util","kg/home-2017/1.4.15/c/hotsale/item.jst.html"],function(t,e,i){function n(t,e){this.el=t,this.conf=e;var i=this.conf.moduleinfo.on;s.isTrue(i)&&n.superclass.constructor.apply(this)}var a=t("kg/pattern/2.1.3/index"),h=t("kg/datalazyload/6.0.10/index"),o=t("node").all,s=t("util"),r=t("kg/home-2017/1.4.15/c/hotsale/item.jst.html");a.extend(n,{init:function(){var t=this;o(".hotsale-loading",this.el).remove(),this.renderHeadBar(),this.load().then(s.bind(function(t){var e=t.length;e-=o(".s1190").length?e%4:e%5,t=t.slice(0,e);var i=o(".list",this.el);this.render(r,t,i),o(".hotsale-end",this.el).show(),new h(".tbh-hotsale",{autoDestroy:!0}),this._bind(),this._addTags()},this))["catch"](function(e){t.reportError()})},_bind:function(){var t=this,e=o(window);e.on("resize",function(){var i=o("ul",t.el),n=o("li",i),a=n.length;if(e.width()<1190){if(n.show(),a%4==0)return;n.slice(a%4*-1).hide()}else{if(n.show(),a%5==0)return;n.slice(a%5*-1).hide()}})},load:function(){var t={appid:2493},e=this.conf.moduleinfo.size;return e&&(t.size=e),this.jsonp({url:this.getHost(),data:t,timeout:5}).then(s.bind(function(t){return t&&this.validator.array.minItems(t.result,20)?(t=t.result.slice(0,200),this.offline.setItem(this.cacheKey,JSON.stringify(t)),t):this.getCache()},this),s.bind(function(){return this.getCache()},this))},getCache:function(){var t=this.offline.getItem(this.cacheKey);return t?(this.reportCache(),JSON.parse(t)):this.backup()},backup:function(){return this.use(this.cdnKey,!0).then(s.bind(function(t){return this.reportCDN(),t},this))},_addTags:function(){var t=this;this.xctrl({data:this.conf,key:"map"}).then(function(e){e&&e.map&&e.map.length&&s.each(e.map,function(e){e.tag&&e.img&&e.width&&e.height&&o("."+e.tag,t.el).css({backgroundImage:"url("+e.img+")",width:e.width,height:e.height,left:e.left,top:e.top})})})},getHost:function(){return location.host.indexOf("tb.alibaba-inc.com")!==-1?"//tuipre.taobao.com/recommend":"//tui.taobao.com/recommend"},defaults:function(){return{name:"hotsale",cacheKey:"tbh-hotsale",cdnKey:"p/tbh-hotsale/index",category:"Err_HotSale_load_data_Crash",title:"\u731c\u4f60\u559c\u6b22"}}}),i.exports=n});define("kg/home-2017/1.4.15/c/helper/index",["node","kg/home-2017/1.4.15/c/helper/item.jst.html","kg/pattern/2.1.3/index"],function(e,t,n){function r(){this.loadData.apply(this,arguments)}var l=e("node"),h=e("kg/home-2017/1.4.15/c/helper/item.jst.html"),i=e("kg/pattern/2.1.3/index"),a=l.all,s="cache-helper-tce";i.extend(r,{loadData:function(e,t){var n=this;this.el=e,this.xctrl({data:t,key:"helpers"}).then(function(e){if(e&&e.helpers&&e.helpers.length>0)n.offline.setItem(s,JSON.stringify(e)),n._render(e);else{var t=n.offline.getItem(s);t&&n._render(JSON.parse(t))}})},_render:function(e){var t=a(".helper",this.el);this.render(h,e,t)},defaults:function(){return{name:"helper"}}}),n.exports=r});define("kg/home-2017/1.4.15/c/goods/index",["kg/pattern/2.1.3/index","util","node","kg/home-2017/1.4.15/c/goods/item.jst.html"],function(e,t,i){function r(e,t){this.el=e,this.conf=t,r.superclass.constructor.apply(this)}var s=e("kg/pattern/2.1.3/index"),n=e("util"),o=e("node"),a=o.all,l=e("kg/home-2017/1.4.15/c/goods/item.jst.html"),a=o.all,h=!1,d=!1,c="cache-moduleName";s.extend(r,{init:function(){this.goodEl=a(".list",this.el),this.permalink=this.goodEl.attr("data-permalink"),this.closeHd="1"===this.goodEl.attr("data-hd"),this.load()},_bind:function(){var e=this;this.refreshEl.on("click",function(t){t.halt(),d||(d=!0,e.refreshEl.addClass("disable"),e.load())})},load:function(){var e=this;return this.conf?void this.xctrl({data:JSON.stringify(this.conf),key:["result","modules"],request:"taobao",extra:{startIndex:this.requestTime*this.pageSize,pageSize:this.pageSize}}).then(function(t){return e.requestTime||(e.el.empty(),e.renderHead(t.modules)),t&&t.result&&t.result.length>=e.pageSize?(e.requestTime++,e.offline.setItem(c,JSON.stringify(t.result)),e._render(t.result),void 0):e.getCache()},function(t){return e.requestTime||(e.el.empty(),e.renderHead()),e.getCache()})["catch"](function(t){e.reportError({extra:t&&t.mesage})}):void this._backup()},getCache:function(){var e=this.offline.getItem(c);e?(this.reportCache(),e=JSON.parse(e),this._render(e)):this._backup()},_backup:function(){var e=this;this.use("p/tbh-goods/index").then(function(t){e._render(t),e.reportCDN()},function(t){e.reportError({extra:t&&t.message})})},_render:function(e){var t=this;n.each(e,function(e){if(t.permalink){var i=t.permalink.indexOf("?")>-1?"&":"?";e.url=t.permalink+i+"contentId="+e.contentId}});var i=a(".goods-list",this.el);if(this.render(l,{result:e,closeHd:this.closeHd},i),d=!1,!h){if(h=!0,this.refreshEl=a(".switch",this.el),0===this.refreshEl.length)return;this._bind()}this.refreshEl.removeClass("disable")},defaults:function(){return{requestTime:0,pageSize:6,category:"WARN_Goods_Data_err",name:"goods",title:"\u6709\u597d\u8d27",subtitle:"\u4e0e\u54c1\u8d28\u751f\u6d3b\u4e0d\u671f\u800c\u9047",switcher:!0,logo:"//img.alicdn.com/tfs/TB1tqpnegMPMeJjy1XcXXXpppXa-148-48.png"}}}),i.exports=r});define("kg/home-2017/1.4.15/c/shopping/index",["kg/pattern/2.1.3/index","kg/home-2017/1.4.15/c/shopping/item.jst.html","node","util","kg/home-2017/1.4.15/common/pipe/index"],function(t,n,e){function i(t,n){this.el=r(t),this.conf=n,i.superclass.constructor.apply(this)}var o=t("kg/pattern/2.1.3/index"),a=t("kg/home-2017/1.4.15/c/shopping/item.jst.html"),r=t("node").all,l=t("util"),c=t("kg/home-2017/1.4.15/common/pipe/index");o.extend(i,l.mix({init:function(){var t=this;this.load({len:6,validator:function(n){var e=[];return l.each(n,function(n){t.validator.notEmpty(n.data,["pcUrl","desc","forwardUserAvatar","cover"])&&e.push(n.data)}),e.length>=6?{valid:!0,list:e}:t.validatorError(n,e)},normal:!0}).then(function(n){var e=r(".list",t.el);t.render(a,{list:n},e)})["catch"](function(n){t.reportError("render"+n&&n.message)})},defaults:function(){return{name:"shopping",title:"\u7231\u901b\u8857",subtitle:"\u732e\u7ed9\u806a\u660e\u53ef\u7231\u7684\u4f60",cacheName:"TB_Shopping",logo:"//img.alicdn.com/tfs/TB1UNX2bSFRMKJjy0FhXXX.xpXa-112-46.png"}}},c)),e.exports=i});define("kg/home-2017/1.4.15/c/qiang/index",["kg/pattern/2.1.3/index","kg/home-2017/1.4.15/c/qiang/item.jst.html","node","kg/home-2017/1.4.15/common/pipe/index","util","cookie"],function(t,e,n){function i(t,e){this.el=o(t),this.conf=e,i.superclass.constructor.apply(this)}var s=t("kg/pattern/2.1.3/index"),a=t("kg/home-2017/1.4.15/c/qiang/item.jst.html"),o=t("node").all,r=(t("kg/home-2017/1.4.15/common/pipe/index"),t("util")),c=t("cookie");s.extend(i,{init:function(){this.load()},load:function(){var t=this;return this.xctrl({data:JSON.stringify(this.conf),key:["list","modules"],request:"taobao",extra:{cna:c.get("cna"),request:this.request++}}).then(function(e){var n=void 0,i=void 0,s=e&&e.list&&e.list[0]&&e.list[0].item;if(s&&r.each(s,function(e,a){"current"===e.status&&t.validator.array.minItems(e.itemList,3)&&(n=e.itemList,i=s[a+1])}),t.el.html(""),n){n.length>=6&&(t.switcher=!0),t.renderHead(e.modules),t.noEXP=!0,o(".switch",t.el).on("click",r.bind(t.loadMore,t));var c=o(".list",t.el);t.render(a,{list:n},c),i&&i.startDate&&t.start(i.startDate),t.items=n,t.count=1}else t.hide(),t.reportError("data empty")})["catch"](function(e){t.reportError("render"+e&&e.message),t.hide()})},loadMore:function(){var t=this.items.slice(3*this.count,3*(this.count+1));3===t.length&&(this.count++,this.render(a,{list:t},o(".list",this.el)),this.items.length<3*(this.count+1)&&o(".switch",this.el).addClass("disable"))},hide:function(){this.el.parent(".layer").hide()},start:function(t){var e=r.now();t=parseInt(t),t=new Date(t).getTime();var n=t-e;n<0||this.countdown(n)},countdown:function(t){function e(t){return t<10?"0"+t:""+t}var n=this,i=Math.floor(t/1e3),s=parseInt(i/3600,10)%24,a=parseInt(i/60,10)%60,r=parseInt(i%60,10);s=e(s),a=e(a),r=e(r);var c='\u8ddd\u7ed3\u675f<span class="countdown-wrapper"><span class="hour">'+s+'</span>:<span class="minutes">'+a+'</span>:<span class="seconds">'+r+"</span></span>";o(".subtitle",this.el).html(c),setTimeout(function(){t-=1e3,t<1e3?n.load():n.countdown(t)},1e3)},defaults:function(){return{name:"qiang",title:"\u6dd8\u62a2\u8d2d",subtitle:"",logo:"//img.alicdn.com/tfs/TB1UfJnb3oQMeJjy0FpXXcTxpXa-160-44.png",cacheName:"TB_Qiang",switcher:!0,count:0,request:0}}}),n.exports=i});define("kg/home-2017/1.4.15/c/fashion/index",["kg/pattern/2.1.3/index","kg/home-2017/1.4.15/c/fashion/item.jst.html","node","kg/home-2017/1.4.15/common/pipe/index","util"],function(t,e,i){function n(t,e){this.el=r(t),this.conf=e,n.superclass.constructor.apply(this)}var o=t("kg/pattern/2.1.3/index"),a=t("kg/home-2017/1.4.15/c/fashion/item.jst.html"),r=t("node").all,l=t("kg/home-2017/1.4.15/common/pipe/index"),s=t("util");o.extend(n,s.mix({init:function(){var t=this;this.load({len:3,validator:function(e){var i=[];return s.each(e,function(e){t.validator.notEmpty(e,["bizName","img1","img2","subTitle","targetUrl"])&&i.push(e)}),i.length>=3?{valid:!0,list:i}:t.validatorError(e,i)}}).then(function(e){var i=r(".list",t.el);t.render(a,{list:e},i),t.el.removeClass("tb-loading")})["catch"](function(e){t.reportError("render"+e&&e.message)})},defaults:function(){return{name:"fashion",title:"\u65f6\u5c1a\u7206\u6599\u738b",itemLayer:!0,cacheName:"TB_Fashion"}}},l)),i.exports=n});define("kg/home-2017/1.4.15/c/quality/index",["kg/pattern/2.1.3/index","kg/home-2017/1.4.15/c/quality/item.jst.html","node","cookie","kg/home-2017/1.4.15/common/pipe/index","util"],function(t,e,i){function a(t,e){this.el=o(t),this.conf=e,a.superclass.constructor.apply(this)}var l=t("kg/pattern/2.1.3/index"),n=t("kg/home-2017/1.4.15/c/quality/item.jst.html"),o=t("node").all,r=(t("cookie"),t("kg/home-2017/1.4.15/common/pipe/index")),c=t("util");l.extend(a,c.mix({init:function(){var t=this;this.load({len:7,validator:function(e){var i=[];return c.each(e,function(a,l){0===l&&t.validator.notEmpty(e[0],["targetUrl","img1"])&&i.push(a),l>0&&l<4&&t.validator.notEmpty(a,["bizName","img1","subTitle","targetUrl"])&&i.push(a),l>3&&l<7&&t.validator.notEmpty(a,["bizName","img1","img2","subTitle","targetUrl"])&&i.push(a)}),i.length>=7?{valid:!0,list:i}:t.validatorError(e,i)}}).then(function(e){var i=o(".list",t.el);t.render(n,{hd:e[0],left:e.slice(1,4),right:e.slice(4,7)},i)})["catch"](function(e){t.reportError("render"+e&&e.message)})},defaults:function(){var t=this.el.hasClass("special");return{name:"quality",title:t?"\u7279\u8272\u73a9\u5473\u63a7":"\u54c1\u8d28\u751f\u6d3b\u5bb6",itemLayer:!0,backupName:t?"special":"quality",cacheName:t?"TB_Special":"TB_Quality",noEXP:!!t}}},r)),i.exports=a});define("kg/home-2017/1.4.15/c/afford/index",["kg/pattern/2.1.3/index","kg/home-2017/1.4.15/c/afford/item.jst.html","node","kg/home-2017/1.4.15/common/pipe/index","util"],function(t,e,i){function n(t,e){this.el=a(t),this.conf=e,n.superclass.constructor.apply(this)}var r=t("kg/pattern/2.1.3/index"),o=t("kg/home-2017/1.4.15/c/afford/item.jst.html"),a=t("node").all,l=t("kg/home-2017/1.4.15/common/pipe/index"),c=t("util");r.extend(n,c.mix({init:function(){var t=this;this.load({len:5,validator:function(e){var i=[];return c.each(e,function(e){t.validator.notEmpty(e,["bizName","img1","subTitle","targetUrl"])&&i.push(e)}),i.length>=5?{valid:!0,list:i,useData:!0}:t.validatorError(e,i)}}).then(function(e){var i=a(".list",t.el);t.render(o,{list:e},i)})["catch"](function(e){t.reportError("render"+e&&e.message)})},defaults:function(){return{name:"afford",title:"\u5b9e\u60e0\u4e13\u4e1a\u6237",itemLayer:!0,backupName:"TB_Afford"}}},l)),i.exports=n});