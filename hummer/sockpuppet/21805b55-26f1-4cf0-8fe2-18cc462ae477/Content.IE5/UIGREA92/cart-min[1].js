KISSY.add("cart/lang/zh_TW",function(e,t,i,a){e.getLogger("en");a.exports={TAB_ALL_ITEMS:"\u5168\u90e8\u5546\u54c1",TAB_DISCOUNT_ITEMS:"\u964d\u50f9\u5546\u54c1",TAB_LOW_STOCK:"\u5eab\u5b58\u7dca\u5f35",TH_SELECT_ALL:"\u5168\u9078",TH_ITEM_INFO:"\u5546\u54c1\u4fe1\u606f",TH_UNIT_PRICE:"\u55ae\u50f9",TH_QUANTITY:"\u6578\u91cf",TH_AMOUNT:"\u91d1\u984d",TH_OPERATION:"\u64cd\u4f5c",TH_VILLAGER:"\u8cfc\u8cb7\u5ba2\u6236\u4fe1\u606f",SELECTED_ITEMS:"\u5df2\u9078\u5546\u54c1\uff08\u4e0d\u542b\u904b\u8cbb\uff09",SELECTED_ITEMS_NO_TAX:"\u5df2\u9078\u5546\u54c1\uff08\u4e0d\u542b\u904b\u8cbb\u548c\u9032\u53e3\u7a05\uff09",CHECKOUT:"\u7d50\u7b97",CHECKOUT_BIG:"\u7d50&nbsp;\u7b97",SELLER:"\u5e97\u92ea",INVALID:"\u5931\u6548",SELECT_ITEM_INFO:"\u9078\u64c7\u5546\u54c1\u4fe1\u606f",ITEM:"\u666e\u901a\u5546\u54c1",AFTER_SALE_SERVICE:"\u552e\u5f8c\u670d\u52d9",DISCOUNT_ENJOYED:"\u5df2\u4eab\u512a\u60e0",MODIFY:"\u4fee\u6539",CONFIRM:"\u78ba\u5b9a",CONFIRM_NBSP:"\u78ba&nbsp;\u5b9a",CANCEL:"\u53d6\u6d88",CLOSE_NBSP:"\u95dc&nbsp;\u9589",MULTIPLE_PURCHASE:"\u50c5\u652f\u6301 {num} \u500d\u8cfc\u8cb7",TPL_MULTIPLE_PURCHASE:"\u50c5\u652f\u6301{{amount.multiple}}\u500d\u8cfc\u8cb7",LIMIT_PURCHASE:"\u9650\u8cfc {num} \u4ef6",TPL_LIMIT_PURCHASE:"\u9650\u8cfc{{amount.limit}}\u4ef6",MAX_PURCHASE:"\u6700\u591a\u53ea\u80fd\u8cfc\u8cb7 {num} \u4ef6",TPL_MAX_PURCHASE:"\u6700\u591a\u53ea\u80fd\u8cfc\u8cb7 {{amount.max}} \u4ef6",VILLAGER_ASSOCIATION:"\u60a8\u6709 {num} \u4ef6\u5546\u54c1\u6c92\u6709\u95dc\u806f\u8cfc\u8cb7\u5ba2\u6236",VILLAGER_CANNOT_EMPTY:"\u8cfc\u8cb7\u5ba2\u6236\u4fe1\u606f\u4e0d\u80fd\u70ba\u7a7a",INVALID_PACKAGE:"\u5957\u9910\u5df2\u5931\u6548",TIPS_WANGWANG:"\u9ede\u6b64\u53ef\u4ee5\u76f4\u63a5\u548c\u8ce3\u5bb6\u4ea4\u6d41\u9078\u597d\u7684\u5bf6\u8c9d\uff0c\u6216\u76f8\u4e92\u4ea4\u6d41\u7db2\u8cfc\u9ad4\u9a57\uff0c\u9084\u652f\u6301\u8a9e\u97f3\u8996\u983b\u5662\u3002",WANGWANG_ONLINE:"\u65fa\u65fa\u5728\u7dda",WANGWANG_OFFLINE:"\u65fa\u65fa\u96e2\u7dda",TIPS_PRESELL_BUY:"\u8a72\u5546\u54c1\u70ba\u9810\u552e\u5546\u54c1\uff0c\u60a8\u5df2\u7d93\u4ed8\u904e\u5b9a\u91d1\uff0c\u8a18\u5f97\u6309\u6642\u4f86\u8cfc\u7269\u8eca\u652f\u4ed8\u5c3e\u6b3e\u54e6",TIPS_GROUP_BUY:"\u8a72\u5546\u54c1\u70ba\u805a\u5283\u7b97\u5bf6\u8c9d\uff0c\u76ee\u524d\u6b63\u5728\u9810\u71b1\uff0c\u986f\u793a\u5546\u54c1\u539f\u50f9\uff0c\u66ab\u6642\u7121\u6cd5\u8cfc\u8cb7\uff0c\u958b\u5718\u5f8c\u53ef\u6062\u5fa9\u6b63\u5e38\u8cfc\u8cb7",TIPS_ITEM_INVALID:"\u5546\u54c1\u88ab\u4e0b\u67b6\u3001\u522a\u9664\u3001\u5eab\u5b58\u4e0d\u8db3\uff0c\u6216\u5546\u5bb6\u8655\u65bc\u88ab\u76e3\u7ba1\u6216\u51cd\u7d50\u72c0\u614b",TIPS_ITEM_SELECT:"\u52fe\u9078\u5546\u54c1",TIPS_ITEM_DESELECT:"\u53d6\u6d88\u52fe\u9078\u5546\u54c1",GIFT:"\u8d08\u54c1",REDEEM:"\u63db\u8cfc",MORE:"\u66f4\u591a",PROTECTION:"\u4fdd\u969c",TIPS_NO_STOCK:"\u8a72\u5bf6\u8c9d\u5eab\u5b58\u4e0d\u8db3,\u8acb\u806f\u7cfb\u8ce3\u5bb6",TIPS_LOW_STOCK:"\u8a72\u5546\u54c1\u53ea\u6709 {num} \u4ef6\u4e86\u54e6\uff0c\u8981\u8cb7\u7684\u8d95\u7dca\u554a",TPL_TIPS_LOW_STOCK:"\u8a72\u5546\u54c1\u53ea\u6709{{amount.max}}\u4ef6\u4e86\u54e6\uff0c\u8981\u8cb7\u7684\u8d95\u7dca\u554a",TIPS_LOW_STOCK_POPULAR:"\u8a72\u5546\u54c1\u53ea\u6709 {num} \u4ef6\u4e86\u54e6\uff0c\u4f46\u662f\u6709 {num_people} \u4eba\u5df2\u7d93\u52a0\u5165\u8cfc\u7269\u8eca\u6253\u7b97\u8cfc\u8cb7",TPL_TIPS_LOW_STOCK_POPULAR:"\u8a72\u5546\u54c1\u53ea\u6709{{amount.supply}}\u4ef6\u4e86\u54e6\uff0c\u4f46\u662f\u6709{{amount.demand}}\u4eba\u5df2\u7d93\u52a0\u5165\u8cfc\u7269\u8eca\u6253\u7b97\u8cfc\u8cb7",SIMILAR_ITEMS:"\u67e5\u770b\u540c\u985e\u5bf6\u8c9d",COUDAN:"\u99ac\u4e0a\u53bb\u6e4a\u55ae",SEE_DETAIL:"\u67e5\u770b\u8a73\u60c5",FAV:"\u79fb\u5165\u6536\u85cf\u593e",DELETE:"\u522a\u9664",SIMILAR:"\u76f8\u4f3c\u5bf6\u8c9d",CLEAR_INVALID:"\u6e05\u9664\u5931\u6548\u5bf6\u8c9d",SHARE:"\u5206\u4eab",COMPARE:"\u958b\u59cb\u5c0d\u6bd4",ITEM_NUM_SELECTED:"\u5df2\u9078\u5546\u54c1",ITEM_UNIT:"\u4ef6",ITEM_UNITS:"\u4ef6",TOTAL_MONEY:"\u5408\u8a08\uff08\u4e0d\u542b\u904b\u8cbb\uff09",TOTAL_MONEY_NO_TAX:"\u5408\u8ba1\uff08\u4e0d\u542b\u904b\u8cbb\u548c\u9032\u53e3\u7a05\uff09",COMBINE_NOT_SUPPORTED:"\u4e0d\u652f\u6301\u5408\u4e26\u7d50\u7b97",CANCEL_SELECTION:"\u53d6\u6d88\u9078\u64c7",COD:"\u8ca8\u5230\u4ed8\u6b3e",NORMAL_ITEMS_COUNT:"\u666e\u901a\u5bf6\u8c9d {num} \u4ef6",TMALL_OSDS_ITEMS_COUNT:"\u5929\u8c93\u5168\u7403\u5b98\u65b9\u5e97 {num} \u4ef6",TMALL_HK_ITEMS_COUNT:"\u5929\u8c93\u570b\u969b {num} \u4ef6",MEDICAL_ITEMS_COUNT:"\u91ab\u85e5\u9928 {num} \u4ef6",LIRENGOU_ITEMS_COUNT:"\u5137\u4eba\u8cfc {num} \u4ef6",BACK_TO_TOP:"\u56de\u5230\u9802\u90e8",FEEDBACK:"\u6211\u8981\u53cd\u994b",TIPS_CONFIRM_DELETE_ITEM:"\u78ba\u8a8d\u8981\u522a\u9664\u8a72\u5bf6\u8c9d\u55ce\uff1f",TIPS_CONFIRM_DELETE_ITEMS:"\u78ba\u8a8d\u8981\u522a\u9664\u9019\u4e9b\u5bf6\u8c9d\u55ce\uff1f",DELETE_ITEM:"\u522a\u9664\u5bf6\u8c9d",TIPS_CONFIRM_DELETE_PACKAGE:"\u78ba\u5b9a\u8981\u522a\u9664\u9078\u4e2d\u7684\u5957\u9910\u55ce\uff1f",TIPS_CONFIRM_DELETE_VILLAGER:"\u78ba\u5b9a\u8981\u522a\u9664\u9078\u4e2d\u7684\u8cfc\u8cb7\u5ba2\u6236\u4fe1\u606f\u55ce\uff1f",PROMPT_MESSAGE:"\u63d0\u793a\u4fe1\u606f",TIPS_PLEASE_SELECT_ITEM:"\u8acb\u9078\u64c7\u5bf6\u8c9d",TIPS_NO_INVALID_ITEM:"\u66ab\u6642\u6c92\u6709\u5931\u6548\u7684\u5bf6\u8c9d",TIPS_CONFIRM_CLEAR_INVALID:"\u78ba\u8a8d\u8981\u6e05\u9664\u9019\u4e9b\u5bf6\u8c9d\u55ce\uff1f",TIPS_SUCCESS_FAV:"\u6210\u529f\u79fb\u81f3\u6536\u85cf\u593e\uff01",TIPS_NO_SELECTION:"\u60a8\u9084\u6c92\u6709\u9078\u64c7\u4efb\u4f55\u5bf6\u8c9d",TIPS_ERROR_CART_LOAD:"\u8cfc\u7269\u8eca\u52a0\u8f09\u5931\u6557\uff0c\u8acb\u5237\u65b0\u91cd\u8a66",TIPS_ERROR_SYSTEM_FAILED:"\u5c0d\u4e0d\u8d77\u7cfb\u7d71\u932f\u8aa4\uff0c\u8acb\u5237\u65b0\u91cd\u8a66",TIPS_SEPARATE_CHECKOUT:"\u5982\u679c\u9700\u8981\u8cfc\u8cb750\u4ef6\u4ee5\u4e0a\u5546\u54c1\uff0c\u8acb\u5206\u591a\u6b21\u7d50\u7b97\uff0c\u55ae\u6b21\u6700\u591a\u7d50\u7b9750\u4ef6\u5546\u54c1",TIPS_SELECTED_ITEMS:"\u5df2\u9078\u5546\u54c1\u63d0\u793a",TIPS_ERROR_ADD_CART:"\u52a0\u5165\u8cfc\u7269\u8eca\u5931\u6557\uff0c\u8acb\u7a0d\u5f8c\u91cd\u8a66",TIPS_ERROR_GET_ITEM_INFO:"\u7372\u53d6\u5546\u54c1\u5c6c\u6027\u4fe1\u606f\u5931\u6557\uff0c\u8a72\u5546\u54c1\u53ef\u80fd\u5df2\u7d93\u4e0b\u67b6\u6216\u522a\u9664",COUPONS:"\u512a\u60e0\u5238",TIPS_COUPON_GOT_COUNT:"\u5df2\u9818\u53d6 {num} \u5f35\u512a\u60e0\u5238\uff0c\u6709\u65b0\u512a\u60e0\u5238\u53ef\u9818\u53d6",TPL_TIPS_COUPON_GOT_COUNT:'\u5df2\u9818\u53d6 <em class="J_ReceivedCount">{{receivedCount}}</em> \u5f35\u512a\u60e0\u5238{{#if unreceivedCount > 0}}\uff0c\u6709\u65b0\u512a\u60e0\u5238\u53ef\u9818\u53d6{{/if}}',GET_COUPON:"\u9818 \u53d6",TIPS_LOADING:"\u6b63\u5728\u52aa\u529b\u52a0\u8f09\u4e2d...",TIPS_ERROR_LOADING:"\u8cfc\u7269\u8eca\u52a0\u8f09\u5931\u6557\uff0c\u91cd\u8a66\u4e2d\u2026",PANEL_HOT_SALE:"\u638c\u6ac3\u71b1\u8ce3",PANEL_FAV:"\u6700\u8fd1\u6536\u85cf",PANEL_VIEWED:"\u6700\u8fd1\u700f\u89bd\u904e\u7684",PANEL_LIKE:"\u731c\u4f60\u559c\u6b61\u7684",SOLD_COUNT:"\u92b7\u91cf",GO_TO_FAV:"\u53bb\u6211\u7684\u6536\u85cf\u593e",GO_TO_FOOTPRINT:"\u53bb\u6211\u7684\u8db3\u8de1",TIPS_DATA_LOADING:"\u6578\u64da\u52a0\u8f09\u4e2d\u2026",SELECT_ALL_ITEMS:"\u52fe\u9078\u8cfc\u7269\u8eca\u5167\u6240\u6709\u5546\u54c1",SELECT_ALL:"\u5168\u9078",TIPS_COMPARE_SELECT_AT_LEAST_TWO_ITEMS:"\u81f3\u5c11\u8981\u9078\u64c7\u5169\u4ef6\u5bf6\u8c9d\u624d\u80fd\u9032\u884c\u5c0d\u6bd4",TIPS_CHECKOUT:"\u8acb\u8a3b\u610f\u5982\u679c\u6c92\u6709\u9078\u64c7\u5bf6\u8c9d\uff0c\u5c07\u7121\u6cd5\u7d50\u7b97",ITEM_REDEEMED:"\u63db\u8cfc\u5bf6\u8c9d",PREV_PAGE:"\u4e0a\u4e00\u9801",NEXT_PAGE:"\u4e0b\u4e00\u9801",EXPAND:"\u5c55\u958b",TIPS_COMPARE_MAX_LIMIT:"\u6700\u591a\u652f\u63018\u4ef6\u5bf6\u8c9d\u9032\u884c\u5c0d\u6bd4\uff0c\u60a8\u5df2\u9078\u64c7{num}\u4ef6",TIPS_PLEASE_SELECT_ITEM_NEED_TO_CHECKOUT:"\u8acb\u52fe\u9078\u60a8\u9700\u8981\u7d50\u7b97\u7684\u5bf6\u8c9d",NEED_SEPARATE_CHECKOUT:"\u9700\u8981\u5206\u7d44\u7d50\u7b97",NORMAL_ITEMS:"\u666e\u901a\u5bf6\u8c9d",TMALL_OSDS_ITEMS:"\u5929\u8c93\u5168\u7403\u5b98\u65b9\u5e97",TMALL_HK_ITEMS:"\u5929\u8c93\u570b\u969b",TMALL_SM_ITEMS:"\u5929\u8c93\u8d85\u5e02",MEDICAL_ITEMS:"\u91ab\u85e5\u9928",LIRENGOU_ITEMS:"\u5137\u4eba\u8cfc",TIPS_CANNOT_SELECT_ALL_OVER_50:"\u60a8\u8cfc\u7269\u8eca\u4e2d\u7684\u5546\u54c1\u591a\u65bc50\u4ef6\uff0c\u4e0d\u53ef\u9032\u884c\u5168\u9078\u64cd\u4f5c\u3002",TIPS_UNDO:'\u6210\u529f\u522a\u9664 <em>{num}</em> \u4ef6\u5bf6\u8c9d\uff0c\u5982\u6709\u8aa4\uff0c\u53ef<a href="#undo" class="J_UndoDel">\u64a4\u92b7\u672c\u6b21\u522a\u9664</a>',TIPS_UNDO_SUCCESS:"\u60a8\u5df2\u6210\u529f\u6062\u5fa9\u522a\u9664\u7684\u5bf6\u8c9d",YOUR_POSITION:"\u60a8\u7684\u4f4d\u7f6e\uff1a",INDEX:"\u9996\u9801",MY_TAOBAO:"\u6211\u7684\u6dd8\u5bf6",MY_CART:"\u6211\u7684\u8cfc\u7269\u8eca",TIPS_CART_INTRO:"\u8cfc\u7269\u8eca\u5e6b\u60a8\u4e00\u6b21\u6027\u5b8c\u6210\u6279\u91cf\u8cfc\u8cb7\u8207\u4ed8\u6b3e\uff0c\u4e0b\u55ae\u66f4\u4fbf\u6377\uff0c\u4ed8\u6b3e\u66f4\u7c21\u55ae\uff01",HOW_TO_USE_CART:"\u5982\u4f55\u4f7f\u7528\u8cfc\u7269\u8eca",TIPS_CART_EMPTY:"\u60a8\u7684\u8cfc\u7269\u8eca\u9084\u662f\u7a7a\u7684\uff0c\u8d95\u7dca\u884c\u52d5\u5427\uff01\u60a8\u53ef\u4ee5\uff1a",TIPS_TO_FAV:'\u770b\u770b <a href="//shoucang.taobao.com/shop_collect_list.htm" target="_blank">\u6211\u7684\u6536\u85cf\u593e</a>',TIPS_TO_LIST:'\u770b\u770b <a href="//trade.taobao.com/trade/itemlist/list_bought_items.htm" target="_blank">\u5df2\u8cb7\u5230\u7684\u5bf6\u8c9d</a>',TIPS_NO_FARE:"\u60a8\u5df2\u4eab\u53d7\u514d\u904b\u8cbb\u512a\u60e0",TIPS_NO_FARE_WITH_PRICE:"\u60a8\u5df2\u4eab\u53d7\u6eff{{#if coudan && coudan.currency}}{{coudan.currency.unitFactor}}{{/if}}{{#if coudan }}{{coudan.priceLevelStr}}{{/if}}\u514d\u904b\u8cbb\u512a\u60e0",TIPS_TO_NO_FARE:"\u518d\u8cb7{{#if coudan && coudan.currency}}{{coudan.currency.unitFactor}}{{/if}}{{#if coudan }}{{coudan.priceStr}}{{/if}}\uff08\u7e3d\u91cd\u5c0f\u65bc{{coudan.weightStr}}kg\uff09\u53ef\u514d\u904b\u8cbb",TIPS_USE_TMALL_POINT:"\u53ef\u7528{{usedPoint}}\u5929\u8c93\u7a4d\u5206\u7372\u5f97\u512a\u60e0",OUT_OF_STOCK:"\u5eab\u5b58\u4e0d\u8db3",STOCK_TENSE:"\u5eab\u5b58\u7dca\u5f35",JUHUASUAN:"\u805a\u5283\u7b97",PRESELL:"\u9810\u552e",GET_COUPON_SUCCESS:"\u9818\u53d6\u6210\u529f",GET_COUPON_FAIL:"\u9818\u53d6\u5931\u6557",GOLDEN_SELLER:"\u91d1\u724c\u8ce3\u5bb6",TIPS_SELECT_ALL_ITEMS_IN_THIS_SHOP:"\u52fe\u9078\u6b64\u5e97\u92ea\u4e0b\u6240\u6709\u5546\u54c1",TIPS_SELECT_PACKAGE:"\u52fe\u9078\u6b64\u5957\u9910",PACKAGE:"\u5957\u9910",TIPS_SELECT_ACT:"\u52fe\u9078\u6b64\u6d3b\u52d5\u4e0b\u6240\u6709\u5546\u54c1",INVALID_ACT:"\u6d3b\u52d5\u5df2\u5931\u6548",ACT:"\u6d3b\u52d5",PROMO_STORE:"\u5e97\u92ea\u4fc3\u92b7",PROMO_STORE_VIP:"\u5e97\u92ea VIP",PROMO_LIMITED:"\u9650\u6642\u6298\u6263",PROMO_DISCOUNT:"\u5c08\u5c6c\u512a\u60e0",TIPS_SELECT_ITEM_PROP:"\u8acb\u9078\u64c7\u5546\u54c1\u5c6c\u6027",TIPS_AMOUNT_ERROR:"\u6578\u91cf\u586b\u5beb\u6709\u8aa4",TIPS_ITEM_NOT_FOUND:"\u8a72\u5bf6\u8c9d\u5df2\u88ab\u4e0b\u67b6\u6216\u522a\u9664",ENTERPRISE_SELLER:"\u4f01\u696d\u5e97\u8216",DUTY_FREE:"\u514d\u7a05\u5e97",ADD_VILLAGER:"\u95dc\u806f\u8cfc\u8cb7\u5ba2\u6236",VILLAGER_MGMT_CO_TITLE:"\u95dc\u806f\u8cfc\u8cb7\u5ba2\u6236\u4fe1\u606f",VILLAGER:"\u8cfc\u8cb7\u5ba2\u6236",TAB_VILLAGER_STOCK:"\u8cfc\u8cb7\u5ba2\u6236\u8996\u5716",NO_OPERATOR:"\u7121",NO_CHECKBOX:"\u8a72\u5546\u54c1\u9084\u6c92\u6709\u958b\u59cb\u92b7\u552e\uff0c\u9084\u4e0d\u80fd\u4e0b\u55ae\u54e6\uff0c\u8acb\u7a0d\u5f8c\uff01",SUBMIT_LIST:"\u63d0\u4ea4\u9810\u5b9a",EMPTY_SIMILAR:"\u89aa\uff0c\u5f88\u62b1\u6b49\uff0c\u6c92\u6709\u76f8\u95dc\u5bf6\u8c9d\u54e6~",ERROR_SIMILAR:"\u89aa\uff0c\u66ab\u6642\u5237\u4e0d\u51fa\u6e4a\u55ae\u5bf6\u8c9d\uff0c\u8acb\u5237\u65b0\u540e\u91cd\u8a66\u4e00\u4e0b\u54e6~",MULTI_CURRENCY:"\u5408\u8a08\uff1a\u5305\u542b\u591a\u7a2e\u8ca8\u5e63"}}),KISSY.add("cart/lang/zh_CN",function(e,t,i,a){e.getLogger("en");a.exports={TAB_ALL_ITEMS:"\u5168\u90e8\u5546\u54c1",TAB_DISCOUNT_ITEMS:"\u964d\u4ef7\u5546\u54c1",TAB_LOW_STOCK:"\u5e93\u5b58\u7d27\u5f20",TH_SELECT_ALL:"\u5168\u9009",TH_ITEM_INFO:"\u5546\u54c1\u4fe1\u606f",TH_UNIT_PRICE:"\u5355\u4ef7",TH_QUANTITY:"\u6570\u91cf",TH_AMOUNT:"\u91d1\u989d",TH_OPERATION:"\u64cd\u4f5c",TH_VILLAGER:"\u8d2d\u4e70\u5ba2\u6237\u4fe1\u606f",SELECTED_ITEMS:"\u5df2\u9009\u5546\u54c1\uff08\u4e0d\u542b\u8fd0\u8d39\uff09",SELECTED_ITEMS_NO_TAX:"\u5df2\u9009\u5546\u54c1\uff08\u4e0d\u542b\u8fd0\u8d39\u548c\u8fdb\u53e3\u7a0e\uff09",CHECKOUT_SMALL:"\u7ed3\u7b97",CHECKOUT:"\u7ed3\u7b97",CHECKOUT_BIG:"\u7ed3&nbsp;\u7b97",SELLER:"\u5e97\u94fa",INVALID:"\u5931\u6548",SELECT_ITEM_INFO:"\u9009\u62e9\u5546\u54c1\u4fe1\u606f",ITEM:"\u666e\u901a\u5546\u54c1",AFTER_SALE_SERVICE:"\u552e\u540e\u670d\u52a1",DISCOUNT_ENJOYED:"\u5df2\u4eab\u4f18\u60e0",MODIFY:"\u4fee\u6539",CONFIRM:"\u786e\u5b9a",CONFIRM_NBSP:"\u786e&nbsp;\u5b9a",CANCEL:"\u53d6\u6d88",CLOSE_NBSP:"\u5173&nbsp;\u95ed",MULTIPLE_PURCHASE:"\u4ec5\u652f\u6301 {num} \u500d\u8d2d\u4e70",TPL_MULTIPLE_PURCHASE:"\u4ec5\u652f\u6301{{amount.multiple}}\u500d\u8d2d\u4e70",LIMIT_PURCHASE:"\u9650\u8d2d {num} \u4ef6",TPL_LIMIT_PURCHASE:"\u9650\u8d2d{{amount.limit}}\u4ef6",MAX_PURCHASE:"\u6700\u591a\u53ea\u80fd\u8d2d\u4e70 {num} \u4ef6",TPL_MAX_PURCHASE:"\u6700\u591a\u53ea\u80fd\u8d2d\u4e70 {{amount.max}} \u4ef6",VILLAGER_ASSOCIATION:"\u60a8\u6709 {num} \u4ef6\u5546\u54c1\u6ca1\u6709\u5173\u8054\u8d2d\u4e70\u5ba2\u6237",VILLAGER_CANNOT_EMPTY:"\u8d2d\u4e70\u5ba2\u6237\u4fe1\u606f\u4e0d\u80fd\u4e3a\u7a7a",INVALID_PACKAGE:"\u5957\u9910\u5df2\u5931\u6548",TIPS_WANGWANG:"\u70b9\u6b64\u53ef\u4ee5\u76f4\u63a5\u548c\u5356\u5bb6\u4ea4\u6d41\u9009\u597d\u7684\u5b9d\u8d1d\uff0c\u6216\u76f8\u4e92\u4ea4\u6d41\u7f51\u8d2d\u4f53\u9a8c\uff0c\u8fd8\u652f\u6301\u8bed\u97f3\u89c6\u9891\u5662\u3002",WANGWANG_ONLINE:"\u65fa\u65fa\u5728\u7ebf",WANGWANG_OFFLINE:"\u65fa\u65fa\u79bb\u7ebf",TIPS_PRESELL_BUY:"\u8be5\u5546\u54c1\u4e3a\u9884\u552e\u5546\u54c1\uff0c\u60a8\u5df2\u7ecf\u4ed8\u8fc7\u5b9a\u91d1\uff0c\u8bb0\u5f97\u6309\u65f6\u6765\u8d2d\u7269\u8f66\u652f\u4ed8\u5c3e\u6b3e\u54e6",TIPS_GROUP_BUY:"\u8be5\u5546\u54c1\u4e3a\u805a\u5212\u7b97\u5b9d\u8d1d\uff0c\u76ee\u524d\u6b63\u5728\u9884\u70ed\uff0c\u663e\u793a\u5546\u54c1\u539f\u4ef7\uff0c\u6682\u65f6\u65e0\u6cd5\u8d2d\u4e70\uff0c\u5f00\u56e2\u540e\u53ef\u6062\u590d\u6b63\u5e38\u8d2d\u4e70",TIPS_ITEM_INVALID:"\u5546\u54c1\u88ab\u4e0b\u67b6\u3001\u5220\u9664\u3001\u5e93\u5b58\u4e0d\u8db3\uff0c\u6216\u5546\u5bb6\u5904\u4e8e\u88ab\u76d1\u7ba1\u6216\u51bb\u7ed3\u72b6\u6001",TIPS_ITEM_SELECT:"\u52fe\u9009\u5546\u54c1",TIPS_ITEM_DESELECT:"\u53d6\u6d88\u52fe\u9009\u5546\u54c1",GIFT:"\u8d60\u54c1",REDEEM:"\u6362\u8d2d",MORE:"\u66f4\u591a",PROTECTION:"\u4fdd\u969c",TIPS_NO_STOCK:"\u8be5\u5b9d\u8d1d\u5e93\u5b58\u4e0d\u8db3,\u8bf7\u8054\u7cfb\u5356\u5bb6",TIPS_LOW_STOCK:"\u8be5\u5546\u54c1\u53ea\u6709 {num} \u4ef6\u4e86\u54e6\uff0c\u8981\u4e70\u7684\u8d76\u7d27\u554a",TPL_TIPS_LOW_STOCK:"\u8be5\u5546\u54c1\u53ea\u6709{{amount.max}}\u4ef6\u4e86\u54e6\uff0c\u8981\u4e70\u7684\u8d76\u7d27\u554a",TIPS_LOW_STOCK_POPULAR:"\u8be5\u5546\u54c1\u53ea\u6709 {num} \u4ef6\u4e86\u54e6\uff0c\u4f46\u662f\u6709 {num_people} \u4eba\u5df2\u7ecf\u52a0\u5165\u8d2d\u7269\u8f66\u6253\u7b97\u8d2d\u4e70",TPL_TIPS_LOW_STOCK_POPULAR:"\u8be5\u5546\u54c1\u53ea\u6709{{amount.supply}}\u4ef6\u4e86\u54e6\uff0c\u4f46\u662f\u6709{{amount.demand}}\u4eba\u5df2\u7ecf\u52a0\u5165\u8d2d\u7269\u8f66\u6253\u7b97\u8d2d\u4e70",SIMILAR_ITEMS:"\u67e5\u770b\u540c\u7c7b\u5b9d\u8d1d",COUDAN:"\u9a6c\u4e0a\u53bb\u51d1\u5355",SEE_DETAIL:"\u67e5\u770b\u8be6\u60c5",FAV:"\u79fb\u5165\u6536\u85cf\u5939",DELETE:"\u5220\u9664",SIMILAR:"\u76f8\u4f3c\u5b9d\u8d1d",CLEAR_INVALID:"\u6e05\u9664\u5931\u6548\u5b9d\u8d1d",SHARE:"\u5206\u4eab",COMPARE:"\u5f00\u59cb\u5bf9\u6bd4",ITEM_NUM_SELECTED:"\u5df2\u9009\u5546\u54c1",ITEM_UNIT:"\u4ef6",ITEM_UNITS:"\u4ef6",ITEM_UNITS_UNCONFIRMED:"\u4ef6",TOTAL_MONEY:"\u5408\u8ba1\uff08\u4e0d\u542b\u8fd0\u8d39\uff09",TOTAL_MONEY_NO_TAX:"\u5408\u8ba1\uff08\u4e0d\u542b\u8fd0\u8d39\u548c\u8fdb\u53e3\u7a0e\uff09",COMBINE_NOT_SUPPORTED:"\u4e0d\u652f\u6301\u5408\u5e76\u7ed3\u7b97",CANCEL_SELECTION:"\u53d6\u6d88\u9009\u62e9",COD:"\u8d27\u5230\u4ed8\u6b3e",SELL_OVERSEA:"{shopName}, \u4ec5\u552e{region}",NORMAL_ITEMS_COUNT:"\u666e\u901a\u5b9d\u8d1d {num} \u4ef6",TMALL_OSDS_ITEMS_COUNT:"\u5929\u732b\u5168\u7403\u5b98\u65b9\u5e97 {num} \u4ef6",TMALL_HK_ITEMS_COUNT:"\u5929\u732b\u56fd\u9645 {num} \u4ef6",MEDICAL_ITEMS_COUNT:"\u533b\u836f\u9986 {num} \u4ef6",LIRENGOU_ITEMS_COUNT:"\u4fea\u4eba\u8d2d {num} \u4ef6",BACK_TO_TOP:"\u56de\u5230\u9876\u90e8",FEEDBACK:"\u6211\u8981\u53cd\u9988",TIPS_CONFIRM_DELETE_ITEM:"\u786e\u8ba4\u8981\u5220\u9664\u8be5\u5b9d\u8d1d\u5417\uff1f",TIPS_CONFIRM_DELETE_ITEMS:"\u786e\u8ba4\u8981\u5220\u9664\u8fd9\u4e9b\u5b9d\u8d1d\u5417\uff1f",DELETE_ITEM:"\u5220\u9664\u5b9d\u8d1d",TIPS_CONFIRM_DELETE_PACKAGE:"\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684\u5957\u9910\u5417\uff1f",TIPS_CONFIRM_DELETE_VILLAGER:"\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684\u8d2d\u4e70\u5ba2\u6237\u4fe1\u606f\u5417\uff1f",PROMPT_MESSAGE:"\u63d0\u793a\u4fe1\u606f",TIPS_PLEASE_SELECT_ITEM:"\u8bf7\u9009\u62e9\u5b9d\u8d1d",TIPS_NO_INVALID_ITEM:"\u6682\u65f6\u6ca1\u6709\u5931\u6548\u7684\u5b9d\u8d1d",TIPS_CONFIRM_CLEAR_INVALID:"\u786e\u8ba4\u8981\u6e05\u9664\u8fd9\u4e9b\u5b9d\u8d1d\u5417\uff1f",TIPS_SUCCESS_FAV:"\u6210\u529f\u79fb\u81f3\u6536\u85cf\u5939\uff01",TIPS_NO_SELECTION:"\u60a8\u8fd8\u6ca1\u6709\u9009\u62e9\u4efb\u4f55\u5b9d\u8d1d",TIPS_ERROR_CART_LOAD:"\u8d2d\u7269\u8f66\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5",TIPS_ERROR_SYSTEM_FAILED:"\u5bf9\u4e0d\u8d77\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5",TIPS_SEPARATE_CHECKOUT:"\u5982\u679c\u9700\u8981\u8d2d\u4e7050\u4ef6\u4ee5\u4e0a\u5546\u54c1\uff0c\u8bf7\u5206\u591a\u6b21\u7ed3\u7b97\uff0c\u5355\u6b21\u6700\u591a\u7ed3\u7b9750\u4ef6\u5546\u54c1",TIPS_SELECTED_ITEMS:"\u5df2\u9009\u5546\u54c1\u63d0\u793a",TIPS_ERROR_ADD_CART:"\u52a0\u5165\u8d2d\u7269\u8f66\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",TIPS_ERROR_GET_ITEM_INFO:"\u83b7\u53d6\u5546\u54c1\u5c5e\u6027\u4fe1\u606f\u5931\u8d25\uff0c\u8be5\u5546\u54c1\u53ef\u80fd\u5df2\u7ecf\u4e0b\u67b6\u6216\u5220\u9664",COUPONS:"\u4f18\u60e0\u5238",TIPS_COUPON_GOT_COUNT:"\u5df2\u9886\u53d6 {num} \u5f20\u4f18\u60e0\u5238\uff0c\u6709\u65b0\u4f18\u60e0\u5238\u53ef\u9886\u53d6",TPL_TIPS_COUPON_GOT_COUNT:'\u5df2\u9886\u53d6 <em class="J_ReceivedCount">{{receivedCount}}</em> \u5f20\u4f18\u60e0\u5238{{#if unreceivedCount > 0}}\uff0c\u6709\u65b0\u4f18\u60e0\u5238\u53ef\u9886\u53d6{{/if}}',GET_COUPON:"\u9886 \u53d6",TIPS_LOADING:"\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d...",TIPS_ERROR_LOADING:"\u8d2d\u7269\u8f66\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u8bd5\u4e2d\u2026",PANEL_HOT_SALE:"\u638c\u67dc\u70ed\u5356",PANEL_FAV:"\u6700\u8fd1\u6536\u85cf",PANEL_VIEWED:"\u6700\u8fd1\u6d4f\u89c8\u8fc7\u7684",PANEL_LIKE:"\u731c\u4f60\u559c\u6b22\u7684",SOLD_COUNT:"\u9500\u91cf",GO_TO_FAV:"\u53bb\u6211\u7684\u6536\u85cf\u5939",GO_TO_FOOTPRINT:"\u53bb\u6211\u7684\u8db3\u8ff9",TIPS_DATA_LOADING:"\u6570\u636e\u52a0\u8f7d\u4e2d\u2026",SELECT_ALL_ITEMS:"\u52fe\u9009\u8d2d\u7269\u8f66\u5185\u6240\u6709\u5546\u54c1",SELECT_ALL:"\u5168\u9009",TIPS_COMPARE_SELECT_AT_LEAST_TWO_ITEMS:"\u81f3\u5c11\u8981\u9009\u62e9\u4e24\u4ef6\u5b9d\u8d1d\u624d\u80fd\u8fdb\u884c\u5bf9\u6bd4",TIPS_CHECKOUT:"\u8bf7\u6ce8\u610f\u5982\u679c\u6ca1\u6709\u9009\u62e9\u5b9d\u8d1d\uff0c\u5c06\u65e0\u6cd5\u7ed3\u7b97",ITEM_REDEEMED:"\u6362\u8d2d\u5b9d\u8d1d",PREV_PAGE:"\u4e0a\u4e00\u9875",NEXT_PAGE:"\u4e0b\u4e00\u9875",EXPAND:"\u5c55\u5f00",TIPS_COMPARE_MAX_LIMIT:"\u6700\u591a\u652f\u63018\u4ef6\u5b9d\u8d1d\u8fdb\u884c\u5bf9\u6bd4\uff0c\u60a8\u5df2\u9009\u62e9{num}\u4ef6",TIPS_PLEASE_SELECT_ITEM_NEED_TO_CHECKOUT:"\u8bf7\u52fe\u9009\u60a8\u9700\u8981\u7ed3\u7b97\u7684\u5b9d\u8d1d",NEED_SEPARATE_CHECKOUT:"\u9700\u8981\u5206\u7ec4\u7ed3\u7b97",NORMAL_ITEMS:"\u666e\u901a\u5b9d\u8d1d",TMALL_OSDS_ITEMS:"\u5929\u732b\u5168\u7403\u5b98\u65b9\u5e97",TMALL_HK_ITEMS:"\u5929\u732b\u56fd\u9645",TMALL_SM_ITEMS:"\u5929\u732b\u8d85\u5e02",MEDICAL_ITEMS:"\u533b\u836f\u9986",LIRENGOU_ITEMS:"\u4fea\u4eba\u8d2d",TIPS_CANNOT_SELECT_ALL_OVER_50:"\u60a8\u8d2d\u7269\u8f66\u4e2d\u7684\u5546\u54c1\u591a\u4e8e50\u4ef6\uff0c\u4e0d\u53ef\u8fdb\u884c\u5168\u9009\u64cd\u4f5c\u3002",TIPS_UNDO:'\u6210\u529f\u5220\u9664 <em>{num}</em> \u4ef6\u5b9d\u8d1d\uff0c\u5982\u6709\u8bef\uff0c\u53ef<a href="#undo" class="J_UndoDel">\u64a4\u9500\u672c\u6b21\u5220\u9664</a>',TIPS_UNDO_SUCCESS:"\u60a8\u5df2\u6210\u529f\u6062\u590d\u5220\u9664\u7684\u5b9d\u8d1d",YOUR_POSITION:"\u60a8\u7684\u4f4d\u7f6e\uff1a",INDEX:"\u9996\u9875",MY_TAOBAO:"\u6211\u7684\u6dd8\u5b9d",MY_CART:"\u6211\u7684\u8d2d\u7269\u8f66",TIPS_CART_INTRO:"\u8d2d\u7269\u8f66\u5e2e\u60a8\u4e00\u6b21\u6027\u5b8c\u6210\u6279\u91cf\u8d2d\u4e70\u4e0e\u4ed8\u6b3e\uff0c\u4e0b\u5355\u66f4\u4fbf\u6377\uff0c\u4ed8\u6b3e\u66f4\u7b80\u5355\uff01",HOW_TO_USE_CART:"\u5982\u4f55\u4f7f\u7528\u8d2d\u7269\u8f66",TIPS_CART_EMPTY:"\u60a8\u7684\u8d2d\u7269\u8f66\u8fd8\u662f\u7a7a\u7684\uff0c\u8d76\u7d27\u884c\u52a8\u5427\uff01\u60a8\u53ef\u4ee5\uff1a",TIPS_TO_FAV:'\u770b\u770b <a href="//shoucang.taobao.com/shop_collect_list.htm" target="_blank">\u6211\u7684\u6536\u85cf\u5939</a>',TIPS_TO_LIST:'\u770b\u770b <a href="//trade.taobao.com/trade/itemlist/list_bought_items.htm" target="_blank">\u5df2\u4e70\u5230\u7684\u5b9d\u8d1d</a>',TIPS_NO_FARE:"\u60a8\u5df2\u4eab\u53d7\u514d\u8fd0\u8d39\u4f18\u60e0",TIPS_NO_FARE_WITH_PRICE:"\u60a8\u5df2\u4eab\u53d7\u6ee1{{#if coudan && coudan.currency}}{{coudan.currency.unitFactor}}{{/if}}{{#if coudan }}{{coudan.priceLevelStr}}{{/if}}\u514d\u8fd0\u8d39\u4f18\u60e0",TIPS_TO_NO_FARE:"\u518d\u4e70{{#if coudan && coudan.currency}}{{coudan.currency.unitFactor}}{{/if}}{{#if coudan }}{{coudan.priceStr}}{{/if}}\uff08\u603b\u91cd\u5c0f\u4e8e{{coudan.weightStr}}kg\uff09\u53ef\u514d\u8fd0\u8d39",TIPS_USE_TMALL_POINT:"\u53ef\u7528{{usedPoint}}\u5929\u732b\u79ef\u5206\u83b7\u5f97\u4f18\u60e0",OUT_OF_STOCK:"\u5e93\u5b58\u4e0d\u8db3",STOCK_TENSE:"\u5e93\u5b58\u7d27\u5f20",JUHUASUAN:"\u805a\u5212\u7b97",PRESELL:"\u9884\u552e",GET_COUPON_SUCCESS:"\u9886\u53d6\u6210\u529f",GET_COUPON_FAIL:"\u9886\u53d6\u5931\u8d25",GOLDEN_SELLER:"\u91d1\u724c\u5356\u5bb6",TIPS_SELECT_ALL_ITEMS_IN_THIS_SHOP:"\u52fe\u9009\u6b64\u5e97\u94fa\u4e0b\u6240\u6709\u5546\u54c1",TIPS_SELECT_PACKAGE:"\u52fe\u9009\u6b64\u5957\u9910",PACKAGE:"\u5957\u9910",TIPS_SELECT_ACT:"\u52fe\u9009\u6b64\u6d3b\u52a8\u4e0b\u6240\u6709\u5546\u54c1",INVALID_ACT:"\u6d3b\u52a8\u5df2\u5931\u6548",ACT:"\u6d3b\u52a8",PROMO_STORE:"\u5e97\u94fa\u4fc3\u9500",PROMO_STORE_VIP:"\u5e97\u94fa VIP",PROMO_LIMITED:"\u9650\u65f6\u6298\u6263",PROMO_DISCOUNT:"\u4e13\u5c5e\u4f18\u60e0",TIPS_SELECT_ITEM_PROP:"\u8bf7\u9009\u62e9\u5546\u54c1\u5c5e\u6027",TIPS_AMOUNT_ERROR:"\u6570\u91cf\u586b\u5199\u6709\u8bef",TIPS_ITEM_NOT_FOUND:"\u8be5\u5b9d\u8d1d\u5df2\u88ab\u4e0b\u67b6\u6216\u5220\u9664",PROMO_ACTIVITY:"\u5356\u5bb6\u4fc3\u9500",PROMO_OTHER:"\u5176\u5b83\u4f18\u60e0",PROMO_OFFICIAL:"\u5356\u5bb6\u4fc3\u9500",PROMO_NONOFFICIAL:"\u5929\u732b\u4fc3\u9500",PROMO_DOWN:"5\u6298",PROMO_MJHG:"\u6362\u8d2d\u4f18\u60e0",PROMO_DEFAULT:"\u5356\u5bb6\u4fc3\u9500",PROMO_TMALL_POINT:"\u79ef\u5206\u62b5\u6263",TPL_ITEM_SELECTED_SUM:'\u9009\u4e2d\u5546\u54c1\u5408\u8ba1<span class="J_TotalPrice">{{model.totalShopPriceStr}}</span>\u5143',TPL_COMMA:"\uff0c",TPL_REDEEM_ONE_ITEM:'\u53ef\u6362\u8d2d<em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}}</em>\u4ef6\u5546\u54c1',TPL_REDEEM_SOME_ITEMS:'\u53ef\u6362\u8d2d<em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}}</em>\u4ef6\u5546\u54c1',TPL_GET_ONE_FREE_ITEM:'\u53ef\u9886\u53d6<em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}}</em>\u4ef6\u8d60\u54c1',TPL_GET_SOME_FREE_ITEMS:'\u53ef\u9886\u53d6<em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}}</em>\u4ef6\u8d60\u54c1',REDEEM_NOW:"\u9a6c\u4e0a\u6362\u8d2d",ITEM_PLURAL:"",TPL_QUANTITY_WIDE:"\u6570&nbsp;&nbsp;&nbsp;&nbsp;\u91cf",TPL_STOCK_LEFT:'\u5e93\u5b58<em class="J_Stock" data-defstock="{{stock}}">{{stock}}</em>\u4ef6',TPL_STOCKS_LEFT:'\u5e93\u5b58<em class="J_Stock" data-defstock="{{stock}}">{{stock}}</em>\u4ef6',TPL_GET_MONEY_OFF:"\u4f18\u60e0\uff1a{{currency}}{{savedStr}}",PROMO_SELLER_PROMO:"\u5356\u5bb6\u964d\u4ef7",TIP_AFTER_CART_DISCOUNT:"\u6bd4\u52a0\u5165\u8d2d\u7269\u8f66\u65f6\uff0c\u53c8\u4f18\u60e0\u4e86{currency}{num}",TIP_AFTER_CART_DISCOUNT_FREE_SHIPPING:"\u6bd4\u52a0\u5165\u8d2d\u7269\u8f66\u65f6\uff0c\u53c8\u4f18\u60e0\u4e86{currency}{num}\u4e14\u5305\u90ae",TIP_AFTER_CART_FREE_SHIPPING:"\u6bd4\u52a0\u5165\u8d2d\u7269\u8f66\u65f6\uff0c\u5305\u90ae",TIP_AFTER_CART_EXCLUDE:"\uff08\u4e0d\u5305\u542b\uff1a{text}\uff09",ENTERPRISE_SELLER:"\u4f01\u4e1a\u5e97\u94fa",DUTY_FREE:"\u514d\u7a0e\u5e97",ADD_VILLAGER:"\u5173\u8054\u8d2d\u4e70\u5ba2\u6237",VILLAGER:"\u8d2d\u4e70\u5ba2\u6237",TAB_VILLAGER_STOCK:"\u8d2d\u4e70\u5ba2\u6237\u89c6\u56fe",VILLAGER_MGMT_CO_TITLE:"\u5173\u8054\u8d2d\u4e70\u5ba2\u6237\u4fe1\u606f",NO_OPERATOR:"\u65e0",NO_CHECKBOX:"\u8be5\u5546\u54c1\u8fd8\u6ca1\u6709\u5f00\u59cb\u9500\u552e\uff0c\u8fd8\u4e0d\u80fd\u4e0b\u5355\u54e6\uff0c\u8bf7\u7a0d\u540e\uff01",SUBMIT_LIST:"\u63d0\u4ea4\u9884\u5b9a",EMPTY_SIMILAR:"\u4eb2\uff0c\u5f88\u62b1\u6b49\uff0c\u6ca1\u6709\u76f8\u5173\u5b9d\u8d1d\u54e6~",ERROR_SIMILAR:"\u4eb2\uff0c\u6682\u65f6\u5237\u4e0d\u51fa\u51d1\u5355\u5b9d\u8d1d\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5\u4e00\u4e0b\u54e6~",MULTI_CURRENCY:"\u5408\u8ba1\uff1a\u5305\u542b\u591a\u79cd\u8d27\u5e01",CT_COUPON_TIPS:"\u60a8\u52a0\u8d2d\u7684\u5546\u54c1\u53ef\u9886\u53d6\u4ee5\u4e0b\u4f18\u60e0\u5238\uff08\u5b9e\u9645\u4f18\u60e0\u4ee5\u4e0b\u5355\u4e3a\u51c6\uff09",CT_COUPON_LIMIT:"\u5df2\u8fbe\u9886\u53d6\u4e0a\u9650"}}),KISSY.add("cart/lang/en",function(e,t,i,a){e.getLogger("en");a.exports={TAB_ALL_ITEMS:"All Items",TAB_DISCOUNT_ITEMS:"Discount Products",TAB_LOW_STOCK:"Low Stock",TH_SELECT_ALL:"Select All",TH_ITEM_INFO:"Item Info",TH_UNIT_PRICE:"Unit Price",TH_QUANTITY:"Quantity",TH_AMOUNT:"Amount",TH_OPERATION:"Operation",SELECTED_ITEMS:"Selected Items (excluding freight)",SELECTED_ITEMS_NO_TAX:"Selected Items (excluding shipping and tax)",CHECKOUT_SMALL:"Proceed to checkout",CHECKOUT:"Proceed to checkout",CHECKOUT_BIG:"Proceed to checkout",SELLER:"Seller",INVALID:"invalid",SELECT_ITEM_INFO:"Select Item Info",ITEM:"Item",AFTER_SALE_SERVICE:"After-sales service",DISCOUNT_ENJOYED:"enjoyed a discount",MODIFY:"Modify",CONFIRM:"Confirm",CONFIRM_NBSP:"Confirm",CANCEL:"Cancel",CLOSE_NBSP:"Close",MULTIPLE_PURCHASE:"you can only purchase a multiple of {num}",TPL_MULTIPLE_PURCHASE:"you can only purchase a multiple of {{amount.multiple}}",LIMIT_PURCHASE:function(e){return e.unit=e.num>1?"s":"","Each customer is limited to {num} piece{unit}"},TPL_LIMIT_PURCHASE:"Each customer is limited to {{amount.limit}} piece{{#if amount.limit > 1}}s{{/if}}",MAX_PURCHASE:function(e){return e.unit=e.num>1?"s":"","You can purchase {num} piece{unit} at most"},TPL_MAX_PURCHASE:"You can purchase {{amount.max}} piece{{#if amount.max > 1}}s{{/if}} at most",INVALID_PACKAGE:"Package is invalid",TIPS_WANGWANG:"Click to communicate with the seller or share the shopping experience, both voice and video are supported",WANGWANG_ONLINE:"Online",WANGWANG_OFFLINE:"Offline",TIPS_PRESELL_BUY:"This product is a pre-sale product, you have paid a deposit, remember to pay the payment on time to the shopping cart",TIPS_GROUP_BUY:"This item is for group-buying and you can't buy this item until it is start to business",TIPS_ITEM_INVALID:"This item may have been off the shelves, deleted, lack of stock or the seller has been frozen",TIPS_ITEM_SELECT:"Select this item",TIPS_ITEM_DESELECT:"Deselect this item",GIFT:"Gift",REDEEM:"Purchase on a barter basis",MORE:"More",PROTECTION:"Buyer protection",TIPS_NO_STOCK:"There is insufficient inventory, please contact the seller",TIPS_LOW_STOCK:"only {num} left in stock - order soon",TPL_TIPS_LOW_STOCK:"only {{amount.max}} left in stock - order soon",TIPS_LOW_STOCK_POPULAR:function(e){return e.unit_people=e.num_people>1?"people":"person","only {num} left in stock, but there are {num_people} {unit_people} have added to cart"},TPL_TIPS_LOW_STOCK_POPULAR:"only {{amount.supply}} left in stock, but there are {{amount.demand}} {{#if amount.demand > 1}}people{{#else}}person{{/if}} have added to cart",SIMILAR_ITEMS:"See like products",COUDAN:"Buy more items to quanlify free shipping",SEE_DETAIL:"See details",FAV:"Move to my collections",DELETE:"Delete",SIMILAR:"Similar products",CLEAR_INVALID:"Clear invalid items",SHARE:"Share",COMPARE:"Compare",ITEM_NUM_SELECTED:"Selected items",ITEM_UNIT:"item",ITEM_UNITS:"items",ITEM_UNITS_UNCONFIRMED:"item(s)",TOTAL_MONEY:"Total (excluding freight cost)",TOTAL_MONEY_NO_TAX:"Total (excluding freight cost and tax)",COMBINE_NOT_SUPPORTED:"Combine multiple orders is not supported",CANCEL_SELECTION:"Cancel Selection",COD:"Cash on Delivery",NORMAL_ITEMS_COUNT:function(e){return e.unit=e.num>1?"s":"","{num} item{unit}"},TMALL_OSDS_ITEMS_COUNT:function(e){return e.unit=e.num>1?"s":"","{num} item{unit} of Tmall Signature"},TMALL_HK_ITEMS_COUNT:function(e){return e.unit=e.num>1?"s":"","{num} item{unit} of TMALL.hk"},MEDICAL_ITEMS_COUNT:function(e){return e.unit=e.num>1?"s":"","{num} item{unit} of medical store"},LIRENGOU_ITEMS_COUNT:function(e){return e.unit=e.num>1?"s":"","{num} item{unit} of beauty supply store"},BACK_TO_TOP:"Back to the top",FEEDBACK:"Feedback",TIPS_CONFIRM_DELETE_ITEM:"Are you sure to delete this item ?",TIPS_CONFIRM_DELETE_ITEMS:"Are you sure to delete these items ?",DELETE_ITEM:"Delete",TIPS_CONFIRM_DELETE_PACKAGE:"Are you sure to delete the selected packages ?",PROMPT_MESSAGE:"Prompt message",TIPS_PLEASE_SELECT_ITEM:"Please select items",TIPS_NO_INVALID_ITEM:"No invalid items temporarily",TIPS_CONFIRM_CLEAR_INVALID:"Are you sure to clear these items\uff1f",TIPS_SUCCESS_FAV:"Move to my collections successful",TIPS_NO_SELECTION:"You did not select any item",TIPS_ERROR_CART_LOAD:"Shopping cart load failed, please refresh and retry",TIPS_ERROR_SYSTEM_FAILED:"Sorry,sytem error occured, please refresh and retry.",TIPS_SEPARATE_CHECKOUT:"If you want to purchase more than 50 items, please checkout several times. The maximum number of items you can checkout one time is 50.",TIPS_SELECTED_ITEMS:"Buying tips  for selected items",TIPS_ERROR_ADD_CART:"Failed to add to cart, please try again later",TIPS_ERROR_GET_ITEM_INFO:"Get item property info failed, this item may have been off the shelves",COUPONS:"Coupons",TIPS_COUPON_GOT_COUNT:function(e){return e.unit=e.num>1?"s":"","You have received {num} coupon{unit} and new coupon is available"},TPL_TIPS_COUPON_GOT_COUNT:'You have received <em class="J_ReceivedCount">{{receivedCount}}</em> coupon{{#if unreceivedCount > 1}}s{{/if}}{{#if unreceivedCount > 0}} and new coupon is available.{{/if}}',GET_COUPON:"Receive",TIPS_LOADING:"Loading\u2026",TIPS_ERROR_LOADING:"Cart load failed, retrying \u2026",PANEL_HOT_SALE:"Hot sale",PANEL_FAV:"You recently collected",PANEL_VIEWED:"You viewed",PANEL_LIKE:"You might like",SOLD_COUNT:"Sold",GO_TO_FAV:"Go to my collections",GO_TO_FOOTPRINT:"Go to my browsing history",TIPS_DATA_LOADING:"Data loading \u2026",SELECT_ALL_ITEMS:"Select all items",SELECT_ALL:"Select All",TIPS_COMPARE_SELECT_AT_LEAST_TWO_ITEMS:"Select at least two items to compare",TIPS_CHECKOUT:"Please note that you cannot checkout if you do not choose items",ITEM_REDEEMED:"Redeem Items",PREV_PAGE:"Previous page",NEXT_PAGE:"Next page",EXPAND:"Expand",TIPS_COMPARE_MAX_LIMIT:"Supports up to 8 items to contrast, you have chosen {num} items",TIPS_PLEASE_SELECT_ITEM_NEED_TO_CHECKOUT:"Please select items",NEED_SEPARATE_CHECKOUT:"Need to group into multiple orders",NORMAL_ITEMS:"item",TMALL_OSDS_ITEMS:"Tmall Signature",TMALL_HK_ITEMS:"TMALL GLOBAL",MEDICAL_ITEMS:"medical store",LIRENGOU_ITEMS:"beauty supply store",
TIPS_CANNOT_SELECT_ALL_OVER_50:"More than 50 items in your Shopping Cart, you can't select all",TIPS_UNDO:'Delete <em>{num}</em> item{unit} successfully, you can <a href="#undo" class="J_UndoDel">undo</a> it if you delete it by mistake.</a>',TIPS_UNDO_SUCCESS:"You have successfully recovered deleted items ",YOUR_POSITION:"Your Now Location:",INDEX:"Home Page",MY_TAOBAO:"My taobao",MY_CART:"My Shopping Cart",TIPS_CART_INTRO:"Shopping Cart help you to purchase and pay in bulk, more convenient and simple.",HOW_TO_USE_CART:"How to use Shopping Cart",TIPS_CART_EMPTY:"Your Shopping Cart is empty, you can:",TIPS_TO_FAV:'View <a href="//shoucang.taobao.com/shop_collect_list.htm" target="_blank">Your Collections</a>',TIPS_TO_LIST:'View <a href="//trade.taobao.com/trade/itemlist/list_bought_items.htm" target="_blank">Your Orders</a>',TIPS_NO_FARE:"You can enjoy free shipping.",TIPS_NO_FARE_WITH_PRICE:"You can enjoyed free shipping on purchase  of X Yuan or above.",TIPS_TO_NO_FARE:"buy another {{coudan.priceStr}} Yuan to qualify for free shipping.",TIPS_USE_TMALL_POINT:"{{usedPoint}} tmall points  are available for get a discount.",OUT_OF_STOCK:"Insufficient inventory",STOCK_TENSE:"Low Stock",JUHUASUAN:"Ju",PRESELL:"Presell",GET_COUPON_SUCCESS:"Received",GOLDEN_SELLER:"Golden seller",TIPS_SELECT_ALL_ITEMS_IN_THIS_SHOP:"Select all items within the store",TIPS_SELECT_PACKAGE:"Select this packages",PACKAGE:"Package",TIPS_SELECT_ACT:"Select all items within the range of the promotion",INVALID_ACT:"This promotion has expired.",ACT:"Promotional campaign",PROMO_STORE:"In-store promotion",PROMO_STORE_VIP:"Store VIP",PROMO_LIMITED:"Limited time discount",PROMO_DISCOUNT:"Exclusive discount",TIPS_SELECT_ITEM_PROP:"Please select item properties",TIPS_AMOUNT_ERROR:"Please enter the correct number",TIPS_ITEM_NOT_FOUND:"This item may have been off the shelves or deleted",PROMO_ACTIVITY:"Discount",PROMO_OTHER:"Other promotions",PROMO_OFFICIAL:"Discount",PROMO_NONOFFICIAL:"Tmall promotions",PROMO_DOWN:"50% off",PROMO_MJHG:"Redemption",PROMO_DEFAULT:"Discount",PROMO_TMALL_POINT:"Redemption",TPL_ITEM_SELECTED_SUM:'Subtotal for selected items:<span class="J_TotalPrice">{{model.totalShopPriceStr}}</span> Yuan',TPL_COMMA:",",TPL_REDEEM_ONE_ITEM:'you are qualified to redeem <em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}}</em> item',TPL_REDEEM_SOME_ITEMS:'you are qualified to redeem <em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}}</em> items',TPL_GET_SOME_FREE_ITEMS:'<em class="J_TotalRedemptionAmount number">{{redemption.totalExtraItemNum}} Free gifts',TPL_GET_ONE_FREE_ITEM:"Free gifts",REDEEM_NOW:"Redeem Now",ITEM_PLURAL:"s",TPL_QUANTITY_WIDE:"Quantity",TPL_STOCK_LEFT:'<em class="J_Stock" data-defstock="{{stock}}">{{stock}}</em> piece available',TPL_STOCKS_LEFT:'<em class="J_Stock" data-defstock="{{stock}}">{{stock}}</em> pieces available',TPL_GET_MONEY_OFF:"Get {{currency}} {{savedStr}} off",PROMO_SELLER_PROMO:"Discount",TIP_AFTER_CART_DISCOUNT:"The Seller has cut down the price by {currency} {num} after you added to cart",TIP_AFTER_CART_DISCOUNT_BAOYOU:"The Seller has cut down the price by {currency} {num} and offers free shipping after you added to cart",TIP_AFTER_CART_BAOYOU:"The Seller offers free shipping now",TIP_AFTER_CART_EXCLUDE:"(excluding: {text})",ENTERPRISE_SELLER:"Enterprise Seller",VILLAGER:"Villager",TAB_VILLAGER_STOCK:"Villager View",NO_OPERATOR:"",SUBMIT_LIST:"submit",TH_VILLAGER:"Villager information",VILLAGER_ASSOCIATION:"You have {num} items are not related to the villagers",VILLAGER_CANNOT_EMPTY:"Villager information can not be empty",TIPS_CONFIRM_DELETE_VILLAGER:"Are you sure you want to delete the selected villager information",TMALL_SM_ITEMS:"Tmall Supermarket",GET_COUPON_FAIL:"Failure to take",TIP_AFTER_CART_DISCOUNT_FREE_SHIPPING:"{num} yuan cheaper and free shipping",TIP_AFTER_CART_FREE_SHIPPING:"free shipping",ADD_VILLAGER:"Related villagers",VILLAGER_MGMT_CO_TITLE:"Related villager information",NO_OPERATOR:"none",NO_CHECKBOX:"This product has not yet begun to sell, can not place an order",EMPTY_SIMILAR:"\u4eb2\uff0c\u5f88\u62b1\u6b49\uff0c\u6ca1\u6709\u76f8\u5173\u5b9d\u8d1d\u54e6~",ERROR_SIMILAR:"\u4eb2\uff0c\u6682\u65f6\u5237\u4e0d\u51fa\u51d1\u5355\u5b9d\u8d1d\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5\u4e00\u4e0b\u54e6~",MULTI_CURRENCY:"Check detail for multiple currency"}}),KISSY.add("cart/utils/i18n/i18n",["node","../../lang/zh_TW","../../lang/zh_CN","../../lang/en"],function(e,t,i,a){function o(){var e=location.href,t=/_thwlang=([\w_]+)/.exec(e);return t&&t[1]?t[1]:null}function r(){var t=Global.cfg.lang||o()||"zh_CN";return Global.cfg.isSea===!0&&"zh_CN"===t?"zh_TW":e.isObject(l[t])?t:"zh_CN"}var n=(e.getLogger("i18n"),t("node").all),s=t("../../lang/zh_TW"),l={zh_CN:t("../../lang/zh_CN"),en:t("../../lang/en"),zh_TW:s,zh_HK:s},c=r(),d=l[c];"zh_CN"!==d&&n("body").addClass("cart-lang-"+c),a.exports={lang:function(t,i){var a=d[t]||l.zh_CN[t];return e.isFunction(a)&&(i=i||{},a=a(i)),i?e.substitute(a,i):a},tpl:function(t,i){var a=d[t];return i?e.substitute(a,i):a},langConfig:c}}),KISSY.add("cart/utils/loading/loading",function(e,t,i){var a=t.all,o='<div id="J_Loading" class="loading-bar-simple"><p>'+i.lang("TIPS_LOADING")+"</p></div>";return{show:function(e){this.hide(),e=a(e||"#J_CartMain");a(o).appendTo(e)},hide:function(){a("#J_Loading").remove()}}},{requires:["node","../i18n/i18n"]}),KISSY.add("cart/utils/lang/lang",function(e,t){function i(e){for(var t="",i=0;i<e.length;i++){var r=e.charAt(i),n=a.indexOf(r);t+=e.charCodeAt(i)>1e4&&n!=-1?o.charAt(n):e.charAt(i)}return t}var a="\u7691\u853c\u788d\u7231\u7ff1\u8884\u5965\u575d\u7f62\u6446\u8d25\u9881\u529e\u7eca\u5e2e\u7ed1\u9551\u8c24\u5265\u9971\u5b9d\u62a5\u9c8d\u8f88\u8d1d\u94a1\u72c8\u5907\u60eb\u7ef7\u7b14\u6bd5\u6bd9\u95ed\u8fb9\u7f16\u8d2c\u53d8\u8fa9\u8fab\u9cd6\u762a\u6fd2\u6ee8\u5bbe\u6448\u997c\u62e8\u94b5\u94c2\u9a73\u535c\u8865\u53c2\u8695\u6b8b\u60ed\u60e8\u707f\u82cd\u8231\u4ed3\u6ca7\u5395\u4fa7\u518c\u6d4b\u5c42\u8be7\u6400\u63ba\u8749\u998b\u8c17\u7f20\u94f2\u4ea7\u9610\u98a4\u573a\u5c1d\u957f\u507f\u80a0\u5382\u7545\u949e\u8f66\u5f7b\u5c18\u9648\u886c\u6491\u79f0\u60e9\u8bda\u9a8b\u75f4\u8fdf\u9a70\u803b\u9f7f\u70bd\u51b2\u866b\u5ba0\u7574\u8e0c\u7b79\u7ef8\u4e11\u6a71\u53a8\u9504\u96cf\u7840\u50a8\u89e6\u5904\u4f20\u75ae\u95ef\u521b\u9524\u7eaf\u7ef0\u8f9e\u8bcd\u8d50\u806a\u8471\u56f1\u4ece\u4e1b\u51d1\u7a9c\u9519\u8fbe\u5e26\u8d37\u62c5\u5355\u90f8\u63b8\u80c6\u60ee\u8bde\u5f39\u5f53\u6321\u515a\u8361\u6863\u6363\u5c9b\u7977\u5bfc\u76d7\u706f\u9093\u654c\u6da4\u9012\u7f14\u70b9\u57ab\u7535\u6dc0\u9493\u8c03\u8fed\u8c0d\u53e0\u9489\u9876\u952d\u8ba2\u4e1c\u52a8\u680b\u51bb\u6597\u728a\u72ec\u8bfb\u8d4c\u9540\u953b\u65ad\u7f0e\u5151\u961f\u5bf9\u5428\u987f\u949d\u593a\u9e45\u989d\u8bb9\u6076\u997f\u513f\u5c14\u9975\u8d30\u53d1\u7f5a\u9600\u73d0\u77fe\u9492\u70e6\u8303\u8d29\u996d\u8bbf\u7eba\u98de\u5e9f\u8d39\u7eb7\u575f\u594b\u6124\u7caa\u4e30\u67ab\u950b\u98ce\u75af\u51af\u7f1d\u8bbd\u51e4\u80a4\u8f90\u629a\u8f85\u8d4b\u590d\u8d1f\u8ba3\u5987\u7f1a\u8be5\u9499\u76d6\u5e72\u8d76\u79c6\u8d63\u5188\u521a\u94a2\u7eb2\u5c97\u768b\u9550\u6401\u9e3d\u9601\u94ec\u4e2a\u7ed9\u9f9a\u5bab\u5de9\u8d21\u94a9\u6c9f\u6784\u8d2d\u591f\u86ca\u987e\u5250\u5173\u89c2\u9986\u60ef\u8d2f\u5e7f\u89c4\u7845\u5f52\u9f9f\u95fa\u8f68\u8be1\u67dc\u8d35\u523d\u8f8a\u6eda\u9505\u56fd\u8fc7\u9a87\u97e9\u6c49\u9602\u9e64\u8d3a\u6a2a\u8f70\u9e3f\u7ea2\u540e\u58f6\u62a4\u6caa\u6237\u54d7\u534e\u753b\u5212\u8bdd\u6000\u574f\u6b22\u73af\u8fd8\u7f13\u6362\u5524\u75ea\u7115\u6da3\u9ec4\u8c0e\u6325\u8f89\u6bc1\u8d3f\u79fd\u4f1a\u70e9\u6c47\u8bb3\u8bf2\u7ed8\u8364\u6d51\u4f19\u83b7\u8d27\u7978\u51fb\u673a\u79ef\u9965\u8ba5\u9e21\u7ee9\u7f09\u6781\u8f91\u7ea7\u6324\u51e0\u84df\u5242\u6d4e\u8ba1\u8bb0\u9645\u7ee7\u7eaa\u5939\u835a\u988a\u8d3e\u94be\u4ef7\u9a7e\u6b7c\u76d1\u575a\u7b3a\u95f4\u8270\u7f04\u8327\u68c0\u78b1\u7877\u62e3\u6361\u7b80\u4fed\u51cf\u8350\u69db\u9274\u8df5\u8d31\u89c1\u952e\u8230\u5251\u996f\u6e10\u6e85\u6da7\u6d46\u848b\u6868\u5956\u8bb2\u9171\u80f6\u6d47\u9a84\u5a07\u6405\u94f0\u77eb\u4fa5\u811a\u997a\u7f34\u7ede\u8f7f\u8f83\u79f8\u9636\u8282\u830e\u60ca\u7ecf\u9888\u9759\u955c\u5f84\u75c9\u7ade\u51c0\u7ea0\u53a9\u65e7\u9a79\u4e3e\u636e\u952f\u60e7\u5267\u9e43\u7ee2\u6770\u6d01\u7ed3\u8beb\u5c4a\u7d27\u9526\u4ec5\u8c28\u8fdb\u664b\u70ec\u5c3d\u52b2\u8346\u89c9\u51b3\u8bc0\u7edd\u94a7\u519b\u9a8f\u5f00\u51ef\u9897\u58f3\u8bfe\u57a6\u6073\u62a0\u5e93\u88e4\u5938\u5757\u4fa9\u5bbd\u77ff\u65f7\u51b5\u4e8f\u5cbf\u7aa5\u9988\u6e83\u6269\u9614\u8721\u814a\u83b1\u6765\u8d56\u84dd\u680f\u62e6\u7bee\u9611\u5170\u6f9c\u8c30\u63fd\u89c8\u61d2\u7f06\u70c2\u6ee5\u635e\u52b3\u6d9d\u4e50\u956d\u5792\u7c7b\u6cea\u7bf1\u79bb\u91cc\u9ca4\u793c\u4e3d\u5389\u52b1\u783e\u5386\u6ca5\u96b6\u4fe9\u8054\u83b2\u8fde\u9570\u601c\u6d9f\u5e18\u655b\u8138\u94fe\u604b\u70bc\u7ec3\u7cae\u51c9\u4e24\u8f86\u8c05\u7597\u8fbd\u9563\u730e\u4e34\u90bb\u9cde\u51db\u8d41\u9f84\u94c3\u51cc\u7075\u5cad\u9886\u998f\u5218\u9f99\u804b\u5499\u7b3c\u5784\u62e2\u9647\u697c\u5a04\u6402\u7bd3\u82a6\u5362\u9885\u5e90\u7089\u63b3\u5364\u864f\u9c81\u8d42\u7984\u5f55\u9646\u9a74\u5415\u94dd\u4fa3\u5c61\u7f15\u8651\u6ee4\u7eff\u5ce6\u631b\u5b6a\u6ee6\u4e71\u62a1\u8f6e\u4f26\u4ed1\u6ca6\u7eb6\u8bba\u841d\u7f57\u903b\u9523\u7ba9\u9aa1\u9a86\u7edc\u5988\u739b\u7801\u8682\u9a6c\u9a82\u5417\u4e70\u9ea6\u5356\u8fc8\u8109\u7792\u9992\u86ee\u6ee1\u8c29\u732b\u951a\u94c6\u8d38\u4e48\u9709\u6ca1\u9541\u95e8\u95f7\u4eec\u9530\u68a6\u8c1c\u5f25\u89c5\u7ef5\u7f05\u5e99\u706d\u60af\u95fd\u9e23\u94ed\u8c2c\u8c0b\u4ea9\u94a0\u7eb3\u96be\u6320\u8111\u607c\u95f9\u9981\u817b\u64b5\u637b\u917f\u9e1f\u8042\u556e\u954a\u954d\u67e0\u72de\u5b81\u62e7\u6cde\u94ae\u7ebd\u8113\u6d53\u519c\u759f\u8bfa\u6b27\u9e25\u6bb4\u5455\u6ca4\u76d8\u5e9e\u56fd\u7231\u8d54\u55b7\u9e4f\u9a97\u98d8\u9891\u8d2b\u82f9\u51ed\u8bc4\u6cfc\u9887\u6251\u94fa\u6734\u8c31\u8110\u9f50\u9a91\u5c82\u542f\u6c14\u5f03\u8bab\u7275\u6266\u948e\u94c5\u8fc1\u7b7e\u8c26\u94b1\u94b3\u6f5c\u6d45\u8c34\u5811\u67aa\u545b\u5899\u8537\u5f3a\u62a2\u9539\u6865\u4e54\u4fa8\u7fd8\u7a8d\u7a83\u94a6\u4eb2\u8f7b\u6c22\u503e\u9877\u8bf7\u5e86\u743c\u7a77\u8d8b\u533a\u8eaf\u9a71\u9f8b\u98a7\u6743\u529d\u5374\u9e4a\u8ba9\u9976\u6270\u7ed5\u70ed\u97e7\u8ba4\u7eab\u8363\u7ed2\u8f6f\u9510\u95f0\u6da6\u6d12\u8428\u9cc3\u8d5b\u4f1e\u4e27\u9a9a\u626b\u6da9\u6740\u7eb1\u7b5b\u6652\u95ea\u9655\u8d61\u7f2e\u4f24\u8d4f\u70e7\u7ecd\u8d4a\u6444\u6151\u8bbe\u7ec5\u5ba1\u5a76\u80be\u6e17\u58f0\u7ef3\u80dc\u5723\u5e08\u72ee\u6e7f\u8bd7\u5c38\u65f6\u8680\u5b9e\u8bc6\u9a76\u52bf\u91ca\u9970\u89c6\u8bd5\u5bff\u517d\u67a2\u8f93\u4e66\u8d4e\u5c5e\u672f\u6811\u7ad6\u6570\u5e05\u53cc\u8c01\u7a0e\u987a\u8bf4\u7855\u70c1\u4e1d\u9972\u8038\u6002\u9882\u8bbc\u8bf5\u64de\u82cf\u8bc9\u8083\u867d\u7ee5\u5c81\u5b59\u635f\u7b0b\u7f29\u7410\u9501\u736d\u631e\u62ac\u644a\u8d2a\u762b\u6ee9\u575b\u8c2d\u8c08\u53f9\u6c64\u70eb\u6d9b\u7ee6\u817e\u8a8a\u9511\u9898\u4f53\u5c49\u6761\u8d34\u94c1\u5385\u542c\u70c3\u94dc\u7edf\u5934\u56fe\u6d82\u56e2\u9893\u8715\u8131\u9e35\u9a6e\u9a7c\u692d\u6d3c\u889c\u5f2f\u6e7e\u987d\u4e07\u7f51\u97e6\u8fdd\u56f4\u4e3a\u6f4d\u7ef4\u82c7\u4f1f\u4f2a\u7eac\u8c13\u536b\u6e29\u95fb\u7eb9\u7a33\u95ee\u74ee\u631d\u8717\u6da1\u7a9d\u545c\u94a8\u4e4c\u8bec\u65e0\u829c\u5434\u575e\u96fe\u52a1\u8bef\u9521\u727a\u88ad\u4e60\u94e3\u620f\u7ec6\u867e\u8f96\u5ce1\u4fa0\u72ed\u53a6\u9528\u9c9c\u7ea4\u54b8\u8d24\u8854\u95f2\u663e\u9669\u73b0\u732e\u53bf\u9985\u7fa1\u5baa\u7ebf\u53a2\u9576\u4e61\u8be6\u54cd\u9879\u8427\u9500\u6653\u5578\u874e\u534f\u631f\u643a\u80c1\u8c10\u5199\u6cfb\u8c22\u950c\u8845\u5174\u6c79\u9508\u7ee3\u865a\u5618\u987b\u8bb8\u7eea\u7eed\u8f69\u60ac\u9009\u7663\u7eda\u5b66\u52cb\u8be2\u5bfb\u9a6f\u8bad\u8baf\u900a\u538b\u9e26\u9e2d\u54d1\u4e9a\u8bb6\u9609\u70df\u76d0\u4e25\u989c\u960e\u8273\u538c\u781a\u5f66\u8c1a\u9a8c\u9e2f\u6768\u626c\u75a1\u9633\u75d2\u517b\u6837\u7476\u6447\u5c27\u9065\u7a91\u8c23\u836f\u7237\u9875\u4e1a\u53f6\u533b\u94f1\u9890\u9057\u4eea\u5f5d\u8681\u827a\u4ebf\u5fc6\u4e49\u8be3\u8bae\u8c0a\u8bd1\u5f02\u7ece\u836b\u9634\u94f6\u996e\u6a31\u5a74\u9e70\u5e94\u7f28\u83b9\u8424\u8425\u8367\u8747\u9896\u54df\u62e5\u4f63\u75c8\u8e0a\u548f\u6d8c\u4f18\u5fe7\u90ae\u94c0\u72b9\u6e38\u8bf1\u8206\u9c7c\u6e14\u5a31\u4e0e\u5c7f\u8bed\u5401\u5fa1\u72f1\u8a89\u9884\u9a6d\u9e33\u6e0a\u8f95\u56ed\u5458\u5706\u7f18\u8fdc\u613f\u7ea6\u8dc3\u94a5\u5cb3\u7ca4\u60a6\u9605\u4e91\u90e7\u5300\u9668\u8fd0\u8574\u915d\u6655\u97f5\u6742\u707e\u8f7d\u6512\u6682\u8d5e\u8d43\u810f\u51ff\u67a3\u7076\u8d23\u62e9\u5219\u6cfd\u8d3c\u8d60\u624e\u672d\u8f67\u94e1\u95f8\u8bc8\u658b\u503a\u6be1\u76cf\u65a9\u8f97\u5d2d\u6808\u6218\u7efd\u5f20\u6da8\u5e10\u8d26\u80c0\u8d75\u86f0\u8f99\u9517\u8fd9\u8d1e\u9488\u4fa6\u8bca\u9547\u9635\u6323\u7741\u72f0\u5e27\u90d1\u8bc1\u7ec7\u804c\u6267\u7eb8\u631a\u63b7\u5e1c\u8d28\u949f\u7ec8\u79cd\u80bf\u4f17\u8bcc\u8f74\u76b1\u663c\u9aa4\u732a\u8bf8\u8bdb\u70db\u77a9\u5631\u8d2e\u94f8\u7b51\u9a7b\u4e13\u7816\u8f6c\u8d5a\u6869\u5e84\u88c5\u5986\u58ee\u72b6\u9525\u8d58\u5760\u7f00\u8c06\u6d4a\u5179\u8d44\u6e0d\u8e2a\u7efc\u603b\u7eb5\u90b9\u8bc5\u7ec4\u94bb\u81f4\u949f\u4e48\u4e3a\u53ea\u51f6\u51c6\u542f\u677f\u91cc\u96f3\u4f59\u94fe\u6cc4",o="\u769a\u85f9\u7919\u611b\u7ffa\u8956\u5967\u58e9\u7f77\u64fa\u6557\u9812\u8fa6\u7d46\u5e6b\u7d81\u938a\u8b17\u525d\u98fd\u5bf6\u5831\u9b91\u8f29\u8c9d\u92c7\u72fd\u5099\u618a\u7e43\u7b46\u7562\u6583\u9589\u908a\u7de8\u8cb6\u8b8a\u8faf\u8fae\u9f08\u765f\u7015\u6ff1\u8cd3\u64ef\u9905\u64a5\u7f3d\u9251\u99c1\u8514\u88dc\u53c3\u8836\u6b98\u615a\u6158\u71e6\u84bc\u8259\u5009\u6ec4\u5ec1\u5074\u518a\u6e2c\u5c64\u8a6b\u6519\u647b\u87ec\u995e\u8b92\u7e8f\u93df\u7523\u95e1\u986b\u5834\u5617\u9577\u511f\u8178\u5ee0\u66a2\u9214\u8eca\u5fb9\u5875\u9673\u896f\u6490\u7a31\u61f2\u8aa0\u9a01\u7661\u9072\u99b3\u6065\u9f52\u71be\u6c96\u87f2\u5bf5\u7587\u8e8a\u7c4c\u7da2\u919c\u6ae5\u5eda\u92e4\u96db\u790e\u5132\u89f8\u8655\u50b3\u7621\u95d6\u5275\u9318\u7d14\u7dbd\u8fad\u8a5e\u8cdc\u8070\u8525\u56ea\u5f9e\u53e2\u6e4a\u7ac4\u932f\u9054\u5e36\u8cb8\u64d4\u55ae\u9132\u64a3\u81bd\u619a\u8a95\u5f48\u7576\u64cb\u9ee8\u8569\u6a94\u6417\u5cf6\u79b1\u5c0e\u76dc\u71c8\u9127\u6575\u6ecc\u905e\u7de0\u9ede\u588a\u96fb\u6fb1\u91e3\u8abf\u53e0\u8adc\u758a\u91d8\u9802\u9320\u8a02\u6771\u52d5\u68df\u51cd\u9b25\u72a2\u7368\u8b80\u8ced\u934d\u935b\u65b7\u7dde\u514c\u968a\u5c0d\u5678\u9813\u920d\u596a\u9d5d\u984d\u8a1b\u60e1\u9913\u5152\u723e\u990c\u8cb3\u767c\u7f70\u95a5\u743a\u792c\u91e9\u7169\u7bc4\u8ca9\u98ef\u8a2a\u7d21\u98db\u5ee2\u8cbb\u7d1b\u58b3\u596e\u61a4\u7cde\u8c50\u6953\u92d2\u98a8\u760b\u99ae\u7e2b\u8af7\u9cf3\u819a\u8f3b\u64ab\u8f14\u8ce6\u8907\u8ca0\u8a03\u5a66\u7e1b\u8a72\u9223\u84cb\u5e79\u8d95\u7a08\u8d1b\u5ca1\u525b\u92fc\u7db1\u5d17\u81ef\u93ac\u64f1\u9d3f\u95a3\u927b\u500b\u7d66\u9f94\u5bae\u978f\u8ca2\u920e\u6e9d\u69cb\u8cfc\u5920\u8831\u9867\u526e\u95dc\u89c0\u9928\u6163\u8cab\u5ee3\u898f\u77fd\u6b78\u9f9c\u95a8\u8ecc\u8a6d\u6ac3\u8cb4\u528a\u8f25\u6efe\u934b\u570b\u904e\u99ed\u97d3\u6f22\u95a1\u9db4\u8cc0\u6a6b\u8f5f\u9d3b\u7d05\u5f8c\u58fa\u8b77\u6eec\u6236\u5629\u83ef\u756b\u5283\u8a71\u61f7\u58de\u6b61\u74b0\u9084\u7de9\u63db\u559a\u7613\u7165\u6e19\u9ec3\u8b0a\u63ee\u8f1d\u6bc0\u8cc4\u7a62\u6703\u71f4\u5f59\u8af1\u8aa8\u7e6a\u8477\u6e3e\u5925\u7372\u8ca8\u798d\u64ca\u6a5f\u7a4d\u9951\u8b4f\u96de\u7e3e\u7ddd\u6975\u8f2f\u7d1a\u64e0\u5e7e\u858a\u5291\u6fdf\u8a08\u8a18\u969b\u7e7c\u7d00\u593e\u83a2\u9830\u8cc8\u9240\u50f9\u99d5\u6bb2\u76e3\u5805\u7b8b\u9593\u8271\u7dd8\u7e6d\u6aa2\u583f\u9e7c\u63c0\u64bf\u7c21\u5109\u6e1b\u85a6\u6abb\u9452\u8e10\u8ce4\u898b\u9375\u8266\u528d\u991e\u6f38\u6ffa\u6f97\u6f3f\u8523\u69f3\u734e\u8b1b\u91ac\u81a0\u6f86\u9a55\u5b0c\u652a\u9278\u77ef\u50e5\u8173\u9903\u7e73\u7d5e\u8f4e\u8f03\u7a2d\u968e\u7bc0\u8396\u9a5a\u7d93\u9838\u975c\u93e1\u5f91\u75d9\u7af6\u6de8\u7cfe\u5ec4\u820a\u99d2\u8209\u64da\u92f8\u61fc\u5287\u9d51\u7d79\u5091\u6f54\u7d50\u8aa1\u5c46\u7dca\u9326\u50c5\u8b39\u9032\u6649\u71fc\u76e1\u52c1\u834a\u89ba\u6c7a\u8a23\u7d55\u921e\u8ecd\u99ff\u958b\u51f1\u9846\u6bbc\u8ab2\u58be\u61c7\u6473\u5eab\u8932\u8a87\u584a\u5108\u5bec\u7926\u66e0\u6cc1\u8667\u5dcb\u7aba\u994b\u6f70\u64f4\u95ca\u881f\u81d8\u840a\u4f86\u8cf4\u85cd\u6b04\u6514\u7c43\u95cc\u862d\u703e\u8b95\u652c\u89bd\u61f6\u7e9c\u721b\u6feb\u6488\u52de\u6f87\u6a02\u9433\u58d8\u985e\u6dda\u7c6c\u96e2\u88cf\u9bc9\u79ae\u9e97\u53b2\u52f5\u792b\u66c6\u701d\u96b8\u5006\u806f\u84ee\u9023\u942e\u6190\u6f23\u7c3e\u6582\u81c9\u93c8\u6200\u7149\u7df4\u7ce7\u6dbc\u5169\u8f1b\u8ad2\u7642\u907c\u9410\u7375\u81e8\u9130\u9c57\u51dc\u8cc3\u9f61\u9234\u6de9\u9748\u5dba\u9818\u993e\u5289\u9f8d\u807e\u56a8\u7c60\u58df\u650f\u96b4\u6a13\u5a41\u645f\u7c0d\u8606\u76e7\u9871\u5eec\u7210\u64c4\u9e75\u865c\u9b6f\u8cc2\u797f\u9304\u9678\u9a62\u5442\u92c1\u4fb6\u5c62\u7e37\u616e\u6ffe\u7da0\u5dd2\u6523\u5b7f\u7064\u4e82\u6384\u8f2a\u502b\u4f96\u6dea\u7db8\u8ad6\u863f\u7f85\u908f\u947c\u7c6e\u9a3e\u99f1\u7d61\u5abd\u746a\u78bc\u879e\u99ac\u7f75\u55ce\u8cb7\u9ea5\u8ce3\u9081\u8108\u779e\u9945\u883b\u6eff\u8b3e\u8c93\u9328\u925a\u8cbf\u9ebd\u9ef4\u6c92\u9382\u9580\u60b6\u5011\u9333\u5922\u8b0e\u5f4c\u8993\u7dbf\u7dec\u5edf\u6ec5\u61ab\u95a9\u9cf4\u9298\u8b2c\u8b00\u755d\u9209\u7d0d\u96e3\u6493\u8166\u60f1\u9b27\u9912\u81a9\u6506\u649a\u91c0\u9ce5\u8076\u9f67\u9477\u93b3\u6ab8\u7370\u752f\u64f0\u6fd8\u9215\u7d10\u81bf\u6fc3\u8fb2\u7627\u8afe\u6b50\u9dd7\u6bc6\u5614\u6f1a\u76e4\u9f90\u570b\u611b\u8ce0\u5674\u9d6c\u9a19\u98c4\u983b\u8ca7\u860b\u6191\u8a55\u6f51\u9817\u64b2\u92ea\u6a38\u8b5c\u81cd\u9f4a\u9a0e\u8c48\u5553\u6c23\u68c4\u8a16\u727d\u6261\u91fa\u925b\u9077\u7c3d\u8b19\u9322\u9257\u6f5b\u6dfa\u8b74\u5879\u69cd\u55c6\u7246\u8594\u5f37\u6436\u936c\u6a4b\u55ac\u50d1\u7ff9\u7ac5\u7aca\u6b3d\u89aa\u8f15\u6c2b\u50be\u9803\u8acb\u6176\u74ca\u7aae\u8da8\u5340\u8ec0\u9a45\u9f72\u9874\u6b0a\u52f8\u537b\u9d72\u8b93\u9952\u64fe\u7e5e\u71b1\u97cc\u8a8d\u7d09\u69ae\u7d68\u8edf\u92b3\u958f\u6f64\u7051\u85a9\u9c13\u8cfd\u5098\u55aa\u9a37\u6383\u6f80\u6bba\u7d17\u7be9\u66ec\u9583\u965d\u8d0d\u7e55\u50b7\u8cde\u71d2\u7d39\u8cd2\u651d\u61fe\u8a2d\u7d33\u5be9\u5b38\u814e\u6ef2\u8072\u7e69\u52dd\u8056\u5e2b\u7345\u6fd5\u8a69\u5c4d\u6642\u8755\u5be6\u8b58\u99db\u52e2\u91cb\u98fe\u8996\u8a66\u58fd\u7378\u6a1e\u8f38\u66f8\u8d16\u5c6c\u8853\u6a39\u8c4e\u6578\u5e25\u96d9\u8ab0\u7a05\u9806\u8aaa\u78a9\u720d\u7d72\u98fc\u8073\u616b\u980c\u8a1f\u8aa6\u64fb\u8607\u8a34\u8085\u96d6\u7d8f\u6b72\u5b6b\u640d\u7b4d\u7e2e\u7463\u9396\u737a\u64bb\u64e1\u6524\u8caa\u7671\u7058\u58c7\u8b5a\u8ac7\u6b4e\u6e6f\u71d9\u6fe4\u7e27\u9a30\u8b04\u92bb\u984c\u9ad4\u5c5c\u689d\u8cbc\u9435\u5ef3\u807d\u70f4\u9285\u7d71\u982d\u5716\u5857\u5718\u9839\u86fb\u812b\u9d15\u99b1\u99dd\u6a62\u7aaa\u896a\u5f4e\u7063\u9811\u842c\u7db2\u97cb\u9055\u570d\u7232\u6ff0\u7dad\u8466\u5049\u50de\u7def\u8b02\u885b\u6eab\u805e\u7d0b\u7a69\u554f\u7515\u64be\u8778\u6e26\u7aa9\u55da\u93a2\u70cf\u8aa3\u7121\u856a\u5433\u5862\u9727\u52d9\u8aa4\u932b\u72a7\u8972\u7fd2\u9291\u6232\u7d30\u8766\u8f44\u5cfd\u4fe0\u72f9\u5ec8\u9341\u9bae\u7e96\u9e79\u8ce2\u929c\u9591\u986f\u96aa\u73fe\u737b\u7e23\u9921\u7fa8\u61b2\u7dda\u5ec2\u9472\u9109\u8a73\u97ff\u9805\u856d\u92b7\u66c9\u562f\u880d\u5354\u633e\u651c\u8105\u8ae7\u5beb\u7009\u8b1d\u92c5\u91c1\u8208\u6d36\u93fd\u7e61\u865b\u5653\u9808\u8a31\u7dd2\u7e8c\u8ed2\u61f8\u9078\u766c\u7d62\u5b78\u52f3\u8a62\u5c0b\u99b4\u8a13\u8a0a\u905c\u58d3\u9d09\u9d28\u555e\u4e9e\u8a1d\u95b9\u7159\u9e7d\u56b4\u9854\u95bb\u8c54\u53ad\u786f\u5f65\u8afa\u9a57\u9d26\u694a\u63da\u760d\u967d\u7662\u990a\u6a23\u7464\u6416\u582f\u9059\u7aaf\u8b20\u85e5\u723a\u9801\u696d\u8449\u91ab\u92a5\u9824\u907a\u5100\u5f5c\u87fb\u85dd\u5104\u61b6\u7fa9\u8a63\u8b70\u8abc\u8b6f\u7570\u7e79\u852d\u9670\u9280\u98f2\u6afb\u5b30\u9df9\u61c9\u7e93\u7469\u87a2\u71df\u7192\u8805\u7a4e\u55b2\u64c1\u50ad\u7670\u8e34\u8a60\u6e67\u512a\u6182\u90f5\u923e\u7336\u904a\u8a98\u8f3f\u9b5a\u6f01\u5a1b\u8207\u5dbc\u8a9e\u7c72\u79a6\u7344\u8b7d\u9810\u99ad\u9d1b\u6df5\u8f45\u5712\u54e1\u5713\u7de3\u9060\u9858\u7d04\u8e8d\u9470\u5dbd\u7cb5\u6085\u95b1\u96f2\u9116\u52fb\u9695\u904b\u860a\u919e\u6688\u97fb\u96dc\u707d\u8f09\u6522\u66ab\u8d0a\u8d13\u9ad2\u947f\u68d7\u7ac8\u8cac\u64c7\u5247\u6fa4\u8cca\u8d08\u7d2e\u5284\u8ecb\u9358\u9598\u8a50\u9f4b\u50b5\u6c08\u76de\u65ac\u8f3e\u5d84\u68e7\u6230\u7dbb\u5f35\u6f32\u5e33\u8cec\u8139\u8d99\u87c4\u8f4d\u937a\u9019\u8c9e\u91dd\u5075\u8a3a\u93ae\u9663\u6399\u775c\u7319\u5e40\u912d\u8b49\u7e54\u8077\u57f7\u7d19\u646f\u64f2\u5e5f\u8cea\u937e\u7d42\u7a2e\u816b\u8846\u8b05\u8ef8\u76ba\u665d\u9a5f\u8c6c\u8af8\u8a85\u71ed\u77da\u56d1\u8caf\u9444\u7bc9\u99d0\u5c08\u78da\u8f49\u8cfa\u6a01\u838a\u88dd\u599d\u58ef\u72c0\u9310\u8d05\u589c\u7db4\u8ac4\u6fc1\u8332\u8cc7\u6f2c\u8e64\u7d9c\u7e3d\u7e31\u9112\u8a5b\u7d44\u947d\u7dfb\u9418\u9ebc\u70ba\u96bb\u5147\u6e96\u555f\u95c6\u88e1\u9742\u9918\u934a\u6d29";return function(e){switch(t.langConfig){case"zh_TW":return i(e);default:return e}}},{requires:["../i18n/i18n"]}),KISSY.add("cart/utils/tpl/render",function(e,t,i){function a(i,a,r){var n,s;if(r=r||o,e.isString(i))n=i;else{try{n=i.render(a)}catch(l){s=l}n.match(/KISSY\.Template:[\s\w]*Error\./)?(s=n,e.Config.debug||(n="")):n+=" "}if(n&&(n=t(n)),s){e.log(r+" render error: "+s+" with data: ","warn"),e.log(a,"dir"),i.parser&&e.log(r+" the template log is :"+i.parser,"warn");var c="[Render] error msg:"+n+i.parser;Global.utils.logger("render","error",c)}return n}var o="[tpl-render] ";return i.addCommand("i18n",function(e,t){}),a},{requires:["../lang/lang","xtemplate"]}),KISSY.add("cart/utils/dialog/dialog",function(e,t,i,a,o){var r,n,s,l=t.all;return{init:function(){},_dialog:function(t,i,n,c,d,u){e.isUndefined(n)&&(n=o.lang("PROMPT_MESSAGE")),this.destroy(),s=l('<div id="J_CartDialogRef" style="position:fixed;left:50%;top: 50%; width: 1px; height: 1px;"></div>').appendTo("body"),e.use("overlay",function(e,c){r=new c.Dialog({width:374,elCls:"cart-dialog cart-dialog-"+t,headerContent:a(n),bodyContent:a(i||""),footerContent:function(){var e="";switch(t){case"alert":e='<span class="cart-icon icon-warning"></span>';break;case"confirm":e='<a href="javascript:void(0)" class="dialog-btn J_DialogConfirmBtn">'+o.lang("CONFIRM_NBSP")+'</a><a href="javascript:void(0)" class="dialog-btn dialog-cancel J_DialogCancelBtn">'+o.lang("CLOSE_NBSP")+"</a>";break;default:e=""}return a(e)}(),mask:!0,closeAction:"hide",align:{points:["cc","cc"]},effect:{target:s,easing:"backOut",duration:.3,effect:"none"},aria:!0}),r.show(),r.on("hide",function(){u&&u(),r.destroy(),s&&s.remove()}),l(r.get("el")).delegate("click",".J_DialogConfirmBtn",function(e){e.preventDefault(),d&&d(),r.destroy(),s&&s.remove()}).delegate("click",".J_DialogCancelBtn",function(e){e.preventDefault(),r.hide(),r.fire("hide")}).delegate("click",".ks-overlay-close",function(e){r.fire("hide")}),r.on("hide",function(e){switch(t){case"confirm":u&&u();break;default:d&&d()}})})},confirm:function(e,t,a,o,r){return i.ie<8?void(confirm(e)?o&&o():r&&r()):this._dialog("confirm",e,t,a,o,r)},alert:function(e,t,a,o){return i.ie<8?alert(e):this._dialog("alert",e,t,a,o)},hint:function(e){n&&clearTimeout(n);var t=l("#J_CartSpecialAlert");0===t.length?t=l('<div id="J_CartSpecialAlert" class="special-alert">'+e+"</div>").appendTo("body"):t.html(e);var i=t.width();t.css("margin-left",-i/2),n=setTimeout(function(){l("#J_CartSpecialAlert").remove()},4e3)},destroy:function(){r&&(r.destroy&&r.destroy(),r=null),s&&s.remove()}}},{requires:["node","ua","../tpl/render","../i18n/i18n"]}),KISSY.add("cart/mods/global/data",function(e){var t=window;return{deal:function(i){e.each(i.list,function(i){if(i){var a=i.sellerId,o=t["seller_"+a];a&&o&&(e.mix(i,o,!1),e.isBoolean(o.hasPriceVolume)&&(i.hasPriceVolume=o.hasPriceVolume),!i.title&&i.shopName&&(i.title=i.shopName),i.host=i.host||"C"),e.each(i.bundles,function(a){a&&e.each(a.orders,function(a){if(a){var o=a.itemId+"_"+a.skuId,r=t["item_"+o];o&&r&&e.mix(a,r,!1);var n=t["seller_"+a.sellerId];a.shopId&&n&&(a.seller=n.seller,a.sellerId=n.sellerId,a.shopUrl=n.url,a.shopName=n.shopName);try{a.region=i.region||null,a.price.currency=i.currency||{code:"CNY",symbol:"\uffe5",unitFactor:100}}catch(s){console.log("\u6570\u636e\u683c\u5f0f\u5316\u5931\u8d25")}}})})}})},transform:function(t){var i=t.globalData,a=i.page,o=i.bundRela,r={},n={};return e.each(t.list,function(t){t&&e.each(t.bundles,function(i){i&&e.each(i.orders,function(e){if(e)try{e.region=t.region||null,e.price.currency=t.currency||{code:"CNY",symbol:"\uffe5",unitFactor:100}}catch(i){console.log("\u63a5\u53e3\u6570\u636e\u683c\u5f0f\u5316\u5931\u8d25")}})})}),o&&o.list&&e.each(o.list,function(i){var o=i.name+"_"+a,s=Global.cartGroups?Global.cartGroups[o]:null;s&&s.checkTpl(i),i.bundles&&i.bundles.length>1?e.each(i.bundles,function(a){if(r[a]=o,t&&!i.coupon1111){var n=t.list;e.each(n,function(e){e.id===a&&e.coupon1111&&(i.coupon1111=e.coupon1111)})}}):s&&s.data&&e.each(s.data.bundles,function(e){r[e]=o}),n[o]=i}),e.each(t.list,function(t){var i=r[t.id];i&&(t.id.replace("s_","")+"_"+a===i?(n[i].shopName=t.shopName,n[i].url=t.url,n[i].title=t.title,n[i].host=t.host):e.isUndefined(n[i].host)&&(n[i].host=t.host),n[i].icon=t.icon,t.groupId=i)}),t.groups=n,Global.groupData=Global.groupData||{},e.mix(Global.groupData,n,!0),t}}}),KISSY.add("cart/mods/global/retcode",function(e){function t(){return"undefined"!=typeof window&&window.__bl&&(o=window.__bl),o}function i(e){return e=e||{},{status:e.status,statusText:e.statusText,responseHeadersString:e.responseHeadersString,responseURL:e.transport&&e.transport.nativeXhr&&e.transport.nativeXhr.responseURL}}var a=function(){},o={api:a};return{now:function(){return(new Date).getTime()},retSuccess:function(e,i){t().api(e,!0,i,"SUCCESS","success")},retError:function(e,a,o){try{"object"==typeof o&&(o=JSON.stringify(i(o)))}catch(r){o='{"status": 0, "statusText": "JSON.stringify Exception"}'}t().api(e,!1,a,"FAIL",o)}}},{requires:[]}),KISSY.add("cart/mods/global/yao-qrcode/yao-qrcode",function(e,t,i){var a,o=t.all,r=window,n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAABlBMVEUAAAD///+l2Z/dAAACAUlEQVRo3uWZsZHDMAwEoVHAUCW4FJYmlcZSVIJCBRrh7wBQtv8reILjwDY3ugHA41HE1nxJ0XM5luO142dtVTf5XP8dmBTrmi/sCwF58Y8m67bySx7gpkyz6ln0EFl0f+0VBABIlQ6AUCgYSrNDqlazAthBwSi1QsUMCHhfoBwI+H4AX40zOtDnZAHhcxJ9YcCvQTo4oL7ivMAfICCU9pUFQONMF5SygiEgsY+CYd8MApDx0+AUOw3ksQdrr5YMgN4Tq2HGdjkwILwcWu1jMhVARIodi3vvCwpljZMEUL1nCtVtM5jaIJAJNQ5gOlwdgA5sDRwHGBDCCZEEmLwYbBGgHQxXbDJmAVAvOC1sTsIYG8H5QH6VRMBNx3iZTfLt3e/NGA+bjgPAH0xui3koOlI1BoTZgxwAtm1O2jWpm0HxjET5SQJM3f6etAdmi60zrGA0D6DPnCxxZ3alYJNW02oMAG1xWzpwvgm6YuigkR6kADSyILrBfj2o1hgxH5IA0Gm6PCpmX3g26NdFc4tZAIZm9Adn8dQsIvPmN0UZBegZSIm+4Hzg/tqFSAK8MzECJpQDG4+DPMDXE4lGwWgIJYmAz8y8+4MW8ehwAObgaVkQ7SBPA4aDnphlA9TcQbcHTxaUBfh8IomQpPoTqfx9QxkXeF7MIyahVE28YvzWnAL4AXTN/kEED5m0AAAAAElFTkSuQmCC";return{get cartFrom(){return window.tpcartJkQRShowable?"alihealth_yao2":"alihealth_yao"},originHosts:{},originIsCods:{},init:function(){var e=this;r.goldlog&&r.goldlog.record("/AliHealthMall.tpcart.yao_cart","EXP","","GET"),Global.globalData&&Global.globalData.cartFrom.indexOf("alihealth_yao")!==-1?i({type:"GET",dataType:"jsonp",url:"//alihealthyao.taobao.com/cart/rx2param.htm",success:function(t){t&&Object.prototype.hasOwnProperty.call(t,"showQrCode")?r.tpcartJkQRShowable=t.showQrCode:r.tpcartJkQRShowable=!1,r.tpcartJkQRShowable&&e.showFullScreen()},error:function(){var e="rx2_request_error";Global.utils.logger("yao-qrcode.js","error",e),r.tpcartJkQRShowable=!1}}):r.tpcartJkQRShowable=!1},initItemMutex:function(e){if(!r.tpcartJkQRShowable){var t=this.getItemIds(e),a={},o={},n=this;i({type:"GET",dataType:"jsonp",url:"//alihealthyao.taobao.com/cart/itemGroup.htm?itemIds="+t.join(","),success:function(e){e.success&&e.data&&e.data.length&&(e.data.forEach(function(e){a[e.itemId]=e.host,o[e.itemId]=e.isCod}),n.originHosts=a,n.originIsCods=o)},error:function(){var e="rx2_request_error";Global.utils.logger("yao-qrcode.js","error",e)}})}},showFullScreen:function(){var e=['<div id="J_CartYaoQRCodeRef" class="J_full_yao_qrcode">','<div class="content">','<p class="title"><span>\u624b\u673a\u626b\u7801</span><span>\u67e5\u770b\u5546\u54c1</span></p>','<img class="qr-img" src="'+n+'" />','<div class="subtitle">','<img class="scan" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAArAgMAAABz8fJtAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExURUdwTPdGA/ZFAvVEAhf+HDAAAAADdFJOUwBA4zMMOBkAAABGSURBVCjPY8j///8AAwOD/f//Exj2w9kPGP7D2R9Q2Q4MECAPZEOZDPy0YVML/IeDD0SxqWYvjcMHJS5wxBdynCLHNRIAAB+NhOUi0lqTAAAAAElFTkSuQmCC" />','<p class="text"><span>\u6253\u5f00\u624b\u673a\u6dd8\u5b9d</span><span>\u626b\u4e00\u626b\u67e5\u770b</span></p>',"</div>","</div>",'<div class="overlay" style="background: rgba(0,0,0,0.4); width: 100%; height: 100%;"/>',"</div>"].join("");a=o(e).appendTo("body"),o("#mallPage").css("filter","blur(6px)"),r.goldlog&&r.goldlog.record("/AliHealthMall.tpcart.qrcode","EXP","type=full","GET")},show:function(){if(!r.tpcartJkQRShowable){o("#J_Go").addClass("submit-btn-disabled");var e=this,t=o("#J_CartYaoQRCodeRef");if(!t||!t.length){var i=['<div id="J_CartYaoQRCodeRef" class="J_yao_qrcode">','<div class="content">','<p class="title">\u60a8\u52fe\u9009\u7684\u5546\u54c1\u4e2d\u5305\u542b\u5904\u65b9\u836f\u54c1<br/><span class="row2">\u8bf7\u7528\u624b\u673a\u6dd8\u5b9d\u626b\u7801\uff0c\u51ed\u5904\u65b9\u63d0\u4ea4\u9884\u5b9a</span></p>','<img class="qr-img" src="'+n+'" />','<div class="subtitle">','<img class="scan" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAArAgMAAABz8fJtAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExURUdwTPdGA/ZFAvVEAhf+HDAAAAADdFJOUwBA4zMMOBkAAABGSURBVCjPY8j///8AAwOD/f//Exj2w9kPGP7D2R9Q2Q4MECAPZEOZDPy0YVML/IeDD0SxqWYvjcMHJS5wxBdynCLHNRIAAB+NhOUi0lqTAAAAAElFTkSuQmCC" />','<p class="text"><span>\u6253\u5f00\u624b\u673a\u6dd8\u5b9d</span><span>\u626b\u4e00\u626b\u67e5\u770b</span></p>',"</div>",'<span id="J_CartYaoQRCodeRef_close_btn" class="J_yao_close_btn"></span>',"</div>",'<div class="arrow-down" />',"</div>"].join("");a=o(i).appendTo("#J_FloatBar"),r.goldlog&&r.goldlog.record("/AliHealthMall.tpcart.qrcode","EXP","","GET"),a.delegate("click","#J_CartYaoQRCodeRef_close_btn",function(){e.destroy(),r.goldlog&&r.goldlog.record("/AliHealthMall.tpcart.close_btn","CLK","type=corner","GET")})}}},destroy:function(){a&&(a.remove(),a.undelegate("click","#J_CartYaoQRCodeRef_close_btn"))},getItemIds:function(e){if(e&&"object"==typeof e){var t=[];return Object.keys(e).forEach(function(i){var a=e[i],o=a.getItems();o&&o.length&&o.forEach(function(e){e&&t.push(e.itemId)})}),t}},checkRx:function(e){if(!r.tpcartJkQRShowable){var t=[];e.forEach(function(e){t.push(e.orderId)});for(var i=!1,a=0;a<e.length;a++){var o=e[a],n=this.originHosts[o.itemId];if(n&&n.indexOf("RX")!==-1){i=!0;break}}return i?(this.show(),!0):(this.destroy(),!1)}},checkIsCod:function(e){if(!r.tpcartJkQRShowable){var t=[];e.forEach(function(e){t.push(e.orderId)});for(var i=!1,a=0;a<e.length;a++){var o=e[a],n=this.originIsCods[o.itemId];if(n){i=!0;break}}return i}}}},{requires:["node","ajax"]}),KISSY.add("cart/mods/global/loader",function(e,t,i,a,o,r,n,s,l){function c(t,l){if(a.show(),E>=C)return o.alert(n.lang("TIPS_ERROR_CART_LOAD")),void e.log(g+"max retry times exceeded. exit;");e.isEmptyObject(t)&&Global.globalData&&(t={isNext:!0,endTime:Global.globalData.startTime,page:Global.globalData.page+1}),t&&Global.cfg.tpId&&(t.tpId=Global.cfg.tpId);var c=e.now(),d=!0,u=s.now(),p=function(t){Global.firstData=null;var i=e.now();if(t.success){t=r.transform(t),o.destroy();var a=t.globalData;a&&a.totalSize!==-1&&(Global.totalSize=a.totalSize,a.totalSize>0&&a.tpId&&1===a.page&&t.list&&0===t.list.length&&Global.empty()),Global.promotionCount=a.promotionCount,Global.stockTenseCount=a.stockTenseCount,Global.villagerViewCartsCount=a.villagerViewCartsCount,Global.globalData=a||{},Global.globalData.bItemsCount=0,Global.globalData.cItemsCount=0,
Global.globalData.bShopsCount=0,Global.globalData.cShopsCount=0,E=0,d&&s.retSuccess(Global.cfg.api.loader,s.now()-u)}else{E>=C&&o.alert(t.error&&t.error.errorMessage?t.error.errorMessage:n.lang("TIPS_ERROR_CART_LOAD"));var p="async get my cart returned error: "+(t.error&&t.error.errorCode?t.error.errorCode:"unknown")+" || getMyCart_return_error";Global.utils.logger("loader","error",p),E++,d&&s.retError(Global.cfg.api.loader,s.now()-u,"response data exception")}l&&l(t);var m={result:t.success,renderTime:(e.now()-i)/1e3};d===!0&&(m.ajaxTime=(i-c)/1e3),e.log("[Loader] renderTime: "+m.renderTime),Global.utils.goldlog("cart3-render_time",m)};if(Global.firstData)d=!1,setTimeout(function(){r.deal(Global.firstData),p(Global.firstData)},0),e.log("[Loader] use first page data.");else{if(t=t||{},t._thwlang=n.langConfig,t._tb_token_=_("#_tb_token_").val(),Global.cfg.isYaoPartner){var m=Global.globalData&&Global.globalData.cartFrom||"alihealth_yao";t.cartFrom=m}i({data:t,url:Global.cfg.api.loader,dataType:"jsonp",success:p,jsonpCallback:"asyncGetMyCart",error:function(e,t,i){E++;var a="async get my cart request error. || getMyCart_request_error";Global.utils.logger("loader.js","error",a),s.retError(Global.cfg.api.loader,s.now()-u,i)}})}}function d(){var t=this,i=I.scrollTop();if(!t.__loading&&t.__started){if(i>=T){var a=t.config.diff||200;S&&a+i+I.height()>t.container.outerHeight(!0)&&(e.log("[Loader] loading more~~~"),b.length,u.call(t))}T=i}}function u(){var e=Global.getViewPortPage();this.load({isNext:!0,endTime:e.startTime,page:e.page+1})}function p(t,i){var r=this;if(r.__disable!==!0){if(r.__loading=1,i=i||{},e.isFunction(i)&&(i={success:i}),(!t||e.isEmptyObject(t))&&E>3){var s="async get my cart retried too many times, abort. || getMyCart_request_error";return e.log(g+s),void Global.utils.logger("loader.js","error",s)}(t&&t.isNext===!1||!b.length)&&(r.config.extraParams&&(t||(t={}),e.mix(t,r.config.extraParams)),c(t,function(t){if(t.success){if(i.success&&i.success(t)===!1)return r.__loading=0,!1;var s=t.globalData,c=s&&!e.isUndefined(s.currentPageSize)?s.currentPageSize:s.totalSize;c>0&&r.config.Cart&&r.config.Cart.render(t.list,t.globalData.page,t.globalData.startTime,t.globalData.endNotEqualTime),(Global.globalData.isEndPage===!0||c===s.totalSize||t.list&&0===t.list.length)&&(S=!1,Global.renderFooter()),Global.cfg.isYaoPartner&&l.init(),a.hide()}else!t.error||"CART_XIAO_ER_CANNOT_BUY"!==t.error.errorCode&&"CART_TMALL_SELLER_CANNOT_BUY"!==t.error.errorCode?h():(o.alert(t.error&&t.error.errorMessage?t.error.errorMessage:n.lang("TIPS_ERROR_CART_LOAD")),r.__disable=!0,Global.empty()),i.error&&i.error(t);return r.__loading=0,i.end&&i.end(t),Global.updateCart({page:t&&t.globalData?t.globalData.page:void 0,type:"load"}),Global.queue.next(),!0}))}}function m(e){var t=this;S=!0,t.config=e,t.container=_(e.container),t.__onScroll=function(){Global.isScrolling=!0,f&&clearTimeout(f),f=setTimeout(function(){Global.isScrolling=!1,d.call(t)},200)},t.load=function(e,i){p.call(t,e,i)},e.firstLoad!==!1&&t.load({},this.config.loadCfg),t.start()}function h(){KISSY.UA.ie?(document.documentElement.scrollTop=500,document.documentElement.scrollTop=5e4):(_("body").scrollTop(500),_("body").scrollTop(5e4))}var f,g="[loader] ",_=t.all,v=window,I=_(v),T=0,S=!0,b=[],E=0,C=3;return e.augment(m,{start:function(){!this.__started&&I.on("scroll",this.__onScroll)&&(this.__started=1)},end:function(){I.detach("scroll",this.__onScroll),this.__started=0},isLoading:function(){return 1===this.__loading},disable:function(){this.end(),this.__disable=!0}}),m},{requires:["node","ajax","../../utils/loading/loading","../../utils/dialog/dialog","./data","../../utils/i18n/i18n","./retcode","./yao-qrcode/yao-qrcode"]}),KISSY.add("cart/mods/order/orderData",function(e){function t(e){e.redemption=!1,e.extraItems&&e.extraItems.length&&(e.redemption=e.extraItems[0],e.redemption.type=e.redemption.type||"award",e.redemption.redemptedNum=e.redemption.totalExtraItemNum-e.redemption.remainExtraItemNum,e.redemption.disabled=0===e.redemption.remainExtraItemNum||0==e.model.totalShopPrice)}return{deal:function(i){var a;i.model=i.model||{},i.model.totalShopPrice=parseFloat(i.model.totalShopPrice)||0,e.each(i.bundles,function(t){i.bundles.length>1&&"shop"===t.type&&(t.title="\u666e\u901a\u5546\u54c1",t.type="normal"),e.each(t.orders,function(t){try{a=t.price.currency.unitFactor}catch(o){a=100}if(t.model&&t.model.isSelected&&t.isValid){var r=0;t.services&&e.each(t.services,function(e){r+=e.sum}),i.model.totalShopPrice+=parseFloat(r)+parseFloat(t.price.sum)}})}),i.model.totalShopPrice>0&&e.each(i.bundles,function(t){e.each(t.orders,function(e){e.extraItemInfo&&(e.model=e.model||{},e.model.isSelected=!0)})}),t(i);var o=[];return i.scrollPromos&&(e.each(i.scrollPromos,function(e){/<li/.test(e)?o.push(e):o.push("<li>"+e+"</li>")}),i.scrollPromos=o),i.smPostView=i.smPostView&&(i.smPostView.type!=-1||i.smPostView.extraInfo)&&i.smPostView.type!=-2?i.smPostView:"",i.smPostView&&(i.smPostView.priceStr=Global.utils.toMoney(i.smPostView.price,a),i.smPostView.weightStr=i.smPostView.weight/1e3||0,i.smPostView.priceLevelStr=Global.utils.toMoney(i.smPostView.priceLevel,a)||""),i.showFooter=i.smPostView||i.promView,i},dealRedemptionData:t}}),KISSY.add("cart/mods/order/tpl/redemption.tpl",function(e,t,i){var a=(t.all,'<div class="td-chk"></div>{{#if model && model.totalShopPrice && redemption.totalExtraItemNum > redemption.remainExtraItemNum && redemption.type == "award"}}<div class="remain">\u8fd8\u53ef\u6362\u8d2d<em class="J_Remain number">{{redemption.remainExtraItemNum}}</em>\u4ef6\u5546\u54c1</div>{{/if}}<div class="amount"><span class="redemption-count">'+i.lang("TPL_ITEM_SELECTED_SUM")+i.lang("TPL_COMMA")+'{{#if redemption.totalExtraItemNum > 1}}{{#if redemption.type == "freegift"}}'+i.lang("TPL_GET_SOME_FREE_ITEMS")+"{{#else}}"+i.lang("TPL_REDEEM_SOME_ITEMS")+'{{/if}}{{#else}}{{#if redemption.type == "freegift"}}'+i.lang("TPL_GET_ONE_FREE_ITEM")+"{{#else}}"+i.lang("TPL_REDEEM_ONE_ITEM")+'{{/if}}{{/if}}{{#if redemption.type == "freegift"}}{{#if redemption.redemptedNum}}\uff0c\u5df2\u9886\u53d6{{redemption.redemptedNum}}\u4ef6\u8d60\u54c1{{/if}}{{/if}}</span><a class="J_Redemption entry {{#if redemption.disabled}}entry-disabled{{/if}}" href="#" hidefocus="true">{{#if redemption.type == "freegift"}}\u9886\u53d6\u8d60\u54c1{{#else}}'+i.lang("REDEEM_NOW")+'{{/if}}<span class="arrow"></span></a></div>');return{redemptionTip:a,redemption:'{{#if redemption}}<div class="redemption-info"><div class="redemption-tip clearfix">'+a+'</div><div class="redemption-list J_RedemptionList carousel"></div><div class="redemption-sku J_SkuPanel"></div></div>{{/if}}'}},{requires:["node","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/order/tpl/poolorder.tpl",function(e,t,i){var a=(t.all,'{{#if poolOrderView}}{{#if poolOrderView.poolOrderDisplayType !== 4}}<div class="poolorder-info"><div class="wrap"><span class="text">{{#if poolOrderView.currentAction.length>0}}<span class="satisfied">\u5df2\u4eab\u53d7\u201c\u6ee1{{poolOrderView.currentCondition}}{{poolOrderView.currentAction[0]}}\u201d\uff0c</span>{{#if poolOrderView.currentAction.length>1}}<span class="satisfied">{{poolOrderView.currentAction[1]}}\uff0c</span>{{/if}}{{/if}}{{#if poolOrderView.advancedAction.length>0}}<span>\u518d\u4e70{{poolOrderView.gap}}\uff0c\u201c\u6ee1{{poolOrderView.advancedCondition}}{{poolOrderView.advancedAction[0]}}\u201d\uff0c</span>{{#if poolOrderView.advancedAction.length>1}}{{poolOrderView.advancedAction[1]}}\uff0c{{/if}}{{/if}}<span>\u8be5\u5e97\u94fa\u5546\u54c1\u5408\u8ba1\uff1a</span><span class="symbol"></span><span class="price">0.00</span></span><span class="go-pool">{{#if poolOrderView.poolOrderDisplayType !== 3}}<a href="javascript:;" id="J_GoPool">\u53bb\u51d1\u5355</a>{{#else}}<a href="javascript:;" id="J_GoPool">\u518d\u901b\u901b</a>{{/if}}<span class="arrow"></span></span></div><div class="poolorder-content hidden"><img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif"></div></div>{{/if}}{{/if}}');return{poolorder:a}},{requires:["node","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/order/tpl/order.tpl",function(e,t,i,a){var o='<div id="J_BundleList_{{uniqueId}}" class="item-list">{{#if bundles}}{{#each bundles as bundle index}}<div id="J_Bundle_{{#if uniqueId}}{{uniqueId}}_{{index}}{{#else}}{{bundle.id}}{{/if}}" class="bundle {{#if index === bundles.length - 1}} bundle-last {{/if}}">{{#if bundle.orders}}{{#each bundle.orders as item}}<div id="J_ItemHolder_{{item.cartId}}" class="item-holder"></div>{{/each}}{{/if}}</div>{{/each}}{{/if}}</div>',r='{{#if hasPriceVolume}}<span class="shop-coupon-trigger J_MyShopCoupon"><em>'+a.lang("COUPONS")+'</em><span class="arrow"></span></span>{{/if}}',n='{{#if isGoldSeller}}<span class="icon-golden-seller" title="'+a.lang("GOLDEN_SELLER")+'"></span>{{/if}}',s='{{#if isQiyeSeller}}<span class="icon-enterprise-seller" title="'+a.lang("ENTERPRISE_SELLER")+'"></span>{{/if}}',l='{{#if smPostViewV2}}<div class="redemption-info sm-post-view"><div class="redemption-tip clearfix"><div class="amount">{{#if smPostViewV2.icon}}<img height="16px" style="vertical-align: sub;" src={{smPostViewV2.icon}} />&nbsp;{{/if}}{{#if smPostViewV2.text}}<span>{{smPostViewV2.text}}</span>{{/if}}{{#if (smPostViewV2.url && smPostViewV2.urlText)}}<a href={{smPostViewV2.url}} class="coudan-v2" target="_blank"><span class="coudan-v2-text">{{smPostViewV2.urlText}}</span><span>></span></a>{{/if}}</div></div></div>{{#elseif smPostView}}<div class="redemption-info sm-post-view"><div class="redemption-tip clearfix"><div class="amount">{{#if promView}}{{promView.title}}{{#if smPostView}}\uff0c{{/if}}{{/if}}{{#if smPostView}}{{#if smPostView.type == 1}}{{#if smPostView.priceLevelStr}}<span>\u4eab\u6ee1{{smPostView.priceLevelStr}}\u5143{{#if smPostView.weight !== -1 && smPostView.weightStr}}\uff08{{smPostView.weightStr}}kg\u4ee5\u5185\uff09{{/if}}\u5305\u90ae</span>{{#else}}<span>\u60a8\u5df2\u4eab\u53d7\u514d\u8fd0\u8d39\u4f18\u60e0</span>{{/if}}{{#if smPostView.extraInfo}}<span>{{smPostView.extraInfo}}</span>{{/if}}{{#elseif smPostView.type == 0}}<span>\u518d\u4e70{{smPostView.priceStr}}\u5143{{#if smPostView.weightStr}}\uff08\u603b\u91cd\u5c0f\u4e8e{{smPostView.weightStr}}kg\uff09{{/if}}\u53ef\u514d\u8fd0\u8d39</span>{{#if smPostView.extraInfo}}<span>{{smPostView.extraInfo}}</span>{{/if}}<a href="//chaoshi.tmall.com" target="_blank">'+a.lang("COUDAN")+"</a>{{#elseif smPostView.extraInfo}}<span>{{smPostView.extraInfo}}</span>{{/if}}{{/if}}</div></div></div>{{/if}}",c='{{#if coupon1111}}<div class="coupon1111 clearfix"><div><img src="{{coupon1111.pic}}" title="{{coupon1111.text}}" alt="{{coupon1111.text}}" />{{coupon1111.text}}{{#if coupon1111.linkWord}}<a href="{{coupon1111.linkUrl}}" target="_blank">{{coupon1111.linkWord}}</a>{{/if}}</div></div>{{/if}}';return{normal:'<div id="J_Order_{{uniqueId}}" class="J_Order clearfix order-body {{#if extraItem}}order-redemption{{/if}} {{#if isValid === false}} order-invalid {{/if}} {{#if host === "CT"}} order-cuntao {{/if}}"><div class="J_ItemHead shop clearfix"><div class="shop-info">{{#if isValid}}<div class="cart-checkbox {{#if model && model.isChecked}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxShop" id="J_CheckShop_{{uniqueId}}" type="checkbox" name="orders[]" value="{{uniqueId}}" {{#if model && model.isChecked}}checked{{/if}} /><label for="J_CheckShop_{{uniqueId}}">'+a.lang("TIPS_SELECT_ALL_ITEMS_IN_THIS_SHOP")+'</label></div>&nbsp;&nbsp;{{/if}}{{#if icon}}<img src="{{icon}}" class="shop-img"/>{{#elseif host != "C"}}{{#if host.indexOf("SM") != -1}}<span class="shop-icon icon-SM"></span>{{#elseif host == "YYZY"}}<span class="shop-icon icon-B"></span>{{#elseif host.indexOf("HKGS") != -1}}<span class="shop-icon icon-HK"></span>{{#else}}<span class="shop-icon icon-{{host}}"></span>{{/if}}{{/if}}'+n+s+"{{#if title}}"+a.lang("SELLER")+'\uff1a<a href="{{url}}" target="_blank" title="{{title}}" class="J_MakePoint" data-point="tbcart.8.15">{{title}}</a>{{#elseif seller}}'+a.lang("SELLER")+'\uff1a<a href="{{url}}" target="_blank" title="{{seller}}" class="J_MakePoint" data-point="tbcart.8.15">{{seller}}</a>{{/if}}{{#if host !== "SM" && host !== "LG" && host !== "CT"}}{{#if seller}}<span class="J_WangWang" data-items="{{uniqueId}}" data-icon="small" data-nick="{{seller}}" data-display="inline"></span>{{/if}}{{/if}}'+r+'</div>{{#if scrollPromos}}<div class="order-promo-info" style="display: none;"><div class="scrolling-container"><ul class="scrolling-promo-hint J_ScrollingPromoHint">{{#each scrollPromos as promo}}{{promo}}{{/each}}</ul></div></div>{{/if}}</div><div class="order-content">'+o+t.redemption+i.poolorder+l+c+"</div></div>",combo:'{{#if groupId}}<div id="J_Order_{{uniqueId}}" class="J_Order clearfix order-body combo-order J_Combo {{#if isValid === false}} order-invalid {{/if}}"><div class="combo-main"><div class="td-chk combo-chk">{{#if isValid}}<div class="cart-checkbox {{#if model && model.isChecked}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxShop" id="J_CheckShop_{{uniqueId}}" type="checkbox" name="orders[]" value="{{uniqueId}}" {{#if model && model.isChecked}}checked{{/if}} /><label for="J_CheckShop_{{uniqueId}}">'+a.lang("TIPS_SELECT_PACKAGE")+'</label></div>{{#else}}<span class="act-status icon-invalid">'+a.lang("INVALID")+'</span>{{/if}}</div><div class="combo-list">'+o+'</div><div class="td-op combo-op"><div class="td-inner"><a href="javascript:;" class="J_ComboDel J_MakePoint">'+a.lang("DELETE")+'</a></div></div></div></div>{{#else}}<div id="J_Order_{{uniqueId}}" class="J_Order clearfix order-body combo-order J_Combo {{#if isValid === false}} order-invalid {{/if}}"><div class="J_ItemHead shop clearfix"><div class="shop-info">{{#if isValid}}<div class="cart-checkbox {{#if model && model.isChecked}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxShop" id="J_CheckShop_{{uniqueId}}" type="checkbox" name="orders[]" value="{{uniqueId}}" {{#if model && model.isChecked}}checked{{/if}} /><label for="J_CheckShop_{{uniqueId}}">'+a.lang("TIPS_SELECT_PACKAGE")+'</label></div>{{#else}}<span class="act-status">'+a.lang("INVALID_PACKAGE")+'</span>{{/if}}&nbsp;&nbsp;{{#if icon}}<img src="{{icon}}" class="shop-img"/>{{#elseif host != "C"}}<span class="icon-{{host}}"></span>{{/if}}'+n+'<span class="act-name" title="{{title}}">'+a.lang("PACKAGE")+"\uff1a{{title}}</span>"+r+'</div></div><div class="order-content clearfix">'+o+'<div class="td-op combo-order-op" style="height: {{comboHeight}}px;"><div class="vl"><div class="vl-wp"><div class="vl-cn"><a href="javascript:;" class="J_ComboDel J_MakePoint">'+a.lang("DELETE")+"</a></div></div></div></div>"+l+c+"</div></div>{{/if}}",act:'<div id="J_Order_{{uniqueId}}" class="J_Order clearfix order-body cross-shop-act J_CrossShopAct {{#if isValid === false}} order-invalid {{/if}}"><div class="J_ItemHead shop clearfix {{#if !isValid}} disable{{/if}}"><div class="shop-info">{{#if isValid}}<div class="cart-checkbox {{#if model && model.isChecked}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxShop" id="J_CheckShop_{{uniqueId}}" type="checkbox" name="orders[]" value="{{uniqueId}}" {{#if model && model.isChecked}}checked{{/if}} /><label for="J_CheckShop_{{uniqueId}}">'+a.lang("TIPS_SELECT_ACT")+'</label></div>&nbsp;&nbsp;{{#else}}<span class="act-status">'+a.lang("INVALID_ACT")+'</span>{{/if}}<a href="{{url}}" class="act-name J_MakePoint" data-point="tbcart.8.15" target="_blank" title="{{title}}">'+a.lang("ACT")+"\uff1a{{title}}</a>"+r+'</div>{{#if scrollPromos}}{{#if scrollPromos.length}}<div class="act-promo" style="display: none;"><div class="act-promo-wrapper"><ul class="act-promo-hint J_ScrollingPromoHint">{{#each scrollPromos as campaignPlan}}{{#if campaignPlan}}{{campaignPlan}}{{/if}}{{/each}}</ul></div></div>{{/if}}{{/if}}</div><div class="order-content">'+o+'{{#if gradeMessage}}<div class="act-saveinfo"><div class="msg"><p class="naked tips">{{gradeMessage}}</p></div></div>{{/if}}</div></div>',villager:'<div id="J_Order_{{uniqueId}}" class="J_Order clearfix order-body {{#if extraItem}}order-redemption{{/if}} {{#if isValid === false}} order-invalid {{/if}}"><div class="J_ItemHead shop clearfix"><div class="shop-info"><div class="cart-checkbox {{#if model && model.isChecked}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxShop" id="J_CheckShop_{{uniqueId}}" type="checkbox" name="orders[]" value="{{uniqueId}}" {{#if model && model.isChecked}}checked{{/if}} /><label for="J_CheckShop_{{uniqueId}}">'+a.lang("TIPS_SELECT_ACT")+"</label></div>"+n+s+"{{#if title}}"+a.lang("VILLAGER")+"\uff1a{{title}} {{/if}}"+r+'</div>{{#if scrollPromos}}<div class="order-promo-info" style="display: none;"><div class="scrolling-container"><ul class="scrolling-promo-hint J_ScrollingPromoHint">{{#each scrollPromos as promo}}{{promo}}{{/each}}</ul></div></div>{{/if}}</div><div class="order-content">'+o+t.redemption+l+"</div></div>"}},{requires:["./redemption.tpl","./poolorder.tpl","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/order/orderTPL",function(e,t,i,a,o,r,n){var s=t.all,l="[Template] order render ",c={};return{generate:function(t){var i;if(t){var n=t.type&&r[t.type]?t.type:"normal";c[n]=c[n]||a(r[n]),i=o(c[n],t,l)}else e.log(l+"error: order data cannot be recognized.");return i},render:function(t){var i=this.generate(t),a="J_OrderHolder_"+t.uniqueId,o=s("#"+a);return o&&0!==o.length?o.html(i):(e.log(l+"cannot find order holder for order:"+t.id),o=s('<div id="'+a+'"></div>').html(i).appendTo("#J_OrderList")),e.log(l+"order "+t.id+" rendered."),o},renderRedemption:function(e){var t="J_OrderHolder_"+e.uniqueId,i=s("#"+t);if(i&&i.length){var r=s(".redemption-info",i);if(r&&r.length){c.redemptionTip||(c.redemptionTip=a(n.redemptionTip));var d=o(c.redemptionTip,e,l);r.one(".redemption-tip").html(d)}}}}},{requires:["node","ua","gallery/template/1.0/","../../utils/tpl/render","./tpl/order.tpl","./tpl/redemption.tpl"]}),KISSY.add("cart/mods/bundle/tpl/bundle.tpl",function(e,t){var i='{{#if ctCouponInfoViews}}{{#if ctCouponInfoViews.length}}<span class="ct-coupon-trigger J_CtShopCoupon"><em>'+t.lang("COUPONS")+'</em><span class="arrow"></span></span>{{/if}}{{/if}}',a='<div id="J_ItemList_{{id}}" class="item-list">{{#if items}}{{#each items as item}}<div id="J_ItemHolder_{{item.cartId}}" class="item-holder"></div>{{/each}}{{/if}}</div>',o={act:'{{#if shopPromos}}<div class="bundle-hd"><div class="td-chk"></div><div class="bd-content">{{#if shopPromos.icon}}<div class="bd-title voucher-title"><img src="{{shopPromos.icon}}"><i class="icon-bd-title"></i></div>{{/if}}<span>{{shopPromos.msg}}</span>{{#if shopPromos.url}}<a class="J_GoVoucher goVoucher {{#if shopPromos.couponType}}J_MakePoint{{/if}}" {{#if shopPromos.couponType}}data-point="tbcart.8.100"{{/if}} href="{{shopPromos.url}}" target="_blank">{{shopPromos.nextTitle || "\u53bb\u51d1\u5355"}} ></a>{{/if}}</div></div>{{#else}}{{#if title}}<div class="bundle-hd"><div class="td-chk"></div><div class="bd-title">{{title}}<i class="icon-bd-title"></i></div><div class="bd-promos">{{#if promos}}{{#if promos.length}}<div class="bd-has-promo">'+t.tpl("DISCOUNT_ENJOYED")+':{{#each promos as promo}}{{#if promo}}<span class="bd-has-promo-content">{{promo}}</span>&nbsp;&nbsp;{{/if}}{{/each}}</div>{{/if}}{{/if}}{{#if gradeMessage}}<div class="bd-tips"><a href="{{url}}" target="_blank">{{gradeMessage}}&nbsp;<span class="gt">&gt;&gt;</span></a></div>{{/if}}{{#if scrollPromos}}<div class="act-promo"><div class="act-promo-wrapper"><ul class="act-promo-hint J_ScrollingPromoHint">{{#each scrollPromos as promo}}{{#if promo}}<li>{{promo}}</li>{{/if}}{{/each}}</div></div>{{/if}}</div>'+i+'</div>{{/if}}{{/if}}<div class="bundle-main">'+a+"</div>",supplier:'{{#if title}}<div class="bundle-hd"><div class="td-chk"></div><div class="bd-title">{{title}}<i class="icon-bd-title"></i></div> <span class="J_WangWang" data-items="{{title}}" data-icon="small" data-nick="{{title}}" data-display="inline"></span>'+i+'</div>{{/if}}<div class="bundle-main">'+a+"</div>"};return o.normal=o.act,o},{requires:["../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/bundle/bundleTPL",function(e,t,i,a,o){var r=t.all,n="[Template] bundle render ",s={};return{generate:function(t){var i;return t?(t.type&&o[t.type]||(t.type="normal"),e.log(n+"info: start for bundle:"+t.id+". The bundle type is "+t.type),i=o[t.type]):e.log(n+"error: bundle data cannot be recognized."),i},render:function(e){var t=this,l=r("#J_Bundle_"+e.uniqueId);return e=t.dataExtend(e),e.type&&o[e.type]&&(s[e.type]||(s[e.type]=i(o[e.type])),l.html(a(s[e.type],e,n))),l},dataExtend:function(e){if(e&&e.shopPromos){var t=e.shopPromos.url;t&&t.indexOf("type=")>-1?e.shopPromos.couponType=1==t.substr(t.indexOf("type=")+5,1)?"1":"":e.shopPromos.couponType=""}return e}}},{requires:["node","gallery/template/1.0/","../../utils/tpl/render","./tpl/bundle.tpl"]}),KISSY.add("cart/mods/item/promoTip/promo-logo-map",function(e){return{laba:{url:"//gtd.alicdn.com/tps/i1/T1N9lAFsBXXXXE4m2q-90-16.png",tips:"\u814a\u516b\u5e74\u8d27\u8282",extra:{2:{title:"\u3010\u814a\u516b\u5e74\u8d27\u8282\u3011"}}},"5zhe":{url:"//gtd.alicdn.com/tps/i1/T1XOlxFudfXXa9fH_f-38-16.png",tips:"5\u6298"},nmqc:{url:"//gtd.alicdn.com/tps/i1/T1iWFhFvNiXXafW0zi-53-16.png",tips:"\u5e74\u672b\u6e05\u4ed3"}}}),KISSY.add("cart/mods/item/promoTip/promoTitleMap",function(e,t){var i={groupingp:t.lang("PROMO_STORE"),shopvip:t.lang("PROMO_STORE_VIP"),tbvip:"VIP",limitp:t.lang("PROMO_LIMITED"),cartp:t.lang("PROMO_DISCOUNT"),jhs:t.lang("JUHUASUAN"),presale:t.lang("PRESELL"),activityp:t.lang("PROMO_ACTIVITY"),other:t.lang("PROMO_OTHER"),official:t.lang("PROMO_ACTIVITY"),nonofficial:t.lang("PROMO_NONOFFICIAL"),down:t.lang("PROMO_DOWN"),preOfficial:"10\u6708\u72c2\u6b22\u8282",preDown:t.lang("PROMO_DOWN"),mjhg:t.lang("PROMO_MJHG"),"default":t.lang("PROMO_DEFAULT"),Tmall$tmallAllPointPromotion:t.lang("PROMO_TMALL_POINT")};return function(e){return i[e]||(e="default"),i[e]}},{requires:["../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/icons/icon-map",function(e,t){t.all;return{"http://a.tbcdn.cn/tbsp/icon/xiaobao/a_quality_item_16x16.png":"//img.alicdn.com/tps/i4/T1JnMdFQFXXXaSQP_X-16-16.png","http://img04.taobaocdn.com/tps/i4/T1ZUaWXctlXXXXXXXX-16-16.gif":"","http://img03.taobaocdn.com/tps/i5/T1Z5hvXfpHXXXXXXXX-16-16.png":"","http://img07.taobaocdn.com/tps/i7/T1g9BqXoJfXXXXXXXX-16-16.png":"","http://img01.taobaocdn.com/tps/i1/T1Ek1gXfRtXXXXXXXX-16-16.gif":"","http://img01.taobaocdn.com/tps/i4/T1_ZFuXi4jXXXXXXXX-16-16.png":"","http://img01.taobaocdn.com/tps/i1/T1svydXBpfXXa46z6X-16-13.png":"//img.alicdn.com/tps/i3/TB1dtEWFVXXXXXwaXXXAz6UFXXX-16-16.png","http://a.tbcdn.cn/sys/common/icon/trade/item_cod.png":"//img.alicdn.com/tps/i3/TB1dtEWFVXXXXXwaXXXAz6UFXXX-16-16.png","http://assets.taobaocdn.com/sys/common/icon/trade/xcard.png":"//img.alicdn.com/tps/i2/T1uxT.FIXaXXaSQP_X-16-16.png","http://a.tbcdn.cn/sys/common/icon/trade/xcard.png":"//img.alicdn.com/tps/i2/T1uxT.FIXaXXaSQP_X-16-16.png","http://a.tbcdn.cn/tbsp/icon/xiaobao/a_7-day_return_16x16.png":"//img.alicdn.com/tps/i1/T1phr.FGRbXXaSQP_X-16-16.png","http://img03.taobaocdn.com/tps/i3/T17hHwXktgXXaHNz_X-16-16.gif":"","http://img01.taobaocdn.com/tps/i1/T1501KXiBuXXXXXXXX-18-18.png":"//img.alicdn.com/tps/i1/T18k.aFIpaXXaSQP_X-16-16.png","http://img03.taobaocdn.com/tps/i3/T1bnR4XEBhXXcQVo..-14-16.png":"//img.alicdn.com/tps/i4/T1yaEeFIJXXXaSQP_X-16-16.png","http://a.tbcdn.cn/tbsp/icon/xiaobao/a_true_description_16x16.png":"//img.alicdn.com/tps/i4/T1yaEeFIJXXXaSQP_X-16-16.png","http://img03.taobaocdn.com/tps/i3/T1DoWeXzpbXXcQVo..-14-16.png":"//img.alicdn.com/tps/i2/T1RNAdFJ8XXXaSQP_X-16-16.png","http://a.tbcdn.cn/tbsp/icon/xiaobao/an_authentic_item_16x16.png":"//img.alicdn.com/tps/i2/T1RNAdFJ8XXXaSQP_X-16-16.png","http://img02.taobaocdn.com/tps/i2/T18rKdXARfXXcQVo..-14-16.png":"//img.alicdn.com/tps/i4/T1ZUocFOFXXXaSQP_X-16-16.png","http://img04.taobaocdn.com/tps/i4/T1tZ5fXCRaXXadE...-14-15.png":"","http://img02.taobaocdn.com/tps/i2/T1wMedXqFfXXbRS1DX-15-16.png":"//img.alicdn.com/tps/i1/T1DpMcFIVaXXaSQP_X-16-16.png","http://img01.taobaocdn.com/tps/i1/T1blOeXCxbXXbCoE..-14-14.png":"","http://img04.taobaocdn.com/tps/i4/T1tPwAXeXeXXbPtI6h-47-14.gif":"//img.alicdn.com/tps/i3/T1e9cXFFhaXXaSQP_X-16-16.png"}},{requires:["node"]}),KISSY.add("cart/mods/item/itemData",function(e,t,i,a,o){function r(t){t.price.serviceTotal=0,t.serviceSkus=[];var i;try{i=t.price.currency.unitFactor}catch(a){i=100}return e.each(t.services,function(e,a){t.price.serviceTotal+=t.services[a].sum,t.services[a].collapseShow=a<4,t.services[a].price_str=parseFloat(t.services[a].price/i).toFixed(2),t.services[a].sum_str=parseFloat(t.services[a].sum/i).toFixed(2),e.storeName&&e.storeAddress&&t.serviceSkus.push({name:e.storeName,addr:e.storeAddress})}),t.serviceSkus.length<1&&(t.serviceSkus=null),t.price.serviceTotal=parseFloat(t.price.serviceTotal/i).toFixed(2),t}function n(t){return t.itemIcon&&(t._icons=[],t._iconAlias=[],e.each(t.itemIcon,function(i,a){e.each(i,function(e){t._icons.push(e)})}),t._icons.length&&e.each(t._icons,function(e){e&&e.img&&a[e.img]&&(e.img=a[e.img]),e.alias&&t._iconAlias.push(e.alias)})),t}function s(t){if(t.prePromos&&(0===t.prePromos.price&&!t.prePromos.hiddenPrice||t.prePromos.price>=t.price.now)&&(t.prePromos=null),t.prePromos){var a,r;try{a=t.price.currency.unitFactor}catch(n){a=100}try{r=t.price.currency.symbol}catch(n){r="\uffe5"}t.promotions=e.clone(t.prePromos),t.promotions.type="pre-promo",t.promotions.name="12.12\u4ef7",t.promotions.priceStr=0===t.prePromos.price?t.prePromos.hiddenPrice.replace(/\uff1f/g,"?"):Global.utils.toMoney(t.promotions.price,a),t.promotions.saved=0;var s=t.price.oriPromo-t.promotions.price;s>0&&(t.promotions.specialContent="12.12\u5f53\u5929\u6bd4\u52a0\u5165\u8d2d\u7269\u8f66\u65f6\u53c8\u4f18\u60e0\u4e86"+r+Global.utils.toMoney(s,a)),t.prePromos.hiddenPrice&&0===t.prePromos.price&&(t.promotions.showTip=!1)}else{var l=!1;t.promos&&t.promos.length&&e.each(t.promos,function(a){a&&a.length&&e.each(a,function(e){1!==e.type&&"promo"!==e.type||l!==!1||(l=!0,t.promotions=e,t.promotions.type="promo",t.promotions.name=i(t.promotions.style),t.promotions.saved=t.price.save)})}),l===!1&&t.price.save&&(t.promotions={type:"seller",saved:t.price.save,name:o.lang("PROMO_SELLER_PROMO"),title:o.lang("PROMO_SELLER_PROMO")})}var c=t.cartActiveInfo;if(c){if(c.isDefault===!0&&1!==c.wantStatus&&!t.prePromos){var d=t.price.descend||t.price.save;e.mix(t.promotions,{type:1!==c.type||d?"seller":"special",saved:d,name:c.name||o.lang("PROMO_SELLER_PROMO"),desc:c.slogan,content:c.content||"",activityType:c.type,except:c.except||""})}t.askPromo={open:c.isDefault===!1&&0!==c.wantStatus,asked:1===c.wantStatus}}return t.promotions?(c&&(t.promotions.endTime=c.endTime),t.price.oriPromo>t.price.now&&"pre-promo"!==t.promotions.type&&(t.promotions.diff=t.price.oriPromo-t.price.now),t.promotions.diff&&"promo"===t.promotions.type&&(t.promotions.type="seller",t.promotions.name=o.lang("PROMO_SELLER_PROMO")),t.promotions.period=p,t.promotions.hideTitle=1===p&&t.promotions.logos&&t.promotions.logos.length||!t.promotions.title,p>1&&(t.promotions.logos=[]),t.promotions.content=t.promotions.content||"",t.promotions.usedPoint=t.promotions.usedPoint||0):t.promotions={},t.promotions.name===i("default")&&(t.promotions={}),t.promotions.name===o.lang("PROMO_SELLER_PROMO")&&"false"===t.extInfo.isShowPriceDownLogo&&(t.promotions={}),t}function l(i){return i.promoLogos=[],i.promoPriceLogos=[],i.logo&&e.each(i.logo,function(a){if(!e.isObject(a)||i.promoCoupons&&"//img.alicdn.com/tps/i3/TB1jNHhGFXXXXc2XVXXLqEnIVXX-78-16.png"===a.url){a+="";var o=a.split("_");if(o&&o[0]&&t[o[0]]){var r=t[o[0]];if(o[1]&&"2"!=o[1]?i.promoLogos.push(r):i.promoPriceLogos.push(r),r.extra&&o[1]&&r.extra[o[1]]){var n=r.extra[o[1]];n&&n.title&&(i.title=n.title+i.title.replace(n.title,""))}}}else 2===a.pos?i.promoPriceLogos.push(a):i.promoLogos.push(a)}),0===i.promoLogos.length&&(i.promoLogos=!1),0===i.promoPriceLogos.length&&(i.promoPriceLogos=!1),i}function c(e){e.weightStr="",e.weight>0&&(e.weightStr="("+e.weight*e.amount.now/1e3+"kg)")}function d(e){var t=!1,i=new Date;e.isDouble11===!0&&e.leafCategory>0&&p<2&&(e.isValid===!1?t=!0:e.amount.max<=3&&i.getDate()>=5&&(t=!0)),e._showRelative=t}function u(t){return t.promoCoupons=[],t.promos&&t.promos.length&&e.each(t.promos,function(i){i&&i.length&&e.each(i,function(e){2===e.type&&t.promoCoupons.push(e)})}),t.promoCoupons.length||(t.promoCoupons=!1),t}var p=parseInt(Global.cfg.period,10);return{deal:function(t){t.model=t.model||{},t.randomNum=+new Date,t.period=p,t.pic=t.pic?t.pic.replace(/_(sum|\d{2,5}x\d{2,5})\.jpg$/,""):"",t.shopName=t.shopName?e.escapeHTML(t.shopName.replace("\\u","")):void 0;var i;try{i=t.price.currency.unitFactor}catch(a){i=100}return e.each(t.price,function(e,a){"currency"==a?t.price[a].symbol=unescape(e.symbol.replace(/\\u/g,"%u")):t.price[a+"_str"]=parseFloat(e/i).toFixed(2)}),t.skuStatus=t.skuStatus||0,r(t),n(t),s(t),u(t),l(t),c(t),d(t),t}}},{requires:["./promoTip/promo-logo-map","./promoTip/promoTitleMap","./icons/icon-map","../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/tpl/item.tpl",function(e,t){var i=(parseInt(Global.cfg.period,10),"//assets.alicdn.com/s.gif"),a='{{#if icon.link}}<a href="{{icon.link}}" target="_blank" class="item-icon item-icon-{{index}} J_MakePoint" data-point="tbcart.8.26" title="{{icon.title}}"><img src="{{icon.img}}" alt="{{icon.name}}" /></a>{{#else}}<span class="item-icon item-icon-{{index}}" title="{{icon.title}}"><img src="{{icon.img}}" alt="{{icon.name}}" /></span>{{/if}}',o={limitPromo:'{{#if cartsPromos}}<div class="limitPromo {{#if promotion_end}}promo-end{{/if}}"><div class="promo-wrapper"><span class="promo-icon">{{cartsPromos.title}}</span><span class="promo-desc">{{#if cartsPromos.url}}<a href="{{cartsPromos.url}}" target="_blank">{{/if}}{{cartsPromos.msg}}{{#if cartsPromos.url}}</a>{{/if}}{{#if promotions.diff}}\uff0c\u6bd4\u52a0\u5165\u8d2d\u7269\u8f66\u65f6\u4f18\u60e0\u4e86{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{#if price && price.currency && price.currency.unitFactor}}{{Global.utils.toMoney(promotions.diff, price.currency.unitFactor)}}{{/if}}{{/if}}</span>{{#if promotion_end}}<span class="promo-countdown">\u4f18\u60e0\u6d3b\u52a8\u5df2\u7ed3\u675f</span>{{#else}}<span class="J_Countdown_parent promo-countdown">\u79bb\u6d3b\u52a8\u7ed3\u675f\uff1a<span class="J_Countdown"></span></span>{{/if}}</div></div>{{/if}}',checkbox:'{{#if isValid}}{{#if type === "combo" || orderType === "combo"}}{{#elseif type == "redemption"}}<em class="item-label label-{{extraItemInfo.type}}">{{#if extraItemInfo.type == "freegift"}}'+t.lang("GIFT")+"{{#else}}"+t.lang("REDEEM")+'{{/if}}</em>{{#else}}<div class="cart-checkbox {{#if model && model.isSelected}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxItem" id="J_CheckBox_{{cartId}}" type="checkbox" name="items[]" value="{{cartId}}" {{#if model && model.isSelected}}checked{{/if}} /><label for="J_CheckBox_{{cartId}}">'+t.lang("TIPS_ITEM_SELECT")+'</label></div>{{/if}}{{#elseif type === "presell"}}<a class="icon-presell" title="'+t.lang("TIPS_PRESELL_BUY")+'" href="javascript: void(0);">'+t.lang("PRESELL")+'</a>{{#elseif type === "ju11"}}<a class="icon-ju11" title="'+t.lang("TIPS_GROUP_BUY")+'" href="javascript: void(0);">'+t.lang("JUHUASUAN")+'</a>{{#elseif type === "nocheckbox"}}<a class="item-label item-label-nocheckbox" style="background-color:{{checkbox.color}};" title="'+t.lang("NO_CHECKBOX")+'" href="javascript: void(0);">{{checkbox.text}}</a>{{#else}}<a class="item-label label-invalid" title="'+t.lang("TIPS_ITEM_INVALID")+'" target="_blank" href="//service.taobao.com/support/knowledge-1116245.htm">'+t.lang("INVALID")+"</a>{{/if}}",itemInfo:{itemPic:'<div class="item-pic J_ItemPic"><a href="{{url}}" target="_blank" data-title="{{title}}" class="J_MakePoint J_GoldReport" data-point="tbcart.8.12">{{#if pic == ""}}<img src="//img.alicdn.com/tps/TB1LQ9WLXXXXXaUXFXXXXXXXXXX-50-50.gif" alt="{{title}}" class="itempic J_ItemImg" />{{#else}}<img src="'+i+'" lazyload="{{pic}}_80x80.jpg" class="itempic J_ItemImg" />{{/if}}</a></div>',
itemTitle:'<a href="{{url}}" target="_blank" title="{{title}}" class="item-title J_GoldReport J_MakePoint" data-point="tbcart.8.11" />{{title}}</a>',itemRegion:'{{#if region}}<p class="sale-region">\u4ec5\u552e{{region.name}}</p>{{/if}}',itemSMPostFree:'{{#if postFreeInfo}}<p class="sm-post-free">{{postFreeInfo}}</p>{{/if}}',itemTry:'{{#if trial}}<a title="\u8bd5\u7528\u670d\u52a1\uff1a{{trial.message}}"><img class="itemicon" src="//gtd.alicdn.com/tps/i4/T1ZUaWXctlXXXXXXXX-16-16.gif"/></a>{{/if}}',itemIcons:'{{#if _icons}}<div class="item-icon-list clearfix"><div class="item-icons J_ItemIcons {{#if _collapseIcons}} item-icons-collapse {{#else}} item-icons-fixed {{/if}}">{{#each _icons as icon index}}'+a+'{{/each}}{{#if _collapseIcons}}<span class="more">'+t.lang("MORE")+'<span class="arrow"></span></span>{{/if}}</div></div>{{/if}}',itemProps:'{{#if skus}}<div class="item-props">{{#each skus as value name}}<span>{{name}}: {{value}}</span>{{/each}}</div>{{/if}}',itemXiaoBao:'{{#if xb && xb.length}}<div class="xb"><span>'+t.lang("PROTECTION")+": </span>{{#each xb as icon}}{{ICONS_MAP[icon]}}{{/each}}</div>{{/if}}",itemShopInfo:'{{#if host !== "SM"}}{{#if type == "combo" || type == "campaign" || orderType == "act" || orderType == "combo"}}<div class="shop-info">{{#if shopName}}<a title="{{shopName}}" class="shop-title J_MakePoint" data-point="tbcart.8.15" target="_blank" href="{{shopUrl}}">{{shopName}}</a>{{/if}}{{#if icon}}<img src="{{icon}}" class="shop-img"/>{{#elseif host != "C"}}<span class="host-icon icon-{{host}}"></span>{{/if}}<span class="J_WangWang" data-icon="small" data-nick="{{seller}}" data-display="inline"></span></div>{{/if}}{{/if}}',itemLogos:'<div class="promo-logos">{{#if promoLogos}}{{#each promoLogos as logo}}<p class="promo-logo">{{#if logo.link}}<a href="{{logo.link}}" target="_blank" title="{{logo.tips}}">{{/if}}<img src="{{logo.url}}" alt="{{logo.tips}}" title="{{logo.tips}}" />{{#if logo.link}}</a>{{/if}}</p>{{/each}}{{/if}}{{#if promoCoupons}}{{#each promoCoupons as coupon}}<p class="promo-logo"><span class="tbc-double-12-label" data-type="coupon" data-value="{{coupon.usedPoint}}"></span></p>{{/each}}{{/if}}</div>',itemTips:'<div class="item-tips">{{#if preSellText}}<p>{{preSellText}}</p>{{/if}}</div>'},services:'{{#if services}}<div class="item-services-hr"><div class="td td-chk"></div><div class="td td-item"><div class="item-info"></div></div><div class="td td-info"></div><div class="td td-price"></div><div class="td td-amount"></div><div class="td td-sum"></div><div class="td td-op"></div></div>{{#if serviceSkus}}{{#each serviceSkus as svSku}}<div class="item-services item-service-sku"><div class="service-wp"><span class="service-header">{{svSku.name}}</span><span class="service-address">{{svSku.addr}}</span></div></div>{{/each}}{{/if}}<div class="item-services {{#if model && model.serviceCollapsed !== false}} services-collapsed {{/if}}"><div class="td-chk"></div><div class="service-wp"><a class="service-header J_ToggleSerivces" href="javascript:void(0);">'+t.lang("AFTER_SALE_SERVICE")+'<span class="arrow"></span></a><ul class="services-list">{{#each services as service}}<li class="service-list {{#if service.collapseShow}}collapse-show{{/if}}"><div class="td td-item"><div class="item-info" style="background-image: url({{service.icon}})"><a class="service-title J_MakePoint" href="{{service.url}}" data-point="tbcart.8.27" target="_blank">{{service.title}}</a></div></div><div class="td td-info"></div><div class="td td-price"><div class="td-inner"><span class="price">{{#if service.promo}}{{service.promo}}{{#else}}{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{service.price_str}}{{/if}}</span></div></div><div class="td td-amount"><div class="td-inner"><span class="number">{{service.quantity}}</span></div></div><div class="td td-sum"><div class="td-inner"><span class="price">{{service.sum_str}}</span></div></div></li>{{/each}}</ul></div><div class="td-op"></div><div class="service-total td-sum"><div class="td-inner"><span class="price">{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{price.serviceTotal}}</span></div></div></div>{{/if}}',info:'<div class="item-props {{#if skuStatus === 2}}item-props-can{{#elseif skuStatus === 1}}item-add-props{{/if}}">{{#if skus}}{{#each skus as value name}}<p class="sku-line" tabindex="0">{{name}}\uff1a{{value}}</p>{{/each}}{{/if}}{{#if skuStatus === 2 && type !="villager"}}<span tabindex="0" class="btn-edit-sku J_BtnEditSKU J_MakePoint" data-point="tbcart.8.10">'+t.lang("MODIFY")+'</span>{{#elseif skuStatus === 1}}<a tabindex="0" title="'+t.lang("SELECT_ITEM_INFO")+'" href="javascript:void(0);" class="cart-btn-white btn-select-sku J_AddSkuBtn J_MakePoint" data-point="tbcart.8.13">'+t.lang("SELECT_ITEM_INFO")+"</a>{{/if}}</div>",price:'<div class="item-price price-promo-{{promotions.type}}"><div class="price-content">{{#if price.now < price.origin}}<div class="price-line"><em class="price-original">{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{price.origin_str}}</em></div>{{/if}}<div class="price-line"><em class="J_Price price-now" tabindex="0">{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{price.now_str}}</em></div></div>{{#if isValid}}{{#if promotions && promotions.type}}{{#if promotions.type === "pre-promo"}}<div class="pre-promos {{#if promotions.showTip === false}}{{#else}}J_ItemPromotions{{/if}}"><div class="promo-price"><em>{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{prePromos.priceStr}}</em><span class="arrow"></span></div></div>{{#else}}{{#if promotions.hideTitle === false}}<div class="promo-main promo-{{promotions.type}}"><div class="promo-content {{#if promotions.endTime}} promo-limited {{/if}} {{#if promotions.style}}promo-{{promotions.style}}{{/if}} J_ItemPromotions">{{#if promotions.endTime}}<span class="icon-time"></span>{{/if}}{{promotions.name}}{{#if promotions.name}}<span class="arrow"></span>{{/if}}</div></div>{{/if}}{{#if promotions.logos && promotions.logos.length}}<div class="promo-logos J_PromoLogos" {{#if promotions.period === 0}} style="display:none" {{/if}}>{{#each promotions.logos as logo}}<p class="promo-logo"><img src="{{logo.logoUrl}}" alt="{{logo.tips}}" title="{{logo.tips}}" /></p>{{/each}}</div>{{/if}}{{/if}}{{/if}}{{#if askPromo}}{{#if askPromo.open === true}}<div class="ask-promo"><a class="promo-ask-btn J_AskPromotion">{{#if askPromo.asked === true}}\u5df2{{/if}}\u6c42\u4f18\u60e0</a></div>{{/if}}{{/if}}{{/if}}{{#if promoPriceLogos}}<div class="promo-logos">{{#each promoPriceLogos as logo}}<p class="promo-logo">{{#if logo.link}}<a href="{{logo.link}}" target="_blank" title="{{logo.tips}}">{{/if}}<img src="{{logo.url}}" alt="{{logo.tips}}" title="{{logo.tips}}" />{{#if logo.link}}</a>{{/if}}</p>{{/each}}</div>{{/if}}</div>',amount:'<div class="amount-wrapper {{#if amount.multiple > 1 || amount.max < 1 || amount.max < amount.now || amount.limit <= amount.max || amount.max <= 3 || amount.supply < amount.demand}}amount-has-error{{/if}}">{{#if type == "combo" || type=="villager" || type == "redemption" || orderType == "combo" || (Global.cfg.isCuntaoPartner && Global.cfg.type === 0)}}<div class="item-static-amount">{{amount.now}}</div>{{#else}}<div class="item-amount {{#if isValid && amount.max <= 3 && type == "redemption"}} s-lack {{/if}}">{{#if isValid && type !== "redemption" && type !== "presell"}}<input type="text" value="{{amount.now}}" class="text text-amount J_ItemAmount" data-max="{{amount.max}}" data-now="{{amount.now}}" autocomplete="off" />{{#else}}{{amount.now}}{{/if}}</div>{{#if isValid && type !== "presell"}}<div class="amount-msg J_AmountMsg">{{#if amount.multiple > 1}}<em class="s-amount-tip">'+t.lang("TPL_MULTIPLE_PURCHASE")+'</em>{{/if}}{{#if amount.max < 1}}<em class="error-msg">'+t.lang("TIPS_NO_STOCK")+'</em>{{#elseif amount.max < amount.now}}<em class="error-msg">'+t.lang("TPL_MAX_PURCHASE")+'</em>{{#elseif amount.limit <= amount.max}}<em class="s-danger-text">'+t.lang("TPL_LIMIT_PURCHASE")+'</em>{{#elseif amount.max <= 3}}<em class="s-danger-text" title="'+t.lang("TPL_TIPS_LOW_STOCK")+'">'+t.lang("STOCK_TENSE")+'</em>{{#elseif amount.supply < amount.demand}}<em class="error-msg" title="'+t.lang("TPL_TIPS_LOW_STOCK_POPULAR")+'">'+t.lang("STOCK_TENSE")+"</em>{{/if}}</div>{{/if}}{{/if}}</div>",total:'<em tabindex="0" class="J_ItemSum number">{{#if price.customNowTitle}}{{price.customNowTitle}}{{#else}}{{#if price && price.currency && price.currency.symbol}}{{price.currency.symbol}}{{/if}}{{price.sum_str}}{{/if}}</em><div class="J_ItemLottery"></div>{{#if price.appendCustomNowTitle}}<div class="weight">{{price.appendCustomNowTitle}}</div>{{/if}}{{#if weightStr}}<div class="weight">{{weightStr}}</div>{{/if}}{{#if itemTaxRateStr}}<div class="weight">{{itemTaxRateStr}}</div>{{/if}}',operations:'{{#if type=="villager"}}'+t.lang("NO_OPERATOR")+'{{#else}}{{#if type !== "presell"}}<a  title="'+t.lang("FAV")+'"  class="btn-fav J_Fav J_MakePoint"  data-point-url="//www.atpanel.com/jsclick?cache={{randomNum}}1&mycart=collect" href="#">'+t.lang("FAV")+'</a>{{/if}}<a href="javascript:;" data-point-url="//www.atpanel.com/jsclick?cache={{randomNum}}2&cartlist=delete" class="J_Del J_MakePoint">'+t.lang("DELETE")+'</a>{{#if !Global.globalData.isCloseInvalidItemFindSimilar}}{{#if Global.cfg.domain==="taobao"}}<div class="find-similar J_find_similar close" data-sellerid="{{sellerId}}" data-itemid="{{itemId}}" data-categoryid="{{leafCategory}}"><div class="J_find_similar_trigger"><a href="javascript:;" class="new-find-similar">'+t.lang("SIMILAR")+'</a><span class="arrow"></span><i class="icon-bd-title"></i></div><div class="find-similar-body"><img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif" class="find-similar-loading" /></div></div>{{/if}}{{/if}}{{/if}}',villagerInfo:'<div class="item-vil"><div class="vil-content"><ul>{{#if typeof villagers === "object"}}{{#each villagers as villager}}<li class="vil-line clearfix"><span class="vil-name" title="{{villager.name}} / {{villager.mobile}}">{{villager.name.substr(0,4)}}</span><div class="vil-amount">{{#if isValid}}<input type="text" value="{{villager.quantity}}" class="text vil-text-amount J_ItemVil"/>{{#else}}{{villager.quantity}}{{/if}}</div></li>{{/each}}{{/if}}</ul></div><div class="vil-msg"></div><span tabindex="0" class="btn-add-villager">'+t.lang("ADD_VILLAGER")+"</span></div>",findSimilar:'{{#if !Global.globalData.isCloseInvalidItemFindSimilar}}{{#if Global.cfg.domain==="taobao"}}{{#if !isValid}}<div class="find-similar J_find_similar close" data-sellerid="{{sellerId}}" data-itemid="{{itemId}}" data-categoryid="{{leafCategory}}"><div class="find-similar-head J_find_similar_trigger"><span class="find-similar-head-info">\u67e5\u770b\u8be5\u5546\u54c1\u76f8\u4f3c\u5b9d\u8d1d</span><span class="find-similar-head-link-open">\u70b9\u51fb\u67e5\u770b</span><span class="find-similar-head-link-close">\u6536\u8d77</span><span class="find-similar-icon arrow"></span></div><div class="find-similar-body"><img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif" class="find-similar-loading" /></div></div>{{/if}}{{/if}}{{/if}}'};return["<div ",' id="J_Item_{{cartId}}" ','class="J_ItemBody item-body clearfix item-{{type}} {{#if services}}item-with-services{{/if}} {{#if isFirstOne}}first-item{{/if}} {{#if isLastOne}} last-item {{/if}} {{#if isValid === false && type !== "ju11" && type !== "presell" && type !== "nocheckbox"}} item-invalid {{/if}} {{#if model && model.isSelected}} selected item-selected {{/if}}" ',">",'{{#if type !== "combo"}}'+o.limitPromo+"{{/if}}",'<ul class="item-content clearfix">','<li class="td td-chk">','<div class="td-inner">'+o.checkbox+"</div>","</li>",'<li class="td td-item">','<div class="td-inner">',o.itemInfo.itemPic,'<div class="item-info">','<div class="item-basic-info">',o.itemInfo.itemTitle,o.itemInfo.itemRegion,o.itemInfo.itemSMPostFree,"</div>",'<div class="item-other-info">',o.itemInfo.itemShopInfo,o.itemInfo.itemLogos,o.itemInfo.itemIcons,o.itemInfo.itemTips,"</div>","</div>","</div>","</li>",'<li class="td td-info">',o.info,"</li>",'<li class="td td-price">','<div class="td-inner">'+o.price+"</div>","</li>",'<li class="td td-amount">','<div class="td-inner">'+o.amount+"</div>","</li>",'<li class="td td-sum">','<div class="td-inner">'+o.total+"</div>",'</li><li class="td td-op">','<div class="td-inner">{{#if type !== "combo"}}'+o.operations+"{{/if}}</div>",'</li>{{#if Global.cfg.isCuntaoPartner && Global.cfg.type === 0 && !isPreSell}}<li class="td td-vil">'+o.villagerInfo+"</li>{{/if}}</ul>",o.services,"</div>"]},{requires:["../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/itemTPL",function(e,t,i,a,o){function r(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var n=t.all,s="[Template] item render ",l=[];return e.each(o,function(e){l.push(i(e))}),{generate:function(t){var i="";if(t&&t.cartId){if(t.skus)for(var o in t.skus)t.skus[o]=r(t.skus[o]);e.each(l,function(e){i+=a(e,t,s)})}return i},render:function(t){var i=this.generate(t);if(t&&t.cartId){var a=n("#J_ItemHolder_"+t.cartId);return a&&a.length?(a.html(i),a):(e.log(s+"cannot find item holder for item:"+t.cartId),null)}return e.log(s+"error: cannot find item id."),null}}},{requires:["node","gallery/template/1.0/","../../utils/tpl/render","./tpl/item.tpl"]}),KISSY.add("cart/mods/item/quantity/effect",function(e,t,i){"use strict";var a=t.all,o=null,r=null;return{increase:function(e,t,n,s,l){if(i.ie<8||""!==Global.cfg.client)return void(l&&l());if(parseInt(n,10)!==parseInt(s,10)){o&&o.stop(),r&&r.stop();for(var c=n+"",d="",u=s+"",p="",m=t.width(),h=t.outerHeight(),f=0;f<c.length;f++)d+='<span style="position:relative;top:0;">'+c[f]+"</span>";t.css("color","#fff"),e.css("position","relative"),e.prepend('<span class="numSpan" style="position:absolute;width:'+m+"px;height:"+h+"px;line-height:"+h+'px;margin:0;padding:0;text-align:center;top:0;left:19px;">'+d+"</span>");var g=e.all(".numSpan"),_=g.last("span");_&&(r=_.animate({top:-25,opacity:.5},{duration:.2,complete:function(){g.remove()}}));for(var v=0;v<u.length;v++)p+='<span style="position:relative;">'+u[v]+"</span>";var I=a('<span class="downSpan" style="position:absolute;width:'+m+"px;height:"+h+"px;line-height:"+h+'px;margin:0;padding:0;text-align:center;top:35px;left:19px;opacity:0.5;">'+p+"</span>");e.append(I);var T=e.all(".downSpan"),S=T.last("span");o=S.animate({top:-35,opacity:1},{duration:.2,complete:function(){T.remove(),e.css("position",""),t.css("color","#3c3c3c"),l&&l()}})}},decrease:function(e,t,n,s,l){if(i.ie<8||""!==Global.cfg.client)return void(l&&l());if(parseInt(n,10)!==parseInt(s,10)){o&&o.stop(),r&&r.stop();for(var c=n+"",d="",u=s+"",p="",m=t.width(),h=t.outerHeight(),f=0;f<c.length;f++)d+='<span style="position:relative;top:0;">'+c[f]+"</span>";t.css("color","#fff"),e.css("position","relative"),e.prepend('<span class="numSpan" style="position:absolute;width:'+m+"px;height:"+h+"px;line-height:"+h+'px;margin:0;padding:0;text-align:center;top:0;left:19px;">'+d+"</span>");var g=e.all(".numSpan"),_=g.last("span");_&&(r=_.animate({top:25,opacity:.5},{duration:.2,complete:function(){g.remove()}}));for(var v=0;v<u.length;v++)p+='<span style="position:relative;">'+u[v]+"</span>";var I=a('<span class="upSpan" style="position:absolute;width:'+m+"px;height:"+h+"px;line-height:"+h+'px;margin:0;padding:0;text-align:center;opacity:0.5;top:-35px;left:19px;">'+p+"</span>");e.append(I);var T=e.all(".upSpan"),S=T.last("span");o=S.animate({top:35,opacity:1},{duration:.2,complete:function(){T.remove(),e.css("position",""),t.css("color","#3c3c3c"),l&&l()}})}}}},{requires:["node","ua"]}),KISSY.add("cart/mods/item/quantity/quantity",function(e,t,i,a,o,r){function n(t){e.mix(this,t),this._init(t)}var s=t.all;parseInt(Global.cfg.period);return e.augment(n,{_init:function(){this._initUI(),this._bindEvents()},_initUI:function(){var e=this.item.data,t=parseInt(i.val(this.triggerEl),10),a=e.amount.multiple||1,o=t>a?"minus":"no-minus",r=t>=e.amount.max||t>=e.amount.limit?"no-plus":"plus";this.minusEl=i.create('<a href="#" class="J_Minus '+o+'">-</a>'),this.plusEl=i.create('<a href="#" class="J_Plus '+r+'">+</a>'),this.containerEl=i.parent(this.triggerEl),i.insertBefore(this.minusEl,this.triggerEl),i.insertAfter(this.plusEl,this.triggerEl)},_bindEvents:function(){this.item.itemEl.delegate("click",".J_Minus",this._minusClickHandler,this).delegate("click",".J_Plus",this._plusClickHandler,this),a.on(this.triggerEl,"valuechange",this._valueChangeHandler,this)},_valueChangeHandler:function(){this.timer&&clearTimeout(this.timer),this._doCheckQuantity(this._getCurVal()),this._doCheck()},_minusClickHandler:function(t){if(t.preventDefault(),!i.hasClass(this.minusEl,"no-minus")){this.timer&&clearTimeout(this.timer);var a=this._getCurVal(),r=this._doCheckQuantity(this._changeAmount(-1));o.decrease(s(this.containerEl),s(this.triggerEl),a,r,e.bind(function(){this._doCheck(500)},this))}},_plusClickHandler:function(t){if(t.preventDefault(),!i.hasClass(this.plusEl,"no-plus")){this.timer&&clearTimeout(this.timer);var a=this._getCurVal(),r=this._doCheckQuantity(this._changeAmount(1));o.increase(s(this.containerEl),s(this.triggerEl),a,r,e.bind(function(){this._doCheck(500)},this))}},_getCurVal:function(){return parseInt(e.trim(i.val(this.triggerEl)),10)||1},_changeAmount:function(e){var t=this.item.data.amount,i=t.multiple||1,a=this._getCurVal();return e&&(i>1?0<e?a+=i-a%i:a-=a%i?a%i:i:a+=e),a<1&&(a=1),a},_doCheck:function(e){var t=this,i=t.item.data.amount,a=i.now;a!==t._getCurVal()&&(t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){var e=t._getCurVal();t._updateItem(e)},e||300),Global.utils.makepoint("8.9"))},_doCheckQuantity:function(e){var t=this.item.data.amount,a=this.triggerEl,o=t.max,n=t.limit,s=t.now,l=t.demandQuality||0,c=t.supplyQuality||0,d=t.multiple||1;e<=0&&(e=1),e<=d?i.replaceClass(this.minusEl,"minus","no-minus"):i.replaceClass(this.minusEl,"no-minus","minus"),e>=o||e>=n?i.replaceClass(this.plusEl,"plus","no-plus"):i.replaceClass(this.plusEl,"no-plus","plus"),/^\d+$/.test(e+"")?0===o?(this._addError(r.lang("OUT_OF_STOCK")),e=0):e>o?(this._addError(r.lang("MAX_PURCHASE",{num:o})),e=o):s>o&&e>o?(this._addError(r.lang("MAX_PURCHASE",{num:o})),e=o):l>c?this._addError(r.lang("TIPS_LOW_STOCK_POPULAR",{num:c,num_people:l})):0!==e%d&&e!==o&&(this._addError(r.lang("MULTIPLE_PURCHASE",{num:d})),e=d):e=s;var u="",p="";return n<=o?u=r.lang("LIMIT_PURCHASE",{num:n}):o<=3&&(u=r.lang("STOCK_TENSE"),p=r.lang("TIPS_LOW_STOCK",{num:o})),u&&this._addError(u,p,"s-danger-text"),i.val(a,e),e},_updateItem:function(e){var t=this,i=t.item;t.triggerEl;this._updateSum(e),Global.request({updateUnselect:!i.isSelected(),operate:i,quantity:e,orders:i.getOrder(),type:"update",silent:!0,success:function(e){},error:function(i){i.message&&t._addError(i.message),t._updateQuantity(e)}})},_updateSum:function(e){var t,i,a=this.item;try{t=a.data.price.currency.symbol}catch(o){t="\uffe5"}try{i=a.data.price.currency.unitFactor}catch(o){i=100}a.data.amount.now=e,a.data.price.sum=a.data.price.now*e,a.itemSumEl.html(t+Global.utils.toMoney(a.data.price.sum,i))},_updateQuantity:function(e){var t=this.triggerEl;this._updateSum(e),i.val(t,e),Global.updateCart()},_addError:function(e,t,a){t=t||"",a=a||"error-msg",this._removeError();var o=i.create('<em class="'+a+'"'+(t?' title="'+t+'"':"")+">"+e+"</em>");i.append(o,i.get(".J_AmountMsg",this.item.itemEl))},_removeError:function(){var e=i.query("em",i.get(".J_AmountMsg",this.item.itemEl));i.remove(e)}}),n},{requires:["node","dom","event","./effect","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/villager/villagerItem",function(e,t,i,a,o,r,n,s){var l=t.all,c=o.extend({initializer:function(){this._initParams(),this._initUI(),this._bindEvents()},_initParams:function(){var t=this.get("item"),i=this.get("index"),a=t.data,o=Math.min(a.amount.max,a.amount.limit);e.each(a.villagers,function(e,t){t!==i&&(o-=e.quantity)},this),this.set("max",o)},_initUI:function(){var e=this.get("item"),t=this.get("triggerEl");if(t.length){var a=(e.data,parseInt(i.val(t),10)),o=1!==a?"minus":"no-minus",r=a>=this.get("max")?"no-plus":"plus";this.minusEl=i.create('<a href="#" class="V_Minus '+o+'">-</a>'),this.plusEl=i.create('<a href="#" class="V_Plus '+r+'">+</a>'),this.delEl=i.create('<a href="javascript:void(0);" class="vil-del"></a>'),this.containerEl=i.parent(t),i.insertBefore(this.minusEl,t),i.insertAfter(this.plusEl,t),i.insertAfter(this.delEl,this.containerEl)}},_bindEvents:function(){l(this.containerEl).delegate("click",".V_Minus",this._minusClickHandler,this).delegate("click",".V_Plus",this._plusClickHandler,this),l(this.delEl).on("click",this._delClickHandler,this),a.on(this.get("triggerEl"),"valuechange",this._valueChangeHandler,this)},_valueChangeHandler:function(){this.timer&&clearTimeout(this.timer),this._doCheckQuantity(this._getCurVal()),this._doCheck()},minus:function(){this._minusClickHandler()},plus:function(){this._plusClickHandler()},_minusClickHandler:function(t){if(t&&t.preventDefault(),!i.hasClass(this.minusEl,"no-minus")){this.timer&&clearTimeout(this.timer);var a=this._getCurVal(),o=this._doCheckQuantity(this._changeAmount(-1));r.decrease(l(this.containerEl),this.get("triggerEl"),a,o,e.bind(function(){this._doCheck(500)},this))}},_plusClickHandler:function(t){if(t&&t.preventDefault(),!i.hasClass(this.plusEl,"no-plus")){this.timer&&clearTimeout(this.timer);var a=this._getCurVal(),o=this._doCheckQuantity(this._changeAmount(1));r.increase(l(this.containerEl),this.get("triggerEl"),a,o,e.bind(function(){this._doCheck(500)},this))}},_delClickHandler:function(){var t=this.get("item");return 1===t._villager._villagerItems.length?(this._addError(s.lang("VILLAGER_CANNOT_EMPTY")),void setTimeout(e.bind(this._removeError,this),2e3)):void n.confirm(s.lang("TIPS_CONFIRM_DELETE_VILLAGER"),s.lang("PROMPT_MESSAGE"),void 0,e.bind(function(){this.set("quantity",0)},this))},_getCurVal:function(){return parseInt(e.trim(this.get("triggerEl").val()),10)||1},_changeAmount:function(e){var t=this.get("item"),i=t.data.amount,a=i.multiple||1,o=this._getCurVal();return e&&(a>1?0<e?o+=a-o%a:o-=o%a?o%a:a:o+=e),o<1&&(o=1),o},_confirmDelete:function(t){var i=new KISSY.Defer;return 0===t?n.confirm(s.lang("TIPS_CONFIRM_DELETE_PACKAGE"),s.lang("PROMPT_MESSAGE"),void 0,e.bind(function(){i.resolve()}),e.bind(function(){i.reject()})):i.resolve(),i},_doCheck:function(e){var t=this,i=this.get("quantity");i!==t._getCurVal()&&(t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){var e=t._getCurVal();t._updateSum(e)},e||300))},_doCheckQuantity:function(t){var a=this.get("item"),o=this.get("index"),r=this.get("triggerEl"),n=a.data.amount,l=n.max,c=n.limit,d=n.now,u=n.demandQuality||0,p=n.supplyQuality||0,m=n.multiple||1,h=0;e.each(a.data.villagers,function(e,t){t!==o&&(h+=e.quantity)},this),t<=0&&(t=1),1===t?i.replaceClass(this.minusEl,"minus","no-minus"):i.replaceClass(this.minusEl,"no-minus","minus"),t+h>=l||t+h>=c?i.replaceClass(this.plusEl,"plus","no-plus"):i.replaceClass(this.plusEl,"no-plus","plus"),/^\d+$/.test(t+"")?0===l?(this._addError(s.lang("OUT_OF_STOCK")),t=0):t+h>l?(this._addError(s.lang("MAX_PURCHASE",{num:l})),t=l-h):d>l&&t>l?(this._addError(s.lang("MAX_PURCHASE",{num:l})),t=l):u>p?this._addError(s.lang("TIPS_LOW_STOCK_POPULAR",{num:p,num_people:u})):0!==t%m&&(this._addError(s.lang("MULTIPLE_PURCHASE",{num:m})),t=m):t=d;var f="",g="";return c<=l?f=s.lang("LIMIT_PURCHASE",{num:c}):l<=3&&(f=s.lang("STOCK_TENSE"),g=s.lang("TIPS_LOW_STOCK",{num:l})),f&&this._addError(f,g,"s-danger-text"),i.val(r,t),t},_updateSum:function(e){this.get("item");this.set("quantity",e)},_updateQuantity:function(e){var t=this.get("triggerEl");this._updateSum(e),i.val(t,e),Global.updateCart()},_addError:function(e,t,a){var o=this.get("item");t=t||"",a=a||"error-msg",this._removeError();var r=i.create('<em class="'+a+'"'+(t?' title="'+t+'"':"")+">"+e+"</em>");i.append(r,i.get(".vil-msg",o.itemEl))},_removeError:function(){var e=this.get("item"),t=i.query("em",i.get(".vil-msg",e.itemEl));i.remove(t)}},{ATTRS:{triggerEl:{value:"",getter:function(e){return l(e)}}}});return c},{requires:["node","dom","event","base","../quantity/effect","../../../utils/dialog/dialog","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/villager/villager",function(e,t,i,a,o,r,n){function s(t){e.mix(this,t),this._init()}var l=t.all,c=KISSY.unparam(location.search.slice(1))._login_daily_,d=c||-1!==location.host.indexOf(".daily."),u=d?"//cuntradeskip.daily.taobao.net":"//cuntradeskip.taobao.com";return e.augment(s,{_init:function(){var e=this,t=this.item;this._villagerItems=[],this._initUI(),l(".J_ItemVil",t.itemEl).each(function(i,a){var r=new o({item:t,index:a,id:t.data.villagers[a].villagerId,quantity:t.data.villagers[a].quantity,triggerEl:i});r.on("afterQuantityChange",e._update,e),e._villagerItems.push(r)}),this._validate()},_initUI:function(){var t=this,i=this.item.data.amount;this.timer=null;var a=0;e.each(this.item.data.villagers,function(e){a+=e.quantity}),(a>=i.max||a>=i.limit)&&this.item.itemEl.all(".btn-add-villager").addClass("btn-add-disabled"),this.item.itemEl.delegate("click",".btn-add-villager",e.bind(this._initDialog,this)),this.item.itemEl.delegate("mouseenter",".item-vil",function(e){e.stopPropagation(),t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){!Global.isScrolling&&l(e.currentTarget).addClass("item-vil-hover")},300)}).delegate("mouseleave",".item-vil",function(e){e.stopPropagation(),t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){l(e.currentTarget).removeClass("item-vil-hover")},300)})},_initDialog:function(){this.item.itemEl.all(".btn-add-villager").hasClass("btn-add-disabled")||(this.villagerDialog=new r({title:n.lang("VILLAGER_MGMT_CO_TITLE"),method:firstData.globalData.villagerSearchAction||"",callback:e.bind(this._dialogCallBack,this)}),this.villagerDialog.show(),this.villagerDialog.on("hide",function(){this.destroy()}))},_dialogCallBack:function(e){var t=this._getVillagerItem(e.villagerId);return t?void t.plus():(this._villagerItems.push(new o({item:this.item,index:this._villagerItems.length,id:e.villagerId,quantity:1,triggerEl:null})),void this._update())},_update:function(){var t=this,i={},o=0;return e.each(this._villagerItems,function(e){i[e.get("id")]=e.get("quantity"),o+=e.get("quantity")}),new a({dataType:"jsonp",url:u+"/shoppingorder/updateBuyNum",data:{cartId:this.item.data.cartId,shoppingOrderId:this.item.getAttr("ctCartId"),villagerBuyNum:JSON.stringify(i)}}).then(function(){o<=t.item.data.amount.limit&&o<=t.item.data.amount.max&&(t.item.data.amount.now=o),t._updateItem()})},_updateItem:function(e){var t=this,i=t.item;Global.request({updateUnselect:!i.isSelected(),operate:i,quantity:i.data.amount.now,orders:i.getOrder(),type:"update",silent:!0,success:function(e){},error:function(e){var i=e.message||e.error&&e.error.message;i&&t._addError(e.message)}})},_getVillagerItem:function(t){var i;return e.each(this._villagerItems,function(e){e.get("id")===t&&(i=e)}),i},_validate:function(){var t=0;return e.each(this._villagerItems,function(e){t+=e.get("quantity")}),t===this.item.data.amount.now||(this._addError(n.lang("VILLAGER_ASSOCIATION",{num:this.item.data.amount.now-t})),!1)},_addError:function(e,t,a){var o=this.item;t=t||"",a=a||"error-msg",this._removeError();var r=i.create('<em class="'+a+'"'+(t?' title="'+t+'"':"")+">"+e+"</em>");i.append(r,i.get(".vil-msg",o.itemEl))},_removeError:function(){var e=this.item,t=i.query("em",i.get(".vil-msg",e.itemEl));i.remove(t)}}),s},{requires:["node","dom","io","./villagerItem","ctr/ct-villager-mgmt/"+(firstData.globalData.ctVillagerComponentConfig&&firstData.globalData.ctVillagerComponentConfig.version||"0.0.6")+"/","../../../utils/i18n/i18n"]}),KISSY.add("cart/utils/pic-zoom/pic-zoom",function(e,t){function i(e,t,i){var a=t.offset(),o=i.offset(),r=a&&o?a.top-o.top:0,n=i.height(),s=t.outerHeight(),l=66;l=r>0?(n-r)/2-8:-r+n/2-8,l<0&&(l=0),l>s-16&&(l=s-16),e.css("top",l)}function a(){r&&clearTimeout(r),o&&(r=setTimeout(function(){o.hide&&o.hide()},200))}var o,r,n=t.all,s='<div class="item-big-pic cart-pic s240"><a href="{itemUrl}" target="_blank"><img src="{bigImgSrc}" class="J_MakePoint" /></a></div><span class="arrow"></span>';return{show:function(t,l,c){return r&&clearTimeout(r),o&&o.hide(),""!==l&&(r=setTimeout(function(){var d=e.substitute(s,{itemUrl:c,bigImgSrc:l.replace(/_(sum|\d{2,5}x\d{2,5})\.jpg$/,"")+"_240x240.jpg"}),u={offset:[10,53],node:t,points:["cr","cl"],overflow:{adjustY:1}},p=function(){if(o){var e=o.get("el"),a=n(".arrow",e);i(a,e,t)}};o?(o.set("content",d),o.set("align",u),o.show(),p()):e.use("overlay",function(e,t){o=new t({elCls:"small2big-popup",zIndex:13e3,align:u,content:d}),o.show(),p(),n(o.get("el")).attr("id","J_PicZoom").on("mouseenter",function(){r&&clearTimeout(r)}).on("mouseleave",a),e.log("[PicZoom] constructed.")})},300),!0)},hide:a}},{requires:["node"]}),KISSY.add("cart/mods/item/bigPic/bigPic",function(e,t,i){function a(t){var a=this;e.mix(a,t),o(a.itemEl).delegate("mouseenter",".J_ItemPic",function(e){i.show(a.triggerEl,a.imgUrl,a.itemUrl)}).delegate("mouseleave",".J_ItemPic",function(e){i.hide()})}var o=t.all;return e.augment(a,{destroy:function(){i.hide()}}),a},{requires:["node","../../../utils/pic-zoom/pic-zoom"]}),KISSY.add("cart/mods/item/goldReport",function(e,t){function i(e){return e<10?"0"+e:""+e}function a(t){var a=this;e.mix(a,t),o(a.itemEl).delegate("click",".J_GoldReport",function(e){var t=window.goldlog||{record:function(){}},o=new Date,r=o.getFullYear()+"-"+i(o.getMonth()+1)+"-"+i(o.getDate())+" "+i(o.getHours())+":"+i(o.getMinutes())+":"+i(o.getSeconds());t.record("/tbcart.8.item_click","CLK","clickTime="+r+"&clickUrl=https:"+a.itemUrl,"GET")})}var o=t.all;return a},{requires:["node"]}),KISSY.add("cart/utils/highlight/highlight",function(e,t){function i(e){this.targetEl=a(e),this.highlightEl=null}var a=t.all;return e.augment(i,{_setPosition:function(){var e=this.targetEl,t=e.offset();if(t)a(this.highlightEl).css({left:t.left,top:t.top,width:e.outerWidth(),height:e.hasClass("hidden")?0:e.height()});else{var i="target el offset not defined. || 14 || dom";Global.utils.logger("highlight","error",i)}},add:function(){this.highlightEl&&this.remove(),this.highlightEl=a('<div class="highlight"></div>'),this._setPosition(),this.highlightEl.appendTo(document.body)},remove:function(){this.highlightEl&&(a(this.highlightEl).remove(),delete this.highlightEl)}}),i},{requires:["node"]}),KISSY.add("cart/mods/item/del/del",function(e,t,i,a,o){return{del:function(t,r){var n=this;switch(r=e.merge({type:"del"},r||{}),e.trim(r.type)){case"fav":this._delItem(t,r);break;default:this._addHighlight(t.itemEl);var s=t.data.extInfo,l=1===parseInt(s.isPriorityBuy),c=o.lang("DELETE_ITEM"),d=o.lang("TIPS_CONFIRM_DELETE_ITEM"),u=t.data.isPreSell;if(l&&(d=s.yxgDelText,c=s.yxgDelTitle),u){var p=s.deleteTipsOfContentPreSell||"";d=s.deleteTipsOfTitlePreSell,c=s.deleteTipsOfHeadTitlePreSell,d=i.ie<8?d+"\n\n"+p:d+'<p style="color:#666;margin-top:5px">'+p+"</p>"}a.confirm(d,c,void 0,function(){n._delItem(t,r)},e.bind(this._removeHighLight,this))}},_addHighlight:function(e){this.highlight||(this.highlight=new t(e)),this.highlight.add()},_removeHighLight:function(){this.highlight&&(this.highlight.remove(),delete this.highlight)},_delItem:function(e,t){var i=this;Global.request({type:"delete",operate:e,orders:e.getOrder(),success:function(a){a.success&&(t.success&&t.success(),i._removeHighLight(),e.remove())},error:t.error||function(){i._removeHighLight()}})}}},{requires:["../../../utils/highlight/highlight","ua","../../../utils/dialog/dialog","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/fav/fav",function(e,t,i,a,o,r,n,s,l){function c(t){
e.mix(this,t),this._init()}var d=t.all;return e.augment(c,{_init:function(){this.isFromUndo?this._doFav(this.item):this._bindEvents()},_bindEvents:function(){var e=this;d(e.item.itemEl).delegate("click",".J_Fav",function(t){t.preventDefault(),"pad"===Global.cfg.client&&t.stopPropagation(),e._doFav(e.item),Global.utils.makepoint("8.7")})},_doFav:function(e){var t=this,i=e.data.extInfo;i.yxgAddFavorText?r.confirm(i.yxgAddFavorText,i.yxgAddFavorTitle,void 0,function(){t._sendFavRequest(e)}):t._sendFavRequest(e)},_sendFavRequest:function(t){var a=this,r=[],n=e.isArray(t)?t:[t],c=l.now();e.each(n,function(e){r.push(e.data.itemId+":"+e.data.skuId)}),o({type:"get",url:Global.cfg.api.favorite,data:{itemSkuList:r.join(","),_tb_token_:i.val("#_tb_token_")},dataType:"jsonp",success:function(t){if(e.isPlainObject(t)){var i=t.result,o="pad"===Global.cfg.client,r=o?null:a._generateTip(n[0],i);i.status?(a._delItem(n[0],function(){o&&alert(s.lang("TIPS_SUCCESS_FAV")),a._removeTip(r)}),l.retSuccess(Global.cfg.api.favorite,l.now()-c)):(o&&i.message&&alert(i.message.error),a._removeTip(r),l.retError(Global.cfg.api.favorite,l.now()-c,"response data exception"))}else try{l.retError(Global.cfg.api.favorite,l.now()-c,"response data is not a plain object")}catch(d){}},error:function(e,t,i){l.retError(Global.cfg.api.favorite,l.now()-c,i)}})},_generateTip:function(e,t){var a=e.itemEl,o=t.status,r=t.message,n=a.offset(),l=a.width(),c=i.create('<div id="fav-lay-prefix-'+e.cartId+'" class="fav-box"></div>'),d="";return d=o?i.create('<div class="msg fav-status"><p class="ok">'+s.lang("TIPS_SUCCESS_FAV")+"</p></div>"):8===r.errorCode?i.create('<div class="msg fav-status"><p class="attention">'+r.error+"</p></div>"):i.create('<div class="msg fav-status"><p class="error">'+r.error+"</p></div>"),i.append(d,c),i.append(c,document.body),n&&i.css(c,{top:n.top+11,left:n.left+l-i.width(d)}),c},_removeTip:function(t){t&&e.later(function(){i.remove(t)},500)},_delItem:function(e,t){n.del(e,{type:"fav",success:t,error:t})}}),c},{requires:["node","dom","event","ajax","../../../utils/dialog/dialog","../del/del","../../../utils/i18n/i18n","../../global/retcode"]}),KISSY.add("cart/utils/tip/tip",function(e,t,i){function a(){s&&s.destroy(),s=null}function o(){n&&clearTimeout(n)}function r(){n&&clearTimeout(n),n=setTimeout(a,300)}var n,s,l,c=t.all,d=!1;return{init:function(){d===!1&&c(document).delegate("mouseenter",".cart-tips",o).delegate("mouseleave",".cart-tips",r)},show:function(t,a,n){return!!t&&(e.isFunction(a)&&(n=a,a={}),d===!1&&this.init(),this.hide(),e.use("overlay",function(e,d){a.elCls="cart-tips "+(a.elCls||""),a.content=i(t)+'<span class="arrow"></span>',s=new d.Popup(a),s.show(),a.contentWidth&&c(s.get("contentEl")).width(a.contentWidth),l=a.align&&a.align.node?c(a.align.node):null,a.noEvent!==!0&&l.on("mouseenter",o).on("mouseleave",r),n&&n(s)}),!0)},hide:function(){n&&clearTimeout(n),a(),l&&l.detach("mouseleave",r).detach("mouseenter",o)}}},{requires:["node","../tpl/render"]}),KISSY.add("cart/mods/item/promoTip/promo",function(e,t,i,a,o,r){function n(e){var t=e/1e3/60;return t>60?parseInt(t/60,10)+"\u5c0f\u65f6":parseInt(t,10)+"\u5206\u949f"}function s(t){var s=this;e.mix(s,t),s.timer=null,s.tip=null,s.animTimer=null;var u=s.item;u.itemEl.delegate("mouseenter click",".J_ItemPromotions",function(t){"click"===t.type&&t.preventDefault(),t.stopPropagation(),s.timer&&clearTimeout(s.timer),s.timer=setTimeout(function(){var p,m,h=l(t.currentTarget).addClass(c),f=u.data.promotions,g=f.title.split(":");try{p=u.data.price.currency.symbol}catch(_){p="\uffe5"}try{m=u.data.price.currency.unitFactor}catch(_){m=100}if(f.desc=f.desc||(g.length>1?e.trim(g[1]):g[0]),f.endTime){var v=+new Date,I=f.endTime-v;I>0&&(f.endStr=n(I))}f.savedStr=Global.utils.toMoney(f.saved,m);var T="";if(f.diff||1===f.activityType){if(f.diff){var S={currency:p,num:Global.utils.toMoney(f.diff,m)};T=1===f.activityType?r.lang("TIP_AFTER_CART_DISCOUNT_FREE_SHIPPING",S):r.lang("TIP_AFTER_CART_DISCOUNT",S)}else 1===f.activityType&&(T=r.lang("TIP_AFTER_CART_FREE_SHIPPING"));f.except&&(T+=r.lang("TIP_AFTER_CART_EXCLUDE",{text:f.except}))}f.compareStr=T,f.currency=p;var b=o(a(d),f);if(b){var E=l("<div>"+b+"</div>").appendTo("body").css({position:"absolute",top:-9999,left:-9999}),C=E.width();E.remove(),C<100?C=100:C>200&&(C=200),s.animTimer&&s.animTimer.stop(),i.show(b,{elCls:"promo-detail-tips",align:{node:h,points:["bl","tl"]},contentWidth:C,noEvent:!0},function(e){s.tip=e;var t=l(e.get("el")),i=t.height();t.height(0),animTimer=t.animate({height:i},{duration:.2,easing:"backOut"})})}},300)}).delegate("mouseleave",".J_ItemPromotions",function(e){e.stopPropagation(),s.timer&&clearTimeout(s.timer),s.animTimer&&s.animTimer.stop(),s.timer=setTimeout(function(){if(l(e.currentTarget).removeClass(c),s.tip){var t=l(s.tip.get("el"));s.animTimer=t.animate({height:0},{duration:.1,easing:"backIn",complete:function(){i.hide(),t.remove(),s.tip&&s.tip.destroy()}})}s.tip=null},300)})}var l=t.all,c="promo-hover",d='{{#if endStr}}<div class="promo-end-time">\u5269\u4f59\uff1a{{endStr}}</div>{{/if}}<div class="promo-d-line">{{name}}\uff1a{{desc}}</div>{{#if usedPoint > 0}}<div class="promo-d-line">\u53ef\u7528{{usedPoint}}\u5929\u732b\u79ef\u5206\u83b7\u5f97\u4f18\u60e0</div>{{/if}}{{#if saved}}<div class="promo-d-line">'+r.lang("TPL_GET_MONEY_OFF")+'</div>{{/if}}{{#if compareStr}}<div class="promo-d-line promo-diff">{{compareStr}}</div>{{/if}}{{#if specialContent}}<div class="promo-d-line promo-diff">{{specialContent}}</div>{{/if}}';return s},{requires:["node","../../../utils/tip/tip","gallery/template/1.0/","../../../utils/tpl/render","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/promoTip/ask-for-promo",function(e,t,i,a){function o(e){var t=e.item;t.itemEl.delegate("click",".J_AskPromotion",function(e){e.halt();var i=r(e.currentTarget);t.data.askPromo.asked===!0?a.show("\u60a8\u5df2\u5411\u5356\u5bb6\u6c42\u4f18\u60e0\uff0c<br />\u8bf7\u7b49\u5f85\u5356\u5bb6\u53cd\u9988\uff01",{elCls:"promo-detail-tips",align:{node:i,points:["bl","tl"],offset:[0,7]}}):Global.request({type:"findPromotion",operate:t,orders:t.getOrder()})})}var r=t.all;return o},{requires:["node","ajax","../../../utils/tip/tip"]}),KISSY.add("cart/utils/sku/sku",function(e,t,i,a,o,r,n,s){function l(t){e.mix(this,t),this._init()}SALE_NOT_FOUND=n.lang("TIPS_ITEM_NOT_FOUND");var c='{{#each prop as curProp curPropId}}<dl class="prop clearfix J_Prop"><dt>{{curProp.name}}</dt><dd><ul class="clearfix">{{#each curProp.value as curPropValue}}<li data-prop="{{curProp.name}}" data-pvid="{{curPropValue.pvid}}" class="prop-block J_PropBlock {{#if curPropValue.pic}} img-mode {{/if}}" title="{{curPropValue.name}}"><a href="javascript: void(0)" {{#if curPropValue.pic}}style="background:url({{curPropValue.pic}}) 50% 50% no-repeat;"{{/if}}><span>{{curPropValue.name}}</span></a><i></i></li>{{/each}}</ul></dd></dl>{{/each}}',d='<div class="msg hidden-msg"><p class="error J_ErrorInfo"></p></div>',u='{{#if hasAmount !== false}}<dl class="amount clearfix"><dt>'+n.lang("TPL_QUANTITY_WIDE")+'</dt><dd class="clearfix"><div class="amount-wp"><a href="#" class="J_Minus no-minus">-</a><input type="text" value="{{quantity}}" class="J_Amount amount-input" /><a href="#" class="plus J_Plus">+</a></div><span class="unit">'+n.lang("ITEM_UNITS_UNCONFIRMED")+'</span><span class="stock">\uff08{{#if stock > 1}}'+n.lang("TPL_STOCKS_LEFT")+"{{#else}}"+n.lang("TPL_STOCK_LEFT")+"{{/if}}\uff09</span>"+d+"</dd></dl>{{#else}}"+d+'{{/if}}<p class="operate"><a href="javascript:void(0);" class="add-cart J_AddCart {{#if hasSku}}btn-disabled{{/if}}"><span>'+n.lang("CONFIRM")+'</span></a><a href="javascript:void(0);" class="cancel J_Cancel">'+n.lang("CANCEL")+"</a></p>";return e.augment(l,{_init:function(){var t=this;e.mix(t,i.Target),e.mix(t,{hasSku:!0,skuData:null,skuInfo:{prop:{},pvids:null},propAmount:0},!1),t._request(),t.on("rendered",function(){t.renderfired&&t.renderfired();var e=t.container;t.hasAmount!==!1&&(t.minusBtn=e.one(".J_Minus"),t.plusBtn=e.one(".J_Plus"),t.quantityInput=e.one(".J_Amount")),t.errorBox=t.errorBox||e.one(".J_ErrorInfo"),t.hasSku&&t._initSkuSelect(),t.hasAmount!==!1&&t._initQuantity(),!t.hasSku&&t.defaultAmount?t[(t.addToCart?"":"_")+"addToCart"]({item_id:t.itemId,outer_id:0,outer_id_type:1,quantity:parseInt(t.defaultAmount,10)}):(t._initBtnAddCart(),t._initBtnCancel()),t.rendered&&t.rendered()})},_initMask:function(){var i=this,a=i.rowBox.one(".J_Mask");a||(a=t.create('<div class="J_Mask mask"><i></i></div>'),i.container.parent().prepend(a)),i.mask=e.one(a)},_convertProp:function(t){var i=this,a={};return e.each(t,function(t,o){e.each(t,function(e,t){var r=t.split(":"),n=r[0],s=r[1];a[n]||(a[n]={id:n,name:o,value:[]}),a[n].value.push({pvid:n+":"+s,id:s,name:i._encodeHTML(e[0]),pic:e[1]})})}),a},_encodeHTML:function(e){return String(e).replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_getPropValueIds:function(t){var i=[],a=[];return e.each(t,function(t,o){i.push(o),e.each(t.value,function(e){a.push(e.id)})}),{props:i,values:a}},_i18n:function(t){var i=this;if("en"===n.langConfig){var a=i._getPropValueIds(i.skuData.prop),r=s.now();o({url:Global.cfg.api.propTrans||"json/prop_trans.do",dataType:"json",data:{propID:a.props.join(":"),valueID:a.values.join(":")},method:"post",success:function(a){var o=i.skuData.prop;e.each(o,function(t,i){a.props[i]&&(t.name=a.props[i]),e.each(t.value,function(e){var t=a.values[e.id];t&&(e.name=t)})}),t(),s.retSuccess(Global.cfg.api.propTrans||"json/prop_trans.do",s.now()-r)},error:function(e,i,a){t(),s.retError(Global.cfg.api.propTrans||"json/prop_trans.do",s.now()-r,a)}})}else t()},_request:function(){var t=this,i=s.now();o({url:Global.cfg.api.sku,dataType:"jsonp",data:{item_num_id:t.itemId},jsonpCallback:"jsonpGetSkuInfo"+e.guid(),success:function(a){e.isPlainObject(a)&&a.success?(t.skuData=a,t.hasSku=!!a.prop,!t.hasSku&&t.defaultAmount?t.fire("rendered"):(t.skuData.prop=t._convertProp(t.skuData.prop),t._i18n(function(){t._render()})),s.retSuccess(Global.cfg.api.sku,s.now()-i)):(r.alert(n.lang("TIPS_ERROR_GET_ITEM_INFO")),t.error&&t.error(),s.retError(Global.cfg.api.sku,s.now()-i,JSON.stringify(a)))},error:function(e,a,o){r.alert(n.lang("TIPS_ERROR_GET_ITEM_INFO")),t.error&&t.error(),s.retError(Global.cfg.api.sku,s.now()-i,o)},charset:"gbk"})},_render:function(){var e=this,t=e.skuData,i="",o=a(u).render({hasSku:e.hasSku,stock:t.item.stock,hasAmount:e.hasAmount,quantity:e.quantity||1});e.defStock=t.item.stock,e.hasSku&&(t.curSku=e.curSku,i=a(c).render(t)),e.container.html('<div class="sku-props-selector clearfix">'+i+o+"</div>"),e.fire("rendered")},_findSkuProp:function(){var t=this,i="";return e.each(t.skuData.skuMap,function(e,a){if(e.skuId===t.skuId)return i=a,!1}),i},_initSkuSelect:function(){var t=this;e.use("tbc/sku/1.0.6/",function(e,i){var a=new i({root:t.container,hook:".J_PropBlock",skuMap:t.skuData.skuMap,attrName:"data-pvid",selectedClass:"selected",disabledClass:"disabled"});a.on("skuFound skuChanged",function(e){t.selectedSku=e.sku,t.hasAmount!==!1?(t._updateStock(),t._validateQuantity()):t._hideErrorInfo(),t.btnAddCart.removeClass("btn-disabled")}),a.on("selectionChanged",function(e){t.skuChanged&&t.skuChanged(e.sku)}),a.on("skuLost",function(){t.selectedSku=null,t.btnAddCart.addClass("btn-disabled")}),a.init();var o=t._findSkuProp();o&&a.setCurrentSku({pvs:o})})},_updateStock:function(){var e=this,t=e.container.one(".J_Stock"),i=e.selectedSku?e.selectedSku.stock:t.attr("data-defstock");t.html(i)},_initQuantity:function(){var e=this;e.quantityInput.on("keyup",function(){e._validateQuantity()}),i.delegate(e.container,"click",".J_Plus",function(t){t.preventDefault();var i=parseInt(e.quantityInput.val(),10);e.quantityInput.val(i+1),i>0&&e.minusBtn.replaceClass("no-minus","minus"),e._validateQuantity()}),i.delegate(e.container,"click",".J_Minus",function(t){if(t.preventDefault(),e.minusBtn.hasClass("no-minus"))return!1;var i=parseInt(e.quantityInput.val(),10);return i>1&&e.quantityInput.val(--i),i<2&&e.minusBtn.replaceClass("minus","no-minus"),e._validateQuantity(),!0})},_validateQuantity:function(){var e=this,t=/^\d+$/,i=e.quantityInput,a=parseInt(i.val(),10);if(e._hideErrorInfo(),!t.test(i.val()))return i.val(""),e._showErrorInfo(n.lang("TIPS_AMOUNT_ERROR"));var o=e._getCurrentStock();if(!o)return e._showErrorInfo(n.lang("TIPS_NO_STOCK"));if(a>o)return e._showErrorInfo(n.lang("MAX_PURCHASE",{num:o}));if(e.checkQuantity){var r=e.checkQuantity(a);if(r)return e._showErrorInfo(r)}return!0},_showErrorInfo:function(t){return this.errorBox&&this.errorBox.html(t).parent().show(),this.autoHideError&&(this._errorTime&&clearTimeout(this._errorTime),this._errorTime=setTimeout(e.bind(this._hideErrorInfo,this),1e3*this.autoHideError)),!1},_hideErrorInfo:function(){this.errorBox&&this.errorBox.html("").parent().hide()},_getCurrentStock:function(){var e=this.container.one(".J_Stock");return parseInt(e.text(),10)},_initBtnAddCart:function(){var e=this,t=e.hasSku,i=e.container,a=e.itemId;e.btnAddCart=i.one(".J_AddCart"),e.btnAddCart.on("click",function(i){return i.preventDefault(),t&&!e.selectedSku?(e._showErrorInfo(n.lang("TIPS_SELECT_ITEM_PROP")),!1):e.hasAmount===!1||e._validateQuantity()?(e[(e.addToCart?"":"_")+"addToCart"]({item_id:a,outer_id:t?e.selectedSku.skuId:0,outer_id_type:t?2:1,quantity:e.hasAmount!==!1?e.quantityInput.val():e.quantity}),!0):(e._showErrorInfo(n.lang("TIPS_AMOUNT_ERROR")),!1)})},_addToCart:function(t){var i=this;t.t=e.now(),"freegift"===i.itemType&&(t.rw="zp"),e.io({type:"POST",url:i.rowBox.one(".J_Redemption").attr("data-cart-url"),dataType:"json",data:t,success:function(t){e.isPlainObject(t)&&(t.status||i._showErrorInfo(t.error||n.lang("TIPS_ERROR_SYSTEM_FAILED")))}})},_initBtnCancel:function(){var e=this,t=e.container;t.one(".J_Cancel").on("click",function(t){t.preventDefault(),e.cancel()})},destroy:function(){this.container.empty()}}),l},{requires:["dom","event","gallery/template/1.0/","ajax","../dialog/dialog","../i18n/i18n","../../mods/global/retcode"]}),KISSY.add("cart/utils/width-fix/auto-width",function(e,t){function i(e){if(e.minWidth&&e.el&&e.heightThreshold){e.distance=(e.maxWidth-e.minWidth)/(parseInt(e.tryTimes,10)||10),e.clone?this.$el=a(e.el).clone(!0).appendTo("body").css({position:"absolute",top:-9999,left:-9999}):this.$el=a(e.el),this.$el.width(e.minWidth),this.cfg=e;var t=this._fix();return e.clone&&this.$el.remove(),t}}var a=t.all;return e.augment(i,{_fix:function(){var e=this.$el,t=this.cfg,i=e.height(),a=e.width();return a>=t.maxWidth?(e.width(t.maxWidth),[t.maxWidth,e.height()]):i<=t.heightThreshold?[a,i]:i>t.heightThreshold?(e.width(a+t.distance),this._fix()):void 0}}),i},{requires:["node"]}),KISSY.add("cart/mods/item/sku/sku-edit",function(e,t,i,a,o,r){function n(t){e.mix(this,t),this._init()}var s=t.all,l="item-props-can-hover";return e.augment(n,{_init:function(){var t=this;switch(this.skuStatus){case 1:this.triggerEl=s(".J_AddSkuBtn",this.item.itemEl),this.item.itemEl.delegate("click",".J_AddSkuBtn",e.bind(this._initSku,this));break;case 2:this.timer=null,this.triggerEl=s(".item-props",this.item.itemEl),this.item.itemEl.delegate("click",".J_BtnEditSKU",e.bind(this._initSku,this)),this.item.itemEl.delegate("mouseenter",".item-props-can",function(e){e.stopPropagation(),t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){!Global.isScrolling&&s(e.currentTarget).addClass(l)},300)}).delegate("mouseleave",".item-props-can",function(e){e.stopPropagation(),t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){!t.sku&&s(e.currentTarget).removeClass(l)},300)})}},destroy:function(){var e=this;e.sku.destroy(),e.sku=null,e.container.remove(),2===e.skuStatus&&e.triggerEl.removeClass(l),s(document).detach("click",e._removeEdit,e)},_removeEdit:function(e){var t=s(e.target),i=t.parent(".J_SkuEdit");if(i&&i.length&&i.attr("id")==="J_SkuEdit_"+this.item.data.cartId)return!1;var a=t.parent(".item-props"),o=t.parent(".J_ItemBody");return!((t.hasClass(".item-props")||a&&a.length)&&o&&o.length&&o.attr("id")==="J_Item_"+this.item.data.cartId)&&(this.destroy(),!0)},_updateSku:function(e){var t=this;t.item.data.skuId=e.outer_id,Global.request({type:"updateItemSku",operate:t.item,quantity:e.quantity,orders:t.item.getOrder(),skuid:e.outer_id,success:function(e){e&&e.success===!0&&t&&t.destroy&&t.destroy(),0===e.list.length&&t.item.remove()}})},_getItemSku:function(){if(this.item&&this.item.data&&this.item.data.skus){var e=s("<div></div>").html(a.stringify(this.item.data.skus)),t=e.html();return e.remove(),a.parse(t)}return{}},_initSku:function(t,i){var a=this;a.container=s("#J_SkuEdit_"+a.item.data.cartId),a.container&&0!==a.container.length||(a.container=s('<div id="J_SkuEdit_'+a.item.data.cartId+'" class="J_SkuEdit sku-edit-popup" style="display: none;"><div class="sku-edit-content"></div><div class="sku-item-pic J_SkuItemPic"><div class="cart-pic s160"><a href="'+a.item.data.url+'" target="_blank"><img src="'+a.item.data.pic+'_160x160.jpg"></a></div></div><span class="arrow"></span></div>').appendTo("body")),2===a.skuStatus&&a.triggerEl.addClass(l),a.sku||(a.sku=new o({container:s(".sku-edit-content",a.container),itemId:a.item.data.itemId,skuId:a.item.data.skuId,hasAmount:!1,quantity:a.item.data.amount.now,curSku:a._getItemSku(),cancel:function(){i&&e.isFunction(i)&&i(),a.destroy.call(a)},rendered:function(){var e=this.container.parent(),t=20;2===a.skuStatus&&s(a.triggerEl).all(".sku-line").each(function(e){t+=e.height()});var i=s(a.triggerEl).offset(),o={display:"block"};if(i)if(2===a.skuStatus)o.top=t+i.top,o.left=i.left;else{o.top=25+i.top;var r=s(a.triggerEl).parent(".item-props");if(r){var n=r.offset();o.left=n?n.left:0}}e.css(o);var l=0;if(s(".J_PropBlock",this.container).each(function(e){var t=e.outerWidth();t>l&&(l=t)}),l>e.width()-87&&e.width(87+l),s(".J_SkuItemPic",e).height(e.height()||180),s(document).on("click",a._removeEdit,a),!o.top||!o.left){var c="trigger el offset not defined. || 140 || dom";Global.utils.logger("sku-edit","error",c)}},addToCart:function(i){t&&e.isFunction(t)&&t(i),a._updateSku.call(a,i)},skuChanged:function(t){var i=this.container.parent(),o=this.skuData.item.picUrl||a.item.data.pic;if(t.props){var r=this.skuData.prop;e.each(t.props,function(e){if(e){var t=s(e),i=t.attr("data-prop"),a=t.attr("data-pvid");if(r[i]&&r[i][a]&&2===r[i][a].length)return o=Global.utils.removePicSuffix(r[i][a][1]),!1}})}i.all(".J_SkuItemPic").all("img").attr("src",o+"_160x160.jpg")},error:e.bind(a.destroy,a)}))}}),n},{requires:["node","ua","json","../../../utils/sku/sku","../../../utils/width-fix/auto-width"]}),KISSY.add("cart/mods/cart/undo/fake-order",function(e){function t(e){this.uniqueId=e.orderId,this.comboId=e.comboId,this.shopId=e.shopId,this.shopActId=e.shopActId,this.data={page:e.page},this.items={}}return e.augment(t,{getItems:function(){var t=[];return e.each(this.items,function(e){t.push(e)}),t}}),t}),KISSY.add("cart/mods/cart/undo/undo",function(e,t,i,a,o,r,n){function s(){p&&clearTimeout(p),m("#J_UndoTips").remove();var e=u.parent().one(".J_ItemBody")||m("#J_OrderList").one(".J_ItemBody")||m("#J_Cart"),t=e.offset()||{top:250,left:0},i=m(v).appendTo("body").css("top",t.top+30);p=setTimeout(function(){i.fadeOut(.3,function(){i.remove()})},4e3)}function l(t){var i={},a={},o=[];e.each(f,function(e,t){if(e){var n=e.getOrder();n||(a[e.orderId]||(a[e.orderId]=new r(e)),n=a[e.orderId],n.items[e.cartId]=e),i[n.uniqueId]=n,o.push(e)}});var n=[];e.each(i,function(e){n.push(e)}),Global.request({type:"undelete",orders:n,operate:o,success:function(e){s(),t&&t(e)},error:function(){}})}function c(){var t,i=!1,a=null;if(e.each(f,function(e,i){if(e){var o=m("#J_Order_"+e.orderId);a=a||(o.length?o:null),t=t||e.orderId,o.length&&a&&o.offset().top<a.offset().top&&(a=o)}}),a){e.log(h+"insert after order title.");var o=a.parent(".J_GroupHolder");o&&o.length?u.insertBefore(o):u.insertBefore(a.parent()),i=!0}if(i===!1){if(t){e.log(h+"insert after first order.");var r=m("#J_OrderHolder_"+t);if(r&&r.length){var n=r.parent(".J_Group");return n&&n.length?u.insertBefore(n):u.insertBefore(r),!0}}e.log(h+"insert before any order."),u.prependTo("#J_OrderList")}return!0}var d,u,p,m=t.all,h="[undo] ",f={},g=[],_='<div id="J_Undo" class="undo-wrapper"><div class="undo-msg J_UndoMaxMsg"><p>'+n.lang("TIPS_UNDO")+"</p></div></div>",v='<div id="J_UndoTips" class="undo-tips"><div class="msg"><p class="naked ok">'+n.lang("TIPS_UNDO_SUCCESS")+"</p></div></div>";return{record:function(t){g=[],f={},e.each(e.makeArray(t),function(t){t&&t.isRedemption!==!0&&!e.inArray(t.cartId,g)&&(g.push(t.cartId),f[t.cartId]=t)})},render:function(){var t=this;return 0===g.length?(e.log(h+"no items deleted. Undo will not be rendered."),!1):(d&&clearTimeout(d),d=setTimeout(function(){u&&u.remove(),u=m(e.substitute(_,{num:g.length,unit:g.length>1?n.lang("ITEM_PLURAL"):""})),c(),u.delegate("click",".J_UndoDel",function(e){e.preventDefault(),l(t.clear)}),e.log(h+"rendered.")},300),!0)},clear:function(){g=[],f={},u&&u.remove()}}},{requires:["node","ajax","json","../../../utils/dialog/dialog","./fake-order","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/item/icons/icons",function(e,t){function i(e){var t,i=e.item,o="item-icons-collapse",r="item-icons-expand";i.itemEl.delegate("mouseenter mouseleave",".J_ItemIcons",function(e){var i=a(e.currentTarget);if(t&&clearTimeout(t),!i.hasClass("item-icons-fixed"))switch(e.type){case"mouseenter":t=setTimeout(function(){i.hasClass(o)&&i.removeClass(o).addClass(r)},150);break;case"mouseleave":t=setTimeout(function(){i.removeClass(r).addClass(o)},300)}})}var a=t.all;return i},{requires:["node"]}),KISSY.add("cart/mods/item/lottery/lottery-map",function(e){var t="\u6316\u5230\u5b9d\u5566\uff01\u73b0\u5728\u8d2d\u4e70\uff0c\u53ef",i='\uff0c<a href="//service.taobao.com/support/knowledge-5686796.htm" target="_blank">\u67e5\u770b\u8be6\u60c5</a>';return{tjb:{words:t+"\u5f97500\u6dd8\u91d1\u5e01"+i},hb:{words:t+"\u5f9710\u5143\u652f\u4ed8\u5b9d\u7ea2\u5305"+i},mh:{words:t+"\u9886\u53d6\u539f\u4ef7399\u5143\u7684\u5929\u732b\u9b54\u76d2"+i}}}),KISSY.add("cart/mods/item/lottery/lottery",function(e,t,i,a){function o(e){var t=r(".J_ItemLottery",e.itemEl).html("");if(e.lottery&&i[e.lottery])var o=r(n(e.lottery)).appendTo(t).on("mouseenter",function(){a.show(i[e.lottery].words,{elCls:"lottery-tips",align:{node:o,points:["bl","tl"],offset:[0,10]}})})}var r=t.all,n=function(e){return'<span class="item-lottery item-lottery-'+e+'"></span>'};return e.augment(o,{destroy:function(){}}),o},{requires:["node","./lottery-map","../../../utils/tip/tip"]}),KISSY.add("cart/mods/item/pk/pk",function(e,t,i,a){var o="\u5df2\u52a0\u5165\u5bf9\u6bd4",r="\u8be5\u5b9d\u8d1d\u5df2\u5b58\u5728",n="PETREL_DATA_EXIST";return{add:function(e,i){var a=this;if(t.attr(i,"title")==o)return void a._generateTip(e.itemEl,r);if(Global.toolbar&&Global.toolbar.getItemHdEl("pk")){var s=e.data,l={cartId:s.cartId,itemId:s.itemId,skuId:s.skuId?s.skuId:0,from:1,anim:!0,trigger:i,pic:s.pic,callback:function(t){t.success?a._disableTrigger(i):t.error?(t.error.errorCode==n&&a._disableTrigger(i),a._generateTip(e.itemEl,t.error.errorMessage)):a._generateTip(e.itemEl)}};Global.toolbar.message("pk",{type:"addToPK",cfg:l})}else a._generateTip(e.itemEl)},_disableTrigger:function(e){t.text(e,"\u5df2\u52a0\u5165\u5bf9\u6bd4"),t.attr(e,{title:o}),t.css(e,{color:"#999999",cursor:"text","text-decoration":"none"})},_generateTip:function(e,i){var a=e.offset(),o=e.width(),r=t.create('<div class="fav-box"></div>');i=i?i:"\u7cfb\u7edf\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5";var n=t.create('<div class="msg pk-status"><p class="error">'+i+"</p></div>");t.append(n,r),t.append(r,document.body),a&&t.css(r,{top:a.top+11,left:a.left+o-t.width(n)}),setTimeout(function(){t.remove(r)},3e3)}}},{requires:["dom","io","event"]}),KISSY.add("cart/utils/20141212/hongbao-label",function(e,t){function i(e,t){t.append('<i class="'+r+"coupon-number "+r+'coupon-number-s"></i>');for(var i=0,a=e.length;i<a;i++)t.append('<i class="'+r+"coupon-number "+r+"coupon-number-"+e[i]+'"></i>')}function a(t){t[l]&&3===t[l].length||(t[l]=s),t[c]||(t[c]=n);for(var a=o(t[c],t.container),d=0,u=a.length;d<u;d++){var p=o(a[d]),m=p.attr("data-type"),h="",f=[r+"common"],g=0,_=!1;if(p.attr("data-render-finish")&&"done"===p.attr("data-render-finish")&&(t.repeatRender?t.debug&&e.log(t.debugPrefix+"\u6807\u7b7e\u91cd\u65b0\u6e32\u67d3\uff1a",p):(t.debug&&e.log(t.debugPrefix+"\u6807\u7b7e\u5df2\u88ab\u6e32\u67d3\u8fc7\uff0c\u8df3\u8fc7\u91cd\u65b0\u6e32\u67d3\uff1a",p),_=!0)),!_)switch(m){case"label":h=t[l][0],f.push(r+"pc"),f.push(r+"normal");break;case"mini-label":h=t[l][0],f.push(r+"pc"),f.push(r+"mini");break;case"coupon":h=t[l][1],f.push(r+"pc"),f.push(r+"coupon");var v=parseInt(p.attr("data-value"),10)/100;isNaN(v)?_=!0:g=v.toString().split("");break;case"presale":h=t[l][2],f.push(r+"pc"),f.push(r+"presale-normal");break;case"mini-presale":h=t[l][2],f.push(r+"pc"),f.push(r+"presale-short")}if(!_){if(p.attr("data-render-finish","done"),g&&(h+="\uff1a\u62b5"+v+"\u5143"),p.attr("title",h),p.text(h),g)switch(g.length){case 1:i(g,p),f.push(r+"coupon-short"),p.append('<i class="'+r+'coupon-end"></i>');break;case 2:i(g,p),f.push(r+"coupon-normal"),p.append('<i class="'+r+'coupon-end"></i>');break;case 3:i(g,p),f.push(r+"coupon-long")}p.addClass(f.join(" "))}}}var o=t.all,r="tbc-hongbao-label-",n=".tbc-double-12-label",s=["1212\u4e07\u80fd\u76db\u5178","1212\u8d2d\u7269\u5238","1212\u9884\u552e"],l="label-title",c="label-class",d=function(t){var i={},o="[\u7ea2\u5305\u6807\u7b7e\u63d2\u4ef6] ";return t&&(i=t,t.debug&&e.log(o+"\u6253\u6807\u7ec4\u4ef6\u5f53\u524d\u914d\u7f6e\uff1a",t)),i.debugPrefix=o,a(i),!0};return{init:d}},{requires:["node"]}),KISSY.add("cart/mods/item/baseItem",function(e,t,i,a,o,r,n,s,l,c,d,u,p,m,h,f,g,_,v,I,T,S,b,E,C){function y(t){e.mix(this,t),this._init()}var P=t.all,A="[BaseItem] ";return e.augment(y,{_init:function(){this.data.model=this.data.model||{},this.mods=this.mods||{},this._render(),this.componentsConfig=[],this.componentsConfig.push({id:"findSimilar",pack:"kg/tp-find-similar",verstion:"0.0.6",precondition:function(){return!0}}),C(this.componentsConfig),this.findSimilarComponent=E("findSimilar"),this.isValid?Global.lazyload(this.itemHolderEl,function(){this._initQuantity(),this._initCheckbox(),Global.cfg.isCuntaoPartner&&!this.isPreSell&&this._initVillager()},this):("ju11"!==this.data.type&&"presell"!==this.data.type&&Global.broadcast("G_ShowClearInvalid",{}),this.isSelected(!1)),Global.lazyload(this.itemPicEl),Global.lazyload(this.itemHolderEl,function(){this._initBigPic(),this._initItemDel(),this._initFindSimilar(),this._initItemFav(),this._initOpArea(),this._initSkuEdit(),this.isValid&&this._initPromoTip(),this._initLottery(),this._initCouponPromo(),this._initGoldReport()},this),Global[(this.isValid&&this.isSelected()?"add":"remove")+"SelectedItems"](this)},_initCountDown:function(e){var t=e,i=P(".J_Countdown",this.itemEl),a=this,o="";if(!(e>0))return this.data.promotion_end=!0,P(".J_Countdown_parent",this.itemEl).html("\u4f18\u60e0\u6d3b\u52a8\u5df2\u7ed3\u675f"),P(".limitPromo",this.itemEl).addClass("promo-end"),void clearTimeout(this.timer);var r=Math.floor(e/36e5);e-=36e5*r;var n=Math.floor(e/6e4);e-=6e4*n;var s=Math.floor(e/1e3);o=(r<10?"0"+r:r)+":"+(n<10?"0"+n:n)+":"+(s<10?"0"+s:s),o&&i&&i.html(o),this.timer=setTimeout(function(){a._initCountDown(t-1e3)},1e3)},_render:function(){if(this.data.cartsPromos){this.data.promotion_end=!0;var e=this.data.cartsPromos.expiredTime||0,t=Global.globalData.currentTime||(new Date).getTime(),i=e-t-1e4;0<i<864e5&&(this.data.promotion_end=!1,this._initCountDown(i))}this.itemHolderEl=r.render(this.data),this.itemEl=P("#J_Item_"+this.cartId,this.itemHolderEl),this.itemSumEl=P(".J_ItemSum",this.itemEl),this.itemPicEl=P(".J_ItemImg",this.itemEl)},_initCouponPromo:function(){var e=this,t=e.data.promoCoupons;t&&t.length&&S.init({container:P(".promo-logos",e.itemEl)})},_initQuantity:function(){"combo"!==this.orderType&&new n({item:this,triggerEl:P(".J_ItemAmount",this.itemEl)})},_initVillager:function(){"combo"===this.orderType||this._villagr||(this._villager=new s({item:this}))},_initPromoTip:function(){var e=this;e.data.promotions&&(e.promo=new p({item:e})),e.data.askPromo&&(e.askPromo=new h({item:e}))},_initBigPic:function(){var e=this;e.mods.bigPic=new l({triggerEl:P(".J_ItemPic",e.itemEl),itemEl:e.itemEl,itemUrl:e.data.url,imgUrl:e.data.pic})},_initGoldReport:function(){var e=this;e.mods.goldReport=new c({itemEl:e.itemEl,itemUrl:e.data.url,imgUrl:e.data.pic})},_initOpArea:function(){var e=this;"pad"===Global.cfg.client&&(e.opEl=P(".J_ItemOps",e.itemEl),e.itemEl.on("swipe",function(t){if("left"===t.direction&&t.distance>=100){P(".J_ItemOps").hide();var i=e.itemEl.one(".td").height();e.opEl.css({height:i,"line-height":i+"px"}).show()}}).on("click",function(e){var t=P(e.target);t.hasClass("item-operations")&&t.parent(".item-operations")||P(".item-operations").hide()}))},_initItemDel:function(){var e=this;e.itemEl.delegate("click",".J_Del",function(t){t.preventDefault(),"pad"===Global.cfg.client&&t.stopPropagation(),d.del(e,{success:function(){_.record(e)}}),Global.utils.makepoint("8.8")})},_initItemFav:function(){new u({item:this})},_initPK:function(){var e=this;e.itemEl.delegate("click",".J_Diff",function(t){t.preventDefault(),"pad"===Global.cfg.client&&t.stopPropagation(),T.add(e,t.target)})},_initCheckbox:function(){var t=this;P(t.itemEl).delegate("click",".J_CheckBoxItem",function(e){Global.resetTemp(),t.isSelected()?t.unselect():t.select(),Global.utils.makepoint("8.6")}),!e.isUndefined(t.isSelected())&&t.check(t.isSelected())},_initSkuEdit:function(){return!!this.skuEdit||(this.skuEdit=new f({skuStatus:this.data.skuStatus,item:this}),!0)},_initServices:function(){var e=this;e.data.services&&(e.mods.services=new Services({itemEl:e.itemEl,item:e}))},_initItemIcons:function(){var e=this;e.itemIcons=new v({item:e})},_initLottery:function(){var e=this.getAttr("lottery");e&&(this.mods.lottery=new I({itemEl:this.itemEl,lottery:e}))},_initFindSimilar:function(){var t=this;P(".J_find_similar_trigger",t.itemHolderEl).length&&t.itemHolderEl.delegate("click",".J_find_similar_trigger",function(i){var a=Global.getCart(),o=t.getOrder(),r=o.getItems(),n=[];if(a){var s=a.getItems(null,20);e.each(s,function(e){n.push(e.itemId)})}e.each(r,function(t){e.inArray(t.itemId,n)||n.push(t.itemId)});var l;l=P(i.target).hasClass(".J_find_similar_trigger")?P(i.target):P(i.target).parent(".J_find_similar_trigger");var c=P(l).parent(".J_find_similar"),d={itemid:t.data.itemId,categoryid:t.data.leafCategory,sellerid:t.data.sellerId,cartItems:n.join(",")},u=P(".find-similar-body",c);c.hasClass("open")?(c.removeClass("open"),c.addClass("close"),u.html('<img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif" class="find-similar-loading" />')):(P(".J_find_similar.open .find-similar-body").html('<img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif" class="find-similar-loading" />'),P(".J_find_similar.open").removeClass("open").addClass("close"),c.addClass("open"),c.removeClass("close"),t.findSimilarComponent.render(u,d))})},isSelected:function(e){return e+1&&(this.data.model.isSelected=e),this.data.model.isSelected},remove:function(t){var i=this,a=this.itemEl,o=this.cartId;i.destroy(),a.fadeOut(.3,function(){a.remove();var e=P("#J_ItemHolder_"+o);e&&e.length&&e.html("").hide()}),e.isFunction(t)&&t()},destroy:function(){var t=this.getBundle();e.each(this.mods,function(e){e&&e.destroy&&e.destroy()}),this.check(!1),t.removeItem(this.cartId),e.log(A+" item "+this.cartId+" destroyed."),Global.updateCart()},check:function(e){e+1&&(this.isSelected(!!e),this.itemEl[(e?"add":"remove")+"Class"]("selected item-selected"),P(".J_CheckBoxItem",this.itemEl).prop("checked",e),P(".cart-checkbox",this.itemEl)[(e?"add":"remove")+"Class"]("cart-checkbox-checked"),Global[(e?"add":"remove")+"SelectedItems"](this));
},select:function(){var t=this,i=this.getBundle();if(this.isValid){if(this.isSelected()!==!0&&Global.getSelectedItemsLength()>=50)return this.check(!1),g.alert(b.lang("TIPS_SEPARATE_CHECKOUT"),b.lang("TIPS_SELECTED_ITEMS")),!1;if(1===this.data.skuStatus)return this.skuEdit||this._initSkuEdit(),this.skuEdit._initSku(function(){t.check(!0)},function(){t.check(!1)}),this.itemEl&&this.itemEl.offset()&&(o(window,{scrollTop:this.itemEl.offset().top-50},.5,"easeOutStrong").run(),e.log(A+"scrolled to select sku.")),!1;this.check(!0)}return i.check(),!0},unselect:function(){this.check(!1),this.getBundle().check()},mixData:function(t){return t.model=this.data.model,this.data=e.clone(t),this.data},getPrice:function(){return parseFloat(this.data.price.sum)||0},getCurrency:function(){try{return this.data.price.currency.symbol}catch(e){return"\uffe5"}},getUnitFactor:function(){try{return this.data.price.currency.unitFactor}catch(e){return 100}},getCurrencyCode:function(){try{return this.data.price.currency.code}catch(e){return"CNY"}},getQuantity:function(){return parseInt(this.data.amount.now,10)},getSkuId:function(){return this.data.skuId},getBundle:function(){var e=this.getOrder();return e.bundles[this.bundleId]},getOrder:function(){var e=Global.getCart(),t=null;return e&&e.orders&&(t=e.orders[this.orderId]),t},getAttr:function(t){var i=this;if(!i.attrs&&(i.attrs={},i.data.attr)){var a=i.data.attr.split(";");e.each(a,function(e){if(e){var t=e.split(":");i.attrs[t[0]]=t[1]}})}return t?i.attrs[t]:i.attrs},hasIcon:function(t){var i=this.data,a=i._iconAlias;return!(!a||!a.length)&&e.inArray(t,a)}}),y},{requires:["node","dom","event","anim","./itemTPL","./quantity/quantity","./villager/villager","./bigPic/bigPic","./goldReport","./del/del","./fav/fav","./promoTip/promo","./promoTip/promoTitleMap","./promoTip/ask-for-promo","./sku/sku-edit","../../utils/dialog/dialog","../cart/undo/undo","./icons/icons","./lottery/lottery","./pk/pk","../../utils/20141212/hongbao-label","../../utils/i18n/i18n","kg/open-component/1.0.6/lib/createKissy","kg/open-component/1.0.6/lib/config"]}),KISSY.add("cart/mods/item/comboItem",function(e,t){function i(t){e.mix(this,t),this._init()}return e.extend(i,t,{_init:function(){i.superclass._init.call(this)},_initQuantity:function(){},_initItemDel:function(){this.isDisabled&&i.superclass._initItemDel.call(this)},_initItemFav:function(){this.isDisabled&&i.superclass._initItemFav.call(this)},_initOpArea:function(){}}),i},{requires:["./baseItem"]}),KISSY.add("cart/mods/item/services/services",function(e,t){function i(t){e.mix(this,t),this._init()}var a=t.all;return e.augment(i,{_init:function(){var e=this,t="services-collapsed";e.serviceEl=a(".item-services",e.itemEl),a(e.itemEl).delegate("click",".J_ToggleSerivces",function(i){i.preventDefault();var a=e.serviceEl.hasClass(t);e.serviceEl[(a?"remove":"add")+"Class"](t),e.item.data.model.serviceCollapsed=!a})}}),i},{requires:["node"]}),KISSY.add("cart/mods/item/serviceItem",function(e,t,i){function a(t){e.mix(this,t),this._init()}return e.extend(a,t,{_init:function(){a.superclass._init.call(this),Global.lazyload(this.itemHolderEl,this._initService,this)},_initService:function(){var e=this;e.data.services&&(e.mods.services=new i({itemEl:e.itemEl,item:e}))},getPrice:function(){var t=a.superclass.getPrice.call(this),i=0;return e.each(this.data.services,function(e){i+=e.sum}),parseFloat(i)+t}}),a},{requires:["./baseItem","./services/services"]}),KISSY.add("cart/mods/item/redemptionItem",function(e,t){function i(t){e.mix(this,t),this._init()}return e.extend(i,t,{_init:function(){this.checkSelect(),i.superclass._init.call(this)},checkSelect:function(){var e=!0;this.data.model&&this.data.model.isSelected||(this.data.isValid===!0?!this.otherData||this.otherData.bundleChecked||this.otherData.hasSelectedItem||(e=!1):e=!1,this.data.model=this.data.model||{},this.data.model.isSelected=e)},_initQuantity:function(){}}),i},{requires:["./baseItem"]}),KISSY.add("cart/mods/item/crossShopItem",function(e,t){function i(t){e.mix(this,t),this._init()}return e.extend(i,t,{_init:function(){i.superclass._init.call(this)}}),i},{requires:["./baseItem"]}),KISSY.add("cart/mods/item/ju11Item",function(e,t){function i(t){e.mix(this,t),this._init()}return e.extend(i,t,{_init:function(){i.superclass._init.call(this)}}),i},{requires:["./baseItem"]}),KISSY.add("cart/mods/item/itemFactory",function(e,t,i,a,o,r,n,s){return{create:function(l){var c,d=l.data;if("deleted"===d.type)return null;switch(d.type="combo"===l.orderType?"combo":l.type,(d.isExtraItem||d.extraItemInfo)&&(d.type="redemption"),d.services&&(d.type="service"),d.host&&Global.globalData&&Global.globalData[("B"===d.host?"b":"c")+"ItemsCount"]++,e.mix(l,{cartId:d.cartId,itemId:d.itemId,isValid:d.isValid,title:d.title,pic:d.pic,url:d.url,isCombo:"combo"===l.orderType}),l.group=l.host,l.host){case"C":case"B":case"CT":case"SM":case"LG":case"ZSL":case"YY":case"YYZY":case"XINXUAN":l.group="normal";break;case"ALITRIP":l.group="ALITRIP";break;case"HK":d.isDutyFree?l.group="HK_"+d.sellerId:Global.globalData.isComboSubmit&&Global.globalData.isExchangeIdentity?l.group="normal":l.group="HK"}if(Global.globalData.checkoutRules&&d.checkoutGroup){var u=Global.globalData.checkoutRules[d.checkoutGroup];l.group=d.checkoutGroup,l.groupTitle=u&&u.title,l.groupToBuy=u&&u.url}d.isCod&&(l.group="cod"),d.isValid===!1&&"JU_11"===d.code&&(d.type="ju11"),d.isPreSell&&(d.type="presell"),d.isValid===!1&&d.checkbox&&d.checkbox.uncheckable&&(d.type="nocheckbox"),d=t.deal(d);var p;switch(l.data.type){case"deleted":return null;case"nocheckbox":l.data.type="nocheckbox",c=new i(l);break;case"combo":p=e.merge(l,{isCombo:!0,comboId:l.data.comboId}),c=new a(p);break;case"redemption":p=e.merge(l,{isRedemption:!0}),c=new r(p);break;case"act":p=e.merge(l,{isCrossShop:!0,crossShopActId:d.crossShopActId,channelInfo:d.channel}),c=new n(p);break;case"service":p=e.merge(l,{isService:!0}),c=new o(p);break;case"ju11":p=e.merge(l,{isJu11:!0}),c=new s(p);break;case"presell":p=e.merge(l,{isPreSell:!0}),c=new i(p);break;case"villager":l.data.type="villager",c=new i(l);break;default:l.data.type="normal",c=new i(l)}return c.level="item",c}}},{requires:["./itemData","./baseItem","./comboItem","./serviceItem","./redemptionItem","./crossShopItem","./ju11Item"]}),KISSY.add("cart/mods/bundle/ctCoupon/coupon_code",function(e){return{COUPON_SPREAD_NOT_START_OR_END:"\u8be5\u4f18\u60e0\u5238\u5df2\u7ecf\u505c\u6b62\u9886\u7528\uff01",COUPON_TOTAL_COUNT_EXCEED_LIMIT:"\u8be5\u4f18\u60e0\u5238\u5df2\u7ecf\u88ab\u9886\u53d6\u5b8c\u4e86\uff01",APPLY_SINGLE_COUPON_COUNT_EXCEED_LIMIT:"\u60a8\u9886\u53d6\u7684\u4f18\u60e0\u5238\u6570\u91cf\u5df2\u8fbe\u5230\u4e0a\u9650\uff01",RC_NOT_LOGIN:"\u8bf7\u5148\u767b\u5f55\uff0c\u518d\u6765\u9886\u53d6\uff01",APPLY_COUPON_FAIL:"\u9886\u53d6\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01"}}),KISSY.add("cart/mods/bundle/ctCoupon/coupon",function(e,t,i,a,o,r,n,s){function l(e){return e>9?e:"0"+e}function c(e){var t=new Date;return t.setTime(e),t.getFullYear()+"."+l(t.getMonth()+1)+"."+l(t.getDate())}function d(t){var i=this;e.mix(i,t),i.showing=!1,u(i.bundleEl).delegate("click",".J_CtShopCoupon",function(e){e.preventDefault(),i.$trigger=i.$trigger||u(e.currentTarget),i.toggle(),Global.utils.makepoint("8.37")}),Global.listen("hidePopup",function(e){var t=e.ev,a=u(t.target);a.parent(".coupon-popup")||a.hasClass("J_CtShopCoupon")||a.hasClass("coupon-popup")||a.parent(".J_CtShopCoupon")||a.hasClass("applyCoupon-overlay")||a.parent(".applyCoupon-overlay")||i.hide()})}var u=t.all,p="[coupon] ";window.TB=window.TB||{},TB.Act=TB.Act||{};var m,h='<div class="coupon-summary"><p><span class="icon-announcement"></span>'+n.lang("CT_COUPON_TIPS")+'</p></div><div class="coupon-list {{#if list.length > 3}}coupon-list-hidden{{/if}}"><ul class="J_ShopCouponList">{{#each list as coupon}}<li class="coupon coupon-{{coupon.type}}"><div class="coupon-amount {{#if coupon.type == 2}}shop{{#elseif coupon.type == 3}}goods{{/if}}"><span class="rmb">&yen;</span>{{coupon.offers}}</div><div class="coupon-detail"><div class="coupon-info"><p class="coupon-title">{{coupon.title}}</p><p class="coupon-time">{{coupon.timeRange}}</p></div><div class="coupon-op"><span class="coupon-unreceived J_ApplyCouponBtn" data-id="{{coupon.couponKey}}" data-uuid="{{coupon.uuid}}" data-sid="{{coupon.sellId}}">'+n.lang("GET_COUPON")+'</span></div>{{#if coupon.type <= 2}}<div class="coupon-makeup"><a href="{{coupon.goAddress}}" target="_blank">\u53bb\u51d1\u5355</a></div>{{/if}}</div></li>{{/each}}</ul></div><span class="arrow"></span>',f="ct-coupon-trigger-hover";return e.augment(d,{show:function(){var t=this;t.showing=!0,u(".coupon-popup").remove(),e.use("overlay",function(e,r){t.popup=new r.Popup({elCls:"cart-tips ct-coupon coupon-popup",content:'<div class="loading"></div><span class="arrow"></span>',align:{node:t.$trigger,points:["bl","tl"],offset:[0,10]},closable:!0}),t.popup.show(),t.popup.on("hide",e.bind(t.hide,t));for(var n=(s.now(),0),l=t.couponInfo.length;n<l;n++){var d=t.couponInfo[n];switch(d.offers=Math.floor(d.couponRight/100)||0,d.timeRange=c(d.activityStartDate)+"-"+c(d.endActivityDate),d.rightRange){case"crossMerchant":d.type=1;break;case"merchant":d.type=2;break;case"item":d.type=3}Global.utils.isDaily&&(d.goAddress=d.goAddress.replace("taobao.com","daily.taobao.net"))}var f={list:t.couponInfo};m||(m=a(h));var g=o(m,f,p);t.popup.set("content",g),f.list.length>3&&e.use("gallery/kscroll/1.1/index",function(e,i){new i(u(".J_ShopCouponList",t.popup.get("contentEl")),{prefix:"cart-",hotkey:!0,bodydrag:!0,allowArrow:!1})}),u(t.popup.get("el")).delegate("click",".J_ApplyCouponBtn",function(e){e.preventDefault();var a=u(e.currentTarget),o=a.hasClass("disabled"),r=s.now();o||(i({url:"//cunitem."+(Global.utils.isDaily?"daily.taobao.net":"taobao.com")+"/couponApply/httpApply.json",data:{couponKey:a.attr("data-id"),sellerId:a.attr("data-sid"),uuid:a.attr("data-uuid")},dataType:"jsonp",success:function(e,i,o){e=e||{},e.success+""=="true"?(t.showSuccess(a,"youhuiquan"),s.retSuccess("//cunitem.taobao.com/couponApply/httpApply.htm",s.now()-r)):(t.showError(a,e.code,e.errorMessage),s.retError("//cunitem.taobao.com/couponApply/httpApply.htm",s.now()-r,JSON.stringify({status:o.status,errorCode:e.code})))},error:function(e,i,o){t.showError(a),s.retError("//cunitem.taobao.com/couponApply/httpApply.htm",s.now()-r,o)},timeout:5}),a.addClass("disabled")),Global.utils.makepoint("8.39")})})},hide:function(){this.showing=!1,this.popup&&this.popup.destroy(),this.$trigger&&this.$trigger.removeClass(f)},toggle:function(){this.showing?this.hide():(this.show(),this.$trigger&&this.$trigger.addClass(f))},showSuccess:function(e,t){e&&e.replaceClass("J_ApplyCouponBtn coupon-unreceived","coupon-received").html(n.lang("GET_COUPON_SUCCESS"))},showFail:function(e){e&&e.replaceClass("J_ApplyCouponBtn coupon-unreceived","coupon-received").html(n.lang("GET_COUPON_FAIL"))},showError:function(t,i,a){"APPLY_SINGLE_COUPON_COUNT_EXCEED_LIMIT"==i?t&&t.replaceClass("J_ApplyCouponBtn coupon-unreceived","coupon-limit").html(n.lang("CT_COUPON_LIMIT")):(a=r[i]||a||"\u7cfb\u7edf\u5fd9\uff01\u8bf7\u7a0d\u5019\u518d\u8bd5\u5427~",e.log(p+"coupon get error: "+a),t&&t.parent(".coupon-detail").addClass("coupon-error").html(a))}}),d},{requires:["node","ajax","gallery/template/1.0/","../../../utils/tpl/render","./coupon_code","../../../utils/i18n/i18n","../../global/retcode"]}),KISSY.add("cart/utils/debug/debug",function(e){return{_show:function(t,i,a){t&&(i=i||"\u7cfb\u7edf\u9519\u8bef",a=a||"error",Global.utils.isDaily&&e.use("gallery/pageNotification/1.0/index",function(e,o){var r=new o({closeButton:!0,positionClass:"page-notification-top-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"0",extendedTimeOut:"0",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"});r[a](t,i)}))},error:function(e,t){this._show(e,t,"error")},success:function(e,t){this._show(e,t,"success")},info:function(e,t){this._show(e,t,"info")},warning:function(e,t){this._show(e,t,"warning")}}}),KISSY.add("cart/mods/bundle/baseBundle",function(e,t,i,a,o,r){function n(t){e.mix(this,t),this._init()}var s=(t.all,"[BaseBundle] ");return e.augment(n,{_init:function(){this.items={},this.updateTimer=null,this.checkTimer=null,this.data.model=this.data.model||{},this.data.uniqueId=this.id;var t=!1;e.each(this.data.items,function(e){if(e&&e.isValid&&!e.extraItemInfo&&e.model&&e.model.isSelected===!0)return t=!0,!1}),this.otherData={bundleChecked:this.data.model&&this.data.model.isChecked===!0,hasSelectedItem:t},this._render(),this._initItems(),Global.lazyload(this.bundleEl,function(){this._initCoupon()},this)},_render:function(){this.bundleEl=i.render(this.data)},_initItems:function(){var t=this;e.each(this.data.items,function(i,a){i.type=i.type||t.data.type,i.isFirstOne=0===a,i.isLastOne=a===t.data.items.length-1,i.orderType=t.orderType,i.host=t.host;try{t.items[i.cartId]=t._initItem(i)}catch(o){var n="item "+i.itemId+" construct error: "+o;e.log(n,"warn"),r.error("\u5b9d\u8d1d\u6e32\u67d3\u51fa\u9519\uff0c\u5b9d\u8d1did\uff1a"+i.itemId+"<br/>"+n,"\u5b9d\u8d1d"+i.itemId+"\u6e32\u67d3\u51fa\u9519"),Global.utils.logger("baseBundle","error",n)}})},_initItem:function(e){var t=this;return a.create({bundleId:t.id,type:e.type||t.type,data:e,host:t.host,orderType:t.orderType,orderId:t.orderId,comboId:t.comboId,shopId:t.shopId,shopActId:t.shopActId,page:t.page,otherData:t.otherData})},_initCoupon:function(){var e=this;new o({bundleEl:e.bundleEl,couponInfo:e.data.ctCouponInfoViews})},getSelectedCartIds:function(){var t=[];return e.each(this.items,function(e){e&&e.isSelected()&&t.push(e.cartId)}),t},isChecked:function(t){return t+1&&(this.data.model.isChecked=t),t===!0&&e.each(this.items,function(e){e&&e.isSelected(!0)}),this.data.model.isChecked},hasSelectedItem:function(){var t=!1;return e.each(this.items,function(e){if(e&&e.isValid&&e.isRedemption!==!0&&e.isSelected())return t=!0,!1}),t},isAllSelected:function(){var t=!0;return e.each(this.items,function(e){if(e&&e.isValid&&"redemption"!==e.data.type&&!e.isSelected())return t=!1,!1}),t===!0&&e.each(this.items,function(e){e&&"redemption"===e.data.type&&e.check(!0)}),e.log("[Bundle] all items selected: "+t),t},check:function(t){if(this.checkTimer&&clearTimeout(this.checkTimer),t+1){e.log(s+"check status: "+t),this.isChecked(t);var i=this.getOrder();i&&i.check()}else{var a=this;a.checkTimer=setTimeout(function(){a.check(a.isAllSelected())},100)}},select:function(){var t=!0;return e.each(this.items,function(e){if(e&&1===e.data.skuStatus)return t=!1,e.select(),!1}),t===!0&&(e.each(this.items,function(e){if(e&&!e.select())return t=!1,!1}),this.check(t)),t},unselect:function(){this.check(!1),e.each(this.items,function(e){e&&e.unselect()})},getTotalPriceIgnoreSelection:function(){var t=0;return e.each(this.items,function(e){e&&e.isValid&&(t+=e.getPrice())}),t},getTotalPriceCurrency:function(){var t="";return e.each(this.items,function(e){t=t||e&&e.getCurrency()||"\uffe5"}),t},getPriceUnitFactor:function(){var t;return e.each(this.items,function(e){t=t||e&&e.getUnitFactor()||100}),t},getTotalPrice:function(){var t=0;return e.each(this.items,function(e){e&&e.isSelected()&&e.isValid&&(t+=e.getPrice())}),t},getQuantity:function(){var t=0,i=0,a=0;return e.each(this.items,function(e){e?e.isValid?t+=1:i+=1:a+=1}),{valid:t,invalid:i,deleted:a}},removeItem:function(e){return this.items[e]&&(this.items[e]=null),this.update(),this},removeItems:function(t){var i=[];return filter=e.isFunction(filter)?filter:function(){return!0},e.each(this.items,function(e){e&&filter(e)&&(e.remove(),i.push(e.cartId))}),i},remove:function(){this.bundleEl.remove(),this.destroy()},destroy:function(){e.each(this.items,function(e){e&&e.destroy&&e.destroy()}),this.getOrder().removeBundle(this.id),e.log(s+" bundle "+this.id+" destroyed.")},update:function(t){t=e.isUndefined(t)?-1:t;var i=e.bind(function(){Global.utils.isEmpty(this.items)&&(e.log(s+"bundle empty. remove."),this.remove());var i=this.getOrder();i&&i.update(t)},this);this.updateTimer&&clearTimeout(this.updateTimer),t<0?i():this.updateTimer=setTimeout(i,t)},render:function(t){var i=this;e.each(t.orders,function(t){i.items[t.cartId]?i.items[t.cartId]=i._initItem(e.mix(i.items[t.cartId],t)):i.items[t.cartId]=i._initItem(t)})},getData:function(){var t=this,i=[];return e.each(t.items,function(e){e&&i.push(e.data)}),e.mix(t.data,{orders:i})},getItems:function(){var t=[];return e.each(this.items,function(e){e&&t.push(e)}),t},getItemByCartId:function(t){var i=!1;return e.each(this.items,function(e){if(e&&e.cartId===t)return i=e,!1}),i},mixData:function(t){return t.model=this.data.model,this.data=e.clone(t),this.data},getOrder:function(){var e=Global.getCart(),t=null;return e&&e.orders&&(t=e.orders[this.orderId]),t}}),n},{requires:["node","./bundleTPL","../item/itemFactory","./ctCoupon/coupon","../../utils/debug/debug"]}),KISSY.add("cart/mods/bundle/actBundle",function(e,t,i){function a(t){e.mix(this,t),this._init()}t.all;return e.extend(a,i,{_init:function(){a.superclass._init.call(this)}}),a},{requires:["node","./baseBundle"]}),KISSY.add("cart/mods/bundle/redemptionBundle",function(e,t,i){function a(t){e.mix(this,t),this._init()}t.all;return e.extend(a,i,{_init:function(){a.superclass._init.call(this)},isAllSelected:function(){var t=!0,i=!1,a=[];return e.each(this.items,function(e){e&&e.isValid&&(e.isRedemption===!0?a.push(e):e.isSelected()?i=!0:t=!1)}),e.each(a,function(e){e&&e.check(i)}),e.log("[Bundle] all items selected: "+t),t}}),a},{requires:["node","./baseBundle"]}),KISSY.add("cart/mods/bundle/del/bundle-del",function(e,t,i,a,o,r){function n(t){e.mix(this,t)}t.all;return e.augment(n,{del:function(){this._addHighlight(),a.confirm(r.lang("TIPS_CONFIRM_DELETE_PACKAGE"),r.lang("PROMPT_MESSAGE"),void 0,e.bind(this._delBundle,this),e.bind(this._removeHighlight,this))},_addHighlight:function(){this.highlight||(this.highlight=new i(this.bundle.bundleEl)),this.highlight.add()},_removeHighlight:function(){this.highlight&&this.highlight.remove()},_delBundle:function(e){var t=this,i=t.bundle,a=i.getOrder();e=e||i.getItems(),Global.request({type:"deleteSome",orders:a,operate:e,success:function(i){t._removeHighlight(),i.success&&(o.record(e),a.remove(),Global.updateCart())},error:function(){}})}}),n},{requires:["node","../../../utils/highlight/highlight","../../../utils/dialog/dialog","../../cart/undo/undo","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/bundle/comboBundle",function(e,t,i,a){function o(t){e.mix(this,t),this._init()}var r=t.all;return e.extend(o,i,{_init:function(){var e=this;o.superclass._init.call(e),e.mods=e.mods||{},Global.lazyload(e.bundleEl,function(){e.data.valid===!0&&e._initSelect(),e._initDel()})},_initSelect:function(){var e=this;e.bundleEl.delegate("click",".J_BundleChk",function(t){t.preventDefault(),e.isChecked()?e.unselect():e.select()})},_initDel:function(){var e=this;e.mods.del=new a({bundle:e}),e.bundleEl.delegate("click",".J_ComboBundleDel",function(t){t.preventDefault(),e.mods.del.del()})},select:function(){var e=o.superclass.select.call(this),t=r(".body-level",this.bundleEl);e?t.addClass("bundle-selected"):(this.unselect(),t.removeClass("bundle-selected"))}}),o},{requires:["node","./baseBundle","./del/bundle-del"]}),KISSY.add("cart/mods/bundle/bundleFactory",function(e,t,i,a,o){return{create:function(e){var o;switch(e.data.items=e.data.orders,delete e.data.orders,"redemption"===e.orderType&&(e.type="redemption"),e.type){case"act":o=new i(e);break;case"redemption":o=new a(e);break;default:e.data.type=e.type||"normal",o=new t(e)}return o.level="bundle",o}}},{requires:["./baseBundle","./actBundle","./redemptionBundle","./comboBundle"]}),KISSY.add("cart/mods/order/promoScroll/promoScroll",function(e){function t(t,i){var a=t.all("li");a.length<2?i&&i():e.use("gallery/switchable/1.3.1/",function(e,o){o.Slide(t,{markupType:2,panels:a,hasTriggers:!1,effect:"scrolly",interval:3,duration:.5}),i&&i()})}return t}),KISSY.add("cart/mods/order/coupon/coupon-codes",function(e){return{RC_ACTIVITY_STATUS_INVALID:"\u8be5\u4f18\u60e0\u5238\u5df2\u7ecf\u505c\u6b62\u9886\u7528\uff01",RC_SHOPBONUS_TOTAL_COUNT_EXCEED:"\u8be5\u4f18\u60e0\u5238\u5df2\u7ecf\u88ab\u9886\u53d6\u5b8c\u4e86\uff01",RC_SHOPBONUS_PERSON_COUNT_EXCEED:"\u60a8\u9886\u53d6\u7684\u4f18\u60e0\u5238\u6570\u91cf\u5df2\u8fbe\u5230\u4e0a\u9650\uff01",RC_SELLER_SHOPBONUS_COUNT_EXCEED:"\u60a8\u9886\u53d6\u7684\u4f18\u60e0\u5238\u6570\u91cf\u5df2\u8fbe\u5230\u4e0a\u9650\uff01",RC_CANNOT_SELF_APPLY:"\u4e0d\u80fd\u9886\u53d6\u81ea\u5df1\u5e97\u94fa\u7684\u4f18\u60e0\u5238\uff01",RC_NOT_LOGIN:"\u8bf7\u5148\u767b\u5f55\uff0c\u518d\u6765\u9886\u53d6\uff01",RC_SYSTEM_ERROR:"\u9886\u53d6\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01"}}),KISSY.add("cart/mods/order/coupon/coupon",function(e,t,i,a,o,r,n,s){function l(t){var i=this;e.mix(i,t),i.showing=!1,c(i.orderEl).delegate("click",".J_MyShopCoupon",function(e){e.preventDefault(),i.$trigger=i.$trigger||c(e.currentTarget),i.toggle(),Global.utils.makepoint("8.37")}),Global.listen("hidePopup",function(e){var t=e.ev,a=c(t.target);a.parent(".coupon-popup")||a.hasClass("J_MyShopCoupon")||a.hasClass("coupon-popup")||a.parent(".J_MyShopCoupon")||a.hasClass("applyCoupon-overlay")||a.parent(".applyCoupon-overlay")||i.hide()})}var c=t.all,d="[coupon] ";window.TB=window.TB||{},TB.Act=TB.Act||{};var u,p='<div class="coupon-summary"><span class="icon-announcement"></span>'+n.lang("TPL_TIPS_COUPON_GOT_COUNT")+'</div><div class="coupon-list {{#if priceVolumes.length > 3}}coupon-list-hidden{{/if}}"><ul class="J_ShopCouponList">{{#each priceVolumes as coupon}}<li class="coupon coupon-{{coupon.type}}"><div class="coupon-amount"><span class="rmb">&yen;</span>{{coupon.price}}</div><div class="coupon-detail"><div class="coupon-info"><p class="coupon-title">{{#if coupon.type == "hongbao"}}\u5e97\u94fa\u7ea2\u5305{{#else}}{{coupon.title}}{{/if}}&nbsp;{{coupon.condition}}</p><p class="coupon-time">{{coupon.timeRange}}</p></div><div class="coupon-op">{{#if coupon.status === "received"}}<span class="coupon-received">'+n.lang("GET_COUPON_SUCCESS")+'</span>{{#else}}<span class="coupon-unreceived J_ApplyCouponBtn" data-id="{{coupon.id}}" data-type="{{coupon.type}}">'+n.lang("GET_COUPON")+'</span>{{/if}}</div></div></li>{{/each}}</ul></div><span class="arrow"></span>',m="shop-coupon-trigger-hover";return e.augment(l,{show:function(){var t=this;t.showing=!0,c(".coupon-popup").remove(),e.use("overlay",function(e,r){t.popup=new r.Popup({elCls:"cart-tips coupon-popup",content:'<div class="loading"></div><span class="arrow"></span>',align:{node:t.$trigger,points:["bl","tl"],offset:[0,10]},closable:!0}),t.popup.show(),t.popup.on("hide",e.bind(t.hide,t));var n=s.now();new i({type:"get",url:"json/GetPriceVolume.do",data:{sellerId:t.sellerId},success:function(r){u||(u=a(p));var l=o(u,r,d);t.popup.set("content",l),t.$count=c(".J_ReceivedCount",t.popup.get("el")),r.priceVolumes&&r.priceVolumes.length>3&&e.use("gallery/kscroll/1.1/index",function(e,i){new i(c(".J_ShopCouponList",t.popup.get("contentEl")),{prefix:"cart-",hotkey:!0,bodydrag:!0,allowArrow:!1})}),c(t.popup.get("el")).delegate("click",".J_ApplyCouponBtn",function(a){a.preventDefault();var o=c(a.currentTarget),r=o.attr("data-type");if("hongbao"===r){var n=Global.utils.isDaily?"g-assets.daily.taobao.net":"g.alicdn.com";e.getScript("//"+n+"/tb/smf/1.16.0/utils/applyCoupon-min.css"),e.getScript("//"+n+"/tb/smf/1.16.0/utils/applyCouponWidget-min.js",function(){e.use("smf/coupon/apply",function(e,i){new i({trigger:o,applyChannel:3,type:o.attr("data-type"),activityId:o.attr("data-id"),sellerId:t.sellerId,cburl:"//"+Global.utils.cartPath+"/weiboBindProxy.htm",daily:Global.utils.isDaily,showItems:!1}).on("success",function(e){t.showSuccess(o,"hongbao")}).on("fail",function(e){t.showFail(o)})})},"utf-8"),Global.utils.makepoint("8.38")}else{var l=o.hasClass("disabled"),d=s.now();l||(i({url:"//taoquan."+(Global.utils.isDaily?"daily.taobao.net":"taobao.com")+"/coupon/unify_apply.htm",data:{activityId:o.attr("data-id"),sellerId:t.sellerId,json:!0,applyChannel:5},dataType:"jsonp",jsonp:"callBack",success:function(e,i,a){e=e||{},"true"===e.success?(t.showSuccess(o,"youhuiquan"),s.retSuccess("//taoquan.taobao.com/coupon/unify_apply.htm",s.now()-d)):(t.showError(o,e.code,e.msg),s.retError("//taoquan.taobao.com/coupon/unify_apply.htm",s.now()-d,JSON.stringify({status:a.status,errorCode:e.code})))},error:function(e,i,a){t.showError(o),s.retError("//taoquan.taobao.com/coupon/unify_apply.htm",s.now()-d,a)},timeout:5}),o.addClass("disabled")),Global.utils.makepoint("8.39")}}),s.retSuccess("json/GetPriceVolume.do",s.now()-n)},error:function(e,t,i){s.retError("json/GetPriceVolume.do",s.now()-n,i)},dataType:"jsonp"})})},hide:function(){this.showing=!1,this.popup&&this.popup.destroy(),this.$trigger&&this.$trigger.removeClass(m)},toggle:function(){this.showing?this.hide():(this.show(),this.$trigger&&this.$trigger.addClass(m))},showSuccess:function(e,t){if("youhuiquan"===t&&e&&e.replaceClass("J_ApplyCouponBtn coupon-unreceived","coupon-received").html(n.lang("GET_COUPON_SUCCESS")),this.$count){var i=parseInt(this.$count.html(),10);this.$count.html(++i)}},showFail:function(e){e&&e.replaceClass("J_ApplyCouponBtn coupon-unreceived","coupon-received").html(n.lang("GET_COUPON_FAIL"))},showError:function(t,i,a){a=r[i]||a||"\u7cfb\u7edf\u5fd9\uff01\u8bf7\u7a0d\u5019\u518d\u8bd5\u5427~",e.log(d+"coupon get error: "+a),t&&t.parent(".coupon-detail").addClass("coupon-error").html(a)}}),l},{requires:["node","ajax","gallery/template/1.0/","../../../utils/tpl/render","./coupon-codes","../../../utils/i18n/i18n","../../global/retcode"]}),KISSY.add("cart/mods/order/poolOrder/poolOrder",function(e,t,i,a,o,r,n,s){function l(t){e.mix(this,t),this._init()}var c=t.all,d='<ul class="poolorder-carousel">{{#each currentPageItems as curData}}<li class="poolorder-item item-wrapper"><div class="pic s100"><a href="{{curData.url}}" target="_blank"><img src="{{curData.pic}}_200x200.jpg" /></a><a class="pool-add-cart J_CartPluginTrigger" order={{orderId}} href="{{curData.url}}" target="_blank">\u52a0\u5165\u8d2d\u7269\u8f66</a></div><div class="item-info"><div class="item-sell"><p class="price"><span class="origin-price">&yen;<em>{{curData.price}}</em></span></p><p class="sell-num">{{curData.monthSellCount}}\u4eba\u4ed8\u6b3e</p></div><p class="title"><a href="{{curData.url}}" target="_blank" title="{{curData.itemName}}">{{curData.itemName}}</a></p></div></li>{{/each}}</ul><div class="trigger-bar">{{#each pages as page}}<a href="javascript:void(0)" index={{page}} class="pool-pagination {{#if currentPage===page}}current{{/if}}">\u2022</a>{{/each}}</div><div class="pool-navigator-container"><a href="javascript:void(0)" class="pool-navigator prev-navigator {{#if !prevCanSwitch}}no-more{{/if}}"><span class="pool-icon pool-icon-prev">&#xe602;</span></a><a href="javascript:void(0)" class="pool-navigator next-navigator {{#if !nextCanSwitch}}no-more{{/if}}"><span class="pool-icon pool-icon-next">&#xe603;</span></a></div>';return e.augment(l,{_init:function(){this._reset()},_reset:function(){this.currentPage=1,this.prevCanSwitch=!0,this.nextCanSwitch=!0,this.pageCount=0,this.itemsCount=0,this.pageItemsCount=0,this.pvid="",this.scm="",this.originData={},this.pageItemsCount=this._getRenderCount(c("#J_Cart").width())},_render:function(){for(var e=[],t=0;t<this.pageCount;t++)e.push(t+1);var a=i(d).render({orderId:this.orderId,currentPage:this.currentPage,prevCanSwitch:this.prevCanSwitch,nextCanSwitch:this.nextCanSwitch,pageCount:this.pageCount,pages:e,itemsCount:this.itemsCount,currentPageItems:this._getPageItems(this.originData.result,this.currentPage,this.pageItemsCount)});this.container.html(a)},_calCount:function(){this.itemsCount=this.itemsCount?this.itemsCount:this.originData.result.length,this.pageCount=this.pageCount?this.pageCount:Math.ceil(this.itemsCount/this.pageItemsCount),1===this.currentPage?this.prevCanSwitch=!1:this.prevCanSwitch=!0,this.currentPage===this.pageCount?this.nextCanSwitch=!1:this.nextCanSwitch=!0},_getPageItems:function(e,t,i){var a=e.slice(),o=(t-1)*i,r=i;return a=a.splice(o,r)},_getRenderCount:function(e){var t=5;return e<1100&&(t=4),t},_bindEvent:function(){var e=this;e.container.detach("click mouseover"),e.container.delegate("click",".pool-navigator",function(t){var i=c(t.currentTarget);i.hasClass("no-more")||(i.hasClass("prev-navigator")&&(e.currentPage=e.currentPage-1),i.hasClass("next-navigator")&&(e.currentPage=e.currentPage+1),e._calCount(),e._render())}),e.container.delegate("click",".pool-pagination",function(t){var i=parseInt(c(t.currentTarget).attr("index"));i!==e.currentPage&&(e.currentPage=i,e._calCount(),e._render())}),e.container.delegate("mouseover",".pool-pagination",function(t){var i=parseInt(c(t.currentTarget).attr("index"));i!==e.currentPage&&(e.currentPage=i,e._calCount(),e._render())})},getData:function(){for(var e=this,t=e.items,a=[],r=s.now(),l=0;l<t.length;l++){var c=t[l];a.push(c.itemId+":"+c.data.amount.now)}a=a.join(","),new o({type:"get",dataType:"jsonp",url:"//tui.taobao.com/recommend",data:{sellerId:e.sellerId,totalPrice:this.poolOrderData.totalPrice,gap:this.poolOrderData.gap,itemIds:a,advancedAction:encodeURIComponent(this.poolOrderData.advancedAction),appid:3074},timeout:5,success:function(t){if(t&&t.result&&t.result.length>0)e._reset(),e.originData=t,e._calCount(),e._render(),e._bindEvent();else{var a=i(n.tpl("EMPTY_SIMILAR")).render({});e.container.html(a)}s.retSuccess("//tui.taobao.com/recommend",s.now()-r)},error:function(t,a,o){var l=i(n.tpl("ERROR_SIMILAR")).render({});e.container.html(l),s.retError("//tui.taobao.com/recommend",s.now()-r,o)}})}}),l},{requires:["node","gallery/template/1.0/","dom","io","../../../utils/sku/sku","../../../utils/i18n/i18n","../../global/retcode"]}),KISSY.add("cart/mods/group/tpl/group.tpl",function(e,t,i){var a=(t.all,'{{#if coupon1111}}<div class="coupon1111 clearfix"><div><img src="{{coupon1111.pic}}" title="{{coupon1111.text}}" alt="{{coupon1111.text}}" />{{coupon1111.text}}{{#if coupon1111.linkWord}}<a href="{{coupon1111.linkUrl}}" target="_blank">{{coupon1111.linkWord}}</a>{{/if}}</div></div>{{/if}}');return{order:'<div id="J_Group_{{uniqueId}}" class="J_Group"><div class="group-hd"><div class="J_ItemHead shop clearfix"><div class="shop-info"><div class="cart-checkbox {{#if model && model.isSelected}}cart-checkbox-checked{{/if}}"><input class="J_CheckBoxGroup" id="J_CheckGroup_{{uniqueId}}" type="checkbox" name="groups[]" value="{{uniqueId}}" {{#if model && model.isSelected}}checked{{/if}} /><label for="J_CheckGroup_{{uniqueId}}">'+i.lang("TIPS_SELECT_ALL_ITEMS_IN_THIS_SHOP")+'</label></div>&nbsp;&nbsp;{{#if icon}}<img src="{{icon}}" class="shop-img"/>{{#elseif host != "C"}}{{#if host.indexOf("SM") != -1}}<span class="shop-icon icon-SM"></span>{{#elseif host == "YYZY"}}<span class="shop-icon icon-B"></span>{{#elseif host.indexOf("HKGS") != -1}}<span class="shop-icon icon-HK"></span>{{#else}}<span class="shop-icon icon-{{host}}"></span>{{/if}}{{/if}}{{#if title}}'+i.lang("SELLER")+'\uff1a<a href="{{url}}" target="_blank" title="{{title}}" class="J_MakePoint" data-point="tbcart.8.15">{{title}}</a>{{#elseif seller}}'+i.lang("SELLER")+'\uff1a<a href="{{url}}" target="_blank" title="{{seller}}" class="J_MakePoint" data-point="tbcart.8.15">{{seller}}</a>{{/if}}{{#if host !== "SM"}}{{#if seller}}<span class="J_WangWang" data-items="{{uniqueId}}" data-icon="small" data-nick="{{seller}}" data-display="inline"></span>{{/if}}{{/if}}</div></div></div><div class="group-main"><div class="group-body">{{#each bundles as bundleId index}}<div id="J_OrderHolder_{{bundleId}}_{{page}}"{{#if index == bundles.length - 1}} class="last-order"{{/if}}></div>{{/each}}</div><div class="group-foot">'+a+'{{#if coudanV2}}<div class="redemption-info"><div class="redemption-tip clearfix"><div class="amount">{{#if coudanV2.icon}}<img height="16px" style="vertical-align: sub;" src={{coudanV2.icon}} />&nbsp;{{/if}}{{#if coudanV2.text}}<span>{{coudanV2.text}}</span>{{/if}}{{#if (coudanV2.url && coudanV2.urlText)}}<a href={{coudanV2.url}} class="coudan-v2" target="_blank"><span class="coudan-v2-text">{{coudanV2.urlText}}</span><span>></span></a>{{/if}}</div></div></div>{{/if}}{{#if coudan}}{{#if coudan.type !== -2 && (coudan.type !== -1 || coudan.extraInfo)}}<div class="redemption-info" {{#if coudanV2}}style="display: none;"{{/if}}><div class="redemption-tip clearfix"><div class="amount">{{#if coudan.type == 1}}<span>{{#if coudan.priceLevelStr}}'+i.lang("TIPS_NO_FARE_WITH_PRICE")+"{{#else}}"+i.lang("TIPS_NO_FARE")+"{{/if}}</span>{{#if coudan.extraInfo}}<span>{{coudan.extraInfo}}</span>{{/if}}{{#elseif coudan.type == 0}}<span>"+i.lang("TIPS_TO_NO_FARE")+'</span>{{#if coudan.extraInfo}}<span>{{coudan.extraInfo}}</span>{{/if}}<a href="//chaoshi.tmall.com" target="_blank">'+i.lang("COUDAN")+"</a>{{#elseif coudan.extraInfo}}<span>{{coudan.extraInfo}}</span>{{/if}}</div></div></div>{{/if}}{{/if}}</div></div></div>"
}},{requires:["node","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/group/groupTPL",function(e,t,i,a,o){var r=t.all,n="[groupTPL] ",s={};return{generate:function(t){var r;if(t){var l=t.type&&o[t.type]?t.type:"normal";s[l]=s[l]||i(o[l]),r=a(s[l],t,n)}else e.log(n+"error: group data cannot be recognized.");return r},render:function(t){var i=this.generate(t),a="J_GroupHolder_"+t.uniqueId,o=r("#"+a);return o&&0!==o.length?o.html(i):(e.log(n+"cannot find group holder for group:"+t.id),o=r('<div id="'+a+'" class="J_GroupHolder"></div>').html(i).appendTo("#J_OrderList")),e.log(n+"group "+t.id+" rendered."),o}}},{requires:["node","gallery/template/1.0/","../../utils/tpl/render","./tpl/group.tpl"]}),KISSY.add("cart/mods/group/groupData",function(e,t){t.all;return{deal:function(e){if(e.coudan)try{e.coudan.currency=e.coudan.currency?e.coudan.currency:{code:"CNY",symbol:"\uffe5",unitFactor:100},e.coudan.priceStr=Global.utils.toMoney(e.coudan.price,e.coudan.currency.unitFactor),e.coudan.weightStr=e.coudan.weight/1e3}catch(t){}}}},{requires:["node"]}),KISSY.add("cart/mods/group/baseGroup",function(e,t,i,a){function o(t){e.mix(this,t),this._init()}var r=t.all;return e.augment(o,{_init:function(){a.deal(this.data),this.orders={},this.checkTimer=null,this.data.model=this.data.model||{},this.data.page=this.page||1,this.data.uniqueId=this.id,this._render()},_render:function(){this.groupHolderEl=i.render(this.data),this.groupEl=r("#J_Group_"+this.data.uniqueId,this.groupHolderEl)},isSelected:function(e){return e+1&&(this.data.model.isSelected=e),this.data.model.isSelected},isAllChecked:function(){var t=this,i=Global.getCart();if(i){var a=!0;return e.each(t.data.bundles,function(e){var o=i.orders[e+"_"+t.data.page];if(o&&o.data.isValid===!0&&!o.isChecked())return a=!1,!1}),a}return!1},check:function(e){if(this.checkTimer&&clearTimeout(this.checkTimer),e+1){this.isChecked=e,this.groupEl[(e?"add":"remove")+"Class"]("group-selected");var t=r(".J_CheckBoxGroup",this.groupEl).parent(".cart-checkbox");t&&t[(e?"add":"remove")+"Class"]("cart-checkbox-checked"),this.isSelected(e)}else{var i=this;this.checkTimer=setTimeout(function(){i.check(i.isAllChecked())},100)}},select:function(){var t=this,i=!0,a=Global.getCart();return a?(e.each(t.data.bundles,function(e){var o=a.orders[e+"_"+t.data.page];if(o&&o.data.isValid===!0&&!o.select())return i=!1,!1}),this.check(i),i):(this.check(!1),!1)},unselect:function(){var t=this,i=Global.getCart();i&&(e.each(t.data.bundles,function(e){var a=i.orders[e+"_"+t.data.page];a&&a.data.isValid===!0&&a.unselect()}),this.check(!1))},remove:function(){this.groupEl.remove(),this.removed=!0,this.data.model={}},removeOrder:function(t){var i=e.indexOf(t,this.data.bundles);i>-1&&this.data.bundles.splice(i,1),0===this.data.bundles.length&&this.remove()},checkTpl:function(e){var t=this;e&&t.mixData(e),t.removed===!0&&t._init(),t.removed=!1},mixData:function(t){var i=this;e.each(t.bundles,function(t){e.inArray(t,i.data.bundles)||i.data.bundles.push(t)})}}),o},{requires:["node","./groupTPL","./groupData"]}),KISSY.add("cart/mods/group/orderGroup",function(e,t,i){function a(t){e.mix(this,t),this.data.type="order",this._init()}t.all;return e.extend(a,i,{_init:function(){var e=this;a.superclass._init.call(e),Global.lazyload(e.groupEl,function(){e._initCheckbox()})},_initCheckbox:function(){var e=this;e.groupEl.delegate("click",".J_CheckBoxGroup",function(t){e.isSelected()?e.unselect():e.select()})}}),a},{requires:["node","./baseGroup"]}),KISSY.add("cart/mods/order/baseOrder",function(e,t,i,a,o,r,n,s){function l(t){e.mix(this,t),this._init()}var c=t.all,d="[BaseOrder] ";return e.augment(l,{_init:function(){var e=this.data.groupId;e&&(Global.cartGroups=Global.cartGroups||{},Global.cartGroups[e]||(Global.cartGroups[e]=new s({data:Global.groupData[e],id:e,page:this.data.page}))),this.bundles={},this._render(),this._initBundles(),this._initCheckbox(),this._bindEvents(),this.checkTimer=null,this.updateTimer=null,this.orderHolderEl.css("height","auto"),Global.lazyload(this.orderHolderEl,function(){this._initPromoHint(),this._initCoupon()},this)},_render:function(){this.originPoolOrderView=e.clone(this.data.poolOrderView);var t=this.data.poolOrderView;if(t&&4!==t.poolOrderDisplayType){t.currentCondition=this.getNumOrPrice(t.currentCondition);for(var a=t.currentAction,o=0;o<a.length;o++)a[o]=this.getNumOrPrice(a[o],!0);t.currentAction=a,t.advancedCondition=this.getNumOrPrice(t.advancedCondition);for(var r=t.advancedAction,o=0;o<r.length;o++)r[o]=this.getNumOrPrice(r[o],!0);t.advancedAction=r,t.gap=this.getNumOrPrice(t.gap),this.data.poolOrderView=t}this.orderHolderEl=i.render(this.data),this.orderEl=c("#J_Order_"+this.uniqueId,this.orderHolderEl)},_bindEvents:function(){this.wWidth=window.screen.width;var e=this;this.orderEl=c("#J_Order_"+this.uniqueId,this.orderHolderEl);var t=c(".poolorder-content",this.orderEl),i=c(".poolorder-info",this.orderEl),a=null;i&&this.originPoolOrderView&&4!==this.originPoolOrderView.poolOrderDisplayType&&(c(".price",i).html(Global.utils.toMoney(this.getTotalPriceIgnoreSelection(),this.getTotalPriceCurrency())),c(".symbol",i).html(this.getTotalPriceCurrency()),this.originPoolOrderView.totalPrice=this.getTotalPriceIgnoreSelection(),a=new n({container:t,orderId:this.uniqueId,sellerId:this.data.sellerId,items:this.getItems(),poolOrderData:this.originPoolOrderView})),c(window).on("resize",function(a){window.screen.width!==e.wWidth&&(e.wWidth=window.screen.width,c(".go-pool",i).hasClass("open-pool")&&(c(".go-pool",i).removeClass("open-pool"),t.hasClass("hidden")||t.addClass("hidden")))}),this.orderEl.delegate("click","#J_GoPool",function(e){var i=c(e.target).parent(".go-pool");i&&i.length&&(i.hasClass("open-pool")?(i.removeClass("open-pool"),t.hasClass("hidden")||t.addClass("hidden")):(i.addClass("open-pool"),t.hasClass("hidden")&&t.removeClass("hidden"),a&&a.getData()))})},_initBundles:function(){var t=this;e.each(this.data.bundles,function(e,i){var o=a.create({id:t.uniqueId+"_"+i,orderId:t.uniqueId,type:e.type||t.data.type,data:e,host:t.data.host,orderType:t.data.type,comboId:t.comboId,shopId:t.shopId,shopActId:t.shopActId,page:t.data.page});t.bundles[o.id]=o}),t.isAllSelected()&&t.isChecked(!0)},_initPromoHint:function(){var t=this;this.promoHintEls=c(".J_ScrollingPromoHint",this.orderEl),this.promoHintEls.length&&this.promoHintEls.each(function(i){new o(i,e.isFunction(t._promoHintCallback)?e.bind(t._promoHintCallback,t):void 0)})},_initCoupon:function(){var e=this;e.data.hasPriceVolume&&new r({orderEl:e.orderEl,sellerId:e.data.sellerId})},_initCheckbox:function(){var t=this;c(t.orderEl).delegate("click",".J_CheckBoxShop",function(e){e.preventDefault(),Global.resetTemp(),t.isChecked()?t.unselect():t.select(),Global.utils.makepoint("8.5")}),!e.isUndefined(t.isChecked())&&t.check(t.isChecked(),!1)},isChecked:function(e){return e+1&&(this.data.model.isChecked=e),this.data.model.isChecked},isAllSelected:function(){var t=!0;return e.each(this.bundles,function(i){e.each(i.items,function(e){if(e&&e.isValid&&"redemption"!==e.data.type&&!e.isSelected())return t=!1,!1})}),e.log("[Order] all bundles selected: "+t),t},check:function(t,i){if(this.checkTimer&&clearTimeout(this.checkTimer),t+1){e.log(d+"check status: "+t);var a=c(".J_CheckBoxShop",this.orderEl);a.prop("checked",t),this.data.isValid&&c(this.orderEl)[(t?"add":"remove")+"Class"]("all-select");var o=a.parent(".cart-checkbox");o&&o[(t?"add":"remove")+"Class"]("cart-checkbox-checked"),this.isChecked(t),t===!0&&e.each(this.bundles,function(e){e.isChecked(!0)}),Global.getCart().check(),this.data.groupId&&Global.cartGroups[this.data.groupId].check(),i!==!1&&Global.request({type:"check",orders:this}),Global.updateCart()}else{var r=this;r.checkTimer=setTimeout(function(){r.check(r.isAllSelected())},100)}},select:function(t){var i=!0;return this.data.isValid===!0?(e.each(this.bundles,function(t){if(e.each(t.items,function(e){if(e&&1===e.data.skuStatus)return i=!1,e.select(),!1}),i===!1)return!1}),i===!0&&(e.each(this.bundles,function(e){if(!e.select())return i=!1,!1}),this.check(i,t))):this.check(!1),i},unselect:function(){this.check(!1),e.each(this.bundles,function(e){e.unselect()})},getTotalPriceIgnoreSelection:function(){var t=0;return e.each(this.bundles,function(e){t+=e.getTotalPriceIgnoreSelection()}),t},getTotalPriceCurrency:function(){var t;return e.each(this.bundles,function(e){t=e.getPriceUnitFactor()}),t},getTotalPriceCurrency:function(){var t="";return e.each(this.bundles,function(e){t=e.getTotalPriceCurrency()}),t},getTotalPrice:function(){var t=0;return e.each(this.bundles,function(e){t+=e.getTotalPrice()}),t},remove:function(){var e=this.uniqueId;this.orderEl.remove(),c("#J_Order_"+e).remove(),this.data.groupId&&Global.cartGroups[this.data.groupId].removeOrder(this.data.id),this.destroy()},update:function(t){t=e.isUndefined(t)?-1:t;var i=e.bind(function(){e.isEmptyObject(this.bundles)?(e.log(d+"order empty, remove."),this.remove()):Global.getCart().orders[this.uniqueId]=this},this);this.updateTimer&&clearTimeout(this.updateTimer),t<0?i():this.updateTimer=setTimeout(i,t)},destroy:function(){e.each(this.bundles,function(e){e&&e.destroy&&e.destroy()}),Global.getCart().removeOrder(this.uniqueId),e.log(d+" order "+this.uniqueId+" destroyed."),Global.updateCart()},removeBundle:function(e){return delete this.bundles[e],this.update(),this},getItems:function(){var t=[];return e.each(this.bundles,function(i){e.each(i.items,function(e){e&&t.push(e)})}),t},getSelectedItemCartIds:function(){var t=[];return e.each(this.bundles,function(i){e.each(i.items,function(e){e&&e.isSelected()&&t.push(e.cartId)})}),t},mixData:function(t){var i=this;t.model=i.data.model,t.groupId=i.data.groupId,i.data=e.clone(t),i.data.bundles=[];var a=[];e.each(t.bundles,function(t){var o=t.id,r=i.bundles[o];if(r||e.each(t.orders,function(t){if(e.each(i.bundles,function(i){if(e.each(i.items,function(e,a){if(a===t.cartId)return r=i,o=i.id,!1}),r)return!1}),r)return!1}),r){r.mixData(t),r.data.items=[];var n=[];e.each(t.orders,function(t){var i=t.cartId,a=r.items[i];e.isUndefined(a)?n.push(t):null===a?r.items[i]={data:t}:a.mixData(t)});var s=!0;e.each(r.items,function(e,t){var i=e?e.data:{cartId:t,type:"deleted"};r.data.items.push(i),!e||i.isValid!==!0||i.model&&i.model.isSelected===!0||(s=!1)}),r.data.model&&s===!1&&(r.data.model.isChecked=!1),n.length&&(r.data.items=r.data.items.concat(n))}else a.push(t)});var o=!0;return e.each(i.bundles,function(e){var t=e.data;t.orders=t.items,delete t.items,i.data.bundles.push(t),e.isChecked()===!1&&(o=!1);i.allItemValid(t.orders)}),a.length&&(i.data.bundles=i.data.bundles.concat(a),o=!1),i.data.model&&o===!1&&(i.data.model.isChecked=!1),i.data},allItemValid:function(t){var i=!0;return e.each(t,function(e){e.isValid===!1&&(i=!1)}),i},getData:function(){var t=this,i=[];return e.each(t.bundles,function(e){i.push(e.getData())}),t.data.bundles=i,t.data},getItemByCartId:function(t){var i=this,a=!1;return e.each(i.bundles,function(e){if(a=e.getItemByCartId(t))return!1}),a},getOneCreateTime:function(){var t=this,i=0;return e.each(t.bundles,function(t){return e.each(t.items,function(e){if(e&&e.data&&e.data.createTime)return i=e.data.createTime,!1}),!1}),i},getNumOrPrice:function(e,t){if(!e)return"";var i=e.split(":");return t?"1"===i[1]?i[0]:"\u51cf"+Global.utils.toMoney(i[0])+"\u5143":"1"===i[1]?i[0]+"\u4ef6":Global.utils.toMoney(i[0])+"\u5143"},correct:function(){}}),l},{requires:["node","./orderTPL","../bundle/bundleFactory","./promoScroll/promoScroll","./coupon/coupon","./poolOrder/poolOrder","../group/orderGroup"]}),KISSY.add("cart/mods/order/comboDel/comboDel",function(e,t,i,a,o,r){function n(t){e.mix(this,t),this._init()}var s=t.all;return e.augment(n,{_init:function(){var e=this;s(e.orderEl).delegate("click",".J_ComboDel",function(t){t.preventDefault(),e._handle()})},_handle:function(){this._addHighlight(),a.confirm(r.lang("TIPS_CONFIRM_DELETE_PACKAGE"),r.lang("PROMPT_MESSAGE"),void 0,e.bind(this._delOrder,this),e.bind(this._removeHighlight,this))},_addHighlight:function(){this.highlight||(this.highlight=new i(this.order.orderEl.one(".order-content"))),this.highlight.add()},_removeHighlight:function(){this.highlight&&this.highlight.remove()},_delOrder:function(e){var t=this,i=t.order;e=e||i.getItems(),Global.request({type:"deleteSome",orders:i,operate:e,success:function(a){t._removeHighlight(),a.success&&(o.record(e),i.remove(),Global.updateCart())},error:function(){}})}}),n},{requires:["node","../../../utils/highlight/highlight","../../../utils/dialog/dialog","../../cart/undo/undo","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/order/comboOrder",function(e,t,i,a,o){function r(t){e.mix(this,t),this._init()}var n=t.all;return e.extend(r,a,{_init:function(){var e=this;this.data.comboHeight=99*this.data.bundles[0].orders.length-1,r.superclass._init.call(this),Global.lazyload(this.orderEl,function(){new o({order:this,orderEl:this.orderEl}),e._initComboOp()},this),setTimeout(function(){n(".combo-order-op",e.orderEl).height(n(".order-content",e.orderEl).height())},0)},_initComboOp:function(){var e=this;e.opEl=n(".J_ComboOp",e.content),e.orderEl.on("swipe",function(t){if("left"===t.direction&&t.distance>=100){n(".J_ComboOp").hide();var i=n(".order-content",e.orderEl).height();e.opEl.css({height:i,"line-height":i+"px"}).show()}}).on("click",function(e){var t=n(e.target);t.hasClass("J_ComboOp")&&t.parent(".J_ComboOp")||n(".item-operations").hide()})}}),r},{requires:["node","ua","./baseOrder","./comboDel/comboDel"]}),KISSY.add("cart/mods/order/crossShopPromo/crossShopPromo",function(e){function t(t){e.mix(this,t),this._init()}return e.augment(t,{_init:function(){var e=this;Global.listen("requestSuccess",function(t){var i=t[e.order.shopId];i&&e._updateSaveInfo(i)})},_updateSaveInfo:function(t){var i=this.order,a=i.orderEl,o=e.one("#J_SaveInfo_"+i.shopId);o&&(t?(o.html(t),a.show(),a.removeClass("hide-border")):(a.hide(),a.addClass("hide-border")))}}),t}),KISSY.add("cart/mods/order/crossShopOrder",function(e,t,i){function a(t){e.mix(this,t),this._init()}return e.extend(a,t,{_init:function(){a.superclass._init.call(this)},_promoHintCallback:function(){this.promoHintEls.each(function(e){e.parent(".act-promo").width(e.outerWidth())})}}),a},{requires:["./baseOrder","./crossShopPromo/crossShopPromo"]}),KISSY.add("cart/mods/order/redemption/list",function(e,t,i,a,o,r,n,s){function l(t){e.mix(this,t),this._init()}var c=t.all,d='<div class="redemption-carousel redemption-type-{{data.type}}"><div class="panels"><ul class="panel clearfix ks-switchable-content">{{#each data.realViewItems as curData}}<li class="redemption-item"><div class="item-wrapper"><div class="pic s100"><a href="{{curData.link}}" target="_blank"><img src="{{curData.img}}_80x80.jpg" /></a></div><div class="item-info"><p class="title"><a href="{{curData.link}}" target="_blank" title="{{curData.title}}">{{curData.shortTitle}}</a></p><p class="price"><span class="origin-price">&yen;<em>{{curData.originPrice}}</em></span><span class="promo-price">&yen;<em>{{curData.promoPrice}}</em></span></p><div class="btns"><a href="#" class="J_SelectSku select-sku" data-itemid="{{curData.itemId}}" data-url="{{curData.api}}"><span>{{#if data.type === "freegift"}}\u9886\u53d6\u8d60\u54c1{{#else}}'+n.lang("REDEEM")+'{{/if}}</span></a><div class="msg hidden-msg"><p class="error J_ErrorBox"></p></div></div></div></div></li>{{/each}}</ul></div></div>{{#if hasPages}}<div class="trigger-bar "><a href="javascript:void(0);" title="'+n.lang("PREV_PAGE")+'" class="prev">'+n.lang("PREV_PAGE")+'</a><a href="javascript:void(0);" title="'+n.lang("NEXT_PAGE")+'" class="next">'+n.lang("NEXT_PAGE")+"</a></div>{{/if}}",u="redemption-expanded",p="redemption-selected";return e.augment(l,{_init:function(){var t=this;t.trigger;e.mix(t,{isRendered:!1}),t.isRendered?c(t.container).parent().addClass(u):t._request()},_isRedemptionAble:function(){var e=this.rowBox.one(".J_Remain");return parseInt(e.text(),10)>0},_initPage:function(){var t=this;e.use("gallery/switchable/1.3.1/",function(e,i){var a=c(t.container).one(".redemption-carousel"),o=a.width(),r=a.one(".redemption-item"),n=r.outerWidth(),s=Math.floor(o/n),l=new i.Carousel(t.container,{effect:"scrollx",easing:"easeOutStrong",prevBtnCls:"prev",nextBtnCls:"next",disableBtnCls:"disable",circular:!0,viewSize:[o],steps:s});l.on("beforeSwitch",function(){c(t.container).parent().removeClass("sku-expanded").one(".J_SkuPanel").html("").hide()})})},_initSku:function(){var t=this,i="";c(t.container).delegate("click",".J_SelectSku",function(a){a.preventDefault();var n=c(a.currentTarget),s=n.attr("data-itemid"),l=c(this).parent();l.hasClass("sku-expanded")&&i===s?l.removeClass("sku-expanded").one(".J_SkuPanel").html("").hide():("freegift"!==t.type&&(l.addClass("sku-expanded").all(".redemption-item").removeClass(p),n.parent(".redemption-item").addClass(p)),t.sku=new r({container:l.one(".J_SkuPanel"),itemId:s,errorBox:"freegift"===t.type?n.parent().one(".J_ErrorBox"):"",itemType:t.type,cancel:function(){c(this.container).slideUp(.3,function(){l.removeClass("sku-expanded").all(".redemption-item").removeClass(p)})},autoHideError:"freegift"===t.type?3:0,hasAmount:"freegift"!==t.type,defaultAmount:"freegift"===t.type?1:0,rendered:function(){if(c(this.container).show(),6===o.ie){var e=c("li",this.container);setTimeout(function(){e.css("overflow","hidden")},10)}},addToCart:e.bind(t._addToCart,t)})),i=s})},_addToCart:function(e){var t=this;Global.request({type:"addExtraItem",operate:{quantity:e.quantity,cartId:0,skuId:e.outer_id,itemId:e.item_id,createTime:t.order.getOneCreateTime(),rwType:t.type},quantity:e.quantity,orders:t.order,skuid:e.outer_id,silent:!0,extraParams:{extSource:t.extSource},globalParams:{tpId:t.tpId},success:function(e){t.sku._hideErrorInfo()},error:function(e){t.sku._showErrorInfo(e.error.errorMessage)}})},_request:function(){var t=this,a=s.now();e.io({type:"get",url:Global.cfg.api.redemption,dataType:"json",data:{cartIds:t.order.getSelectedItemCartIds().join(","),ct:i.get("t")},success:function(i){try{s.retSuccess(Global.cfg.api.redemption,s.now()-a)}catch(o){}e.isPlainObject(i)&&i.status&&e.isArray(i.list)&&i.list.length&&(t._render(i.list[0]),t.extSource=i.extSource||"1")},error:function(e,t,i){s.retError(Global.cfg.api.redemption,s.now()-a,i)}})},_render:function(e){var t=this,i=t._formatData(e),o=i&&i.realViewItems&&i.realViewItems.length>4,r=a(d).render({data:i,hasPages:o});t.container.html(r).parent().addClass(u),t.isRendered=!0,o&&(t.container.addClass("multi-pages"),t._initPage()),t._initSku()},_formatData:function(t){return e.each(t.realViewItems,function(e){var t=e.title;e.shortTitle=t.length>10?t.substring(0,10)+"...":t,e.img=e.img.replace(/_(sum|\d{2,5}x\d{2,5})\.jpg$/,"")}),t}}),l},{requires:["node","cookie","gallery/template/1.0/","ua","../../../utils/sku/sku","../../../utils/i18n/i18n","../../global/retcode"]}),KISSY.add("cart/mods/order/redemption/redemption",function(e,t,i,a){function o(t){e.mix(this,t),this._init()}var r=t.all,n="lastRedemptionCartId";return e.augment(o,{_init:function(){this._initRedemptionList()},_initRedemptionList:function(){new a({trigger:this.trigger,isAutoRender:this._isContainLastedAddItem(),order:this.order,container:r(".J_RedemptionList",this.order.orderEl),type:this.type,tpId:this.tpId})},_isContainLastedAddItem:function(){return null},_scrollToLastedAddItem:function(e){i.scrollTop(i.offset(e).top),Cookie.remove(n)},_updateRedeemedQuantity:function(e,t){var i=e.one(".J_Remain"),a=e.one(".J_RedemptionList");i&&i.html(t),a&&a[t?"removeClass":"addClass"]("disabled")},_updateRedemptionAmount:function(e,t){var i=e.one(".J_TotalRedemptionAmount");i&&i.html(t)},_updateShopTotalPrice:function(e,t){var i=e.one(".J_TotalPrice");i&&i.html(t)},_updateRedemptionItemStatus:function(t){var i=this;e.each(t,function(e,t){var a=i.order.items[t];if(a){var o=a.itemEl;a.redemptionId=e.promoId,o[e.isValid?"removeClass":"addClass"]("disable")}})}}),o},{requires:["node","dom","./list"]}),KISSY.add("cart/mods/order/redemptionOrder",function(e,t,i,a,o,r){function n(t){e.mix(this,t),this._init()}var s=t.all,l="redemption-expanded";return e.extend(n,i,{_init:function(){var e=this;e.data.model=e.data.model||{},e.data.model.totalShopPrice=parseFloat(e.getTotalPriceFromData(e.data).price),e.data.model.unitFactor=e.getTotalPriceFromData(e.data).unitFactor,e.updateTotalPrice(),n.superclass._init.call(e),s(e.orderEl).delegate("click",".J_Redemption",function(t){t.preventDefault();var i=s(t.currentTarget),o=i.parent(".redemption-info");i.hasClass("entry-disabled")?(e.redemption=null,o.one(".J_RedemptionList").html("")):(o.hasClass(l)?o.removeClass(l+" sku-expanded"):e.redemption?o.addClass(l):e.redemption=new a({order:e,trigger:t.target,type:e.data.redemption.type,tpId:e.data.redemption.tpId}),Global.utils.makepoint("8.25"))})},getTotalPriceFromData:function(t){var i,a=0;return e.each(t.bundles,function(t){e.each(t.orders,function(e){try{i=e.price.currency.unitFactor}catch(t){i=100}e.model&&e.model.isSelected===!0&&!e.extraItemInfo&&(a+=e.price.sum)})}),{price:a,unitFactor:i}},updateTotalPrice:function(){var e=this;e.data.model.totalShopPriceStr=Global.utils.toMoney(e.data.model.totalShopPrice,e.data.model.unitFactor)},correct:function(){var e=this;e.isChecked()===!1&&(e.data.model.totalShopPrice=e.getTotalPrice(),e.updateTotalPrice(),r.dealRedemptionData(e.data),o.renderRedemption(e.data))}}),n},{requires:["node","./baseOrder","./redemption/redemption","./orderTPL","./orderData"]}),KISSY.add("cart/mods/order/orderFactory",function(e,t,i,a,o,r){return{create:function(n){var s,l;switch(n.shopId=0,n.comboId=0,n.shopActId=0,n.data.extraItems&&(n.data.type="redemption"),n.data.host&&Global.globalData&&Global.globalData[("B"===n.data.host?"b":"c")+"ShopsCount"]++,n.data=t.deal(n.data),n.data.type){case"combo":n.comboId=n.id,l=e.merge(n,{}),s=new a(l);break;case"act":n.shopActId=n.id,l=e.merge(n,{}),s=new o(l);break;case"redemption":n.shopId=n.id,l=e.merge(n,{}),s=new r(l);break;default:n.shopId=n.id,s=new i(n)}return s.level="order",s}}},{requires:["./orderData","./baseOrder","./comboOrder","./crossShopOrder","./redemptionOrder"]}),KISSY.add("cart/mods/cart/floatbar/totalpay",function(e,t,i){var a=t.all;return{calc:function(t,o,r,n){if(!e.isNumber(t)||t<0)return!1;var s=Global.utils.toMoney(t,o);return r='<span class="total-symbol">&nbsp;'+r+"</span>"||"",e.each([a("#J_SmallTotal"),a("#J_Total")],function(e){"Mixin"!=n?e.html(r+s):"J_Total"==e.attr("id")?e.html('<span id="J_multi_currency" class="multi-currency">'+i.lang("MULTI_CURRENCY")+"</span>"):e.html('<span class="multi-currency-small">'+i.lang("MULTI_CURRENCY")+"</span>")}),e.log("cal: "+s),!0}}},{requires:["node","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/select/select",function(e,t,i,a){var o=t.all,r="[Select] ",n="select-all-disabled",s="select-all-exceeded",l="selected",c="cart-checkbox-checked",d=!1;return{init:function(){return d===!0||(o("#J_Cart").delegate("click",".J_SelectAll",function(t){t.preventDefault(),Global.resetTemp();var c=o(t.currentTarget);switch(c.hasClass(n)?e.log(r+"cart empty."):c.hasClass(s)?i.show(a.lang("TIPS_CANNOT_SELECT_ALL_OVER_50"),{elCls:"select-all-tips",align:{node:c.one("span"),points:["tc","bl"],offset:[-23,-2]}}):Global[(c.hasClass(l)?"un":"")+"selectAll"](),parseInt(c.attr("id").replace("J_SelectAll",""),10)){case 1:Global.utils.makepoint("8.4");break;case 2:Global.utils.makepoint("8.24")}}),o(window).on("scroll",function(){i.hide()}),d=!0,Global.cfg.tpId&&setTimeout(Global.selectAll,0),!0)},update:function(t,i){var a=[o("#J_SelectAll1"),o("#J_SelectAll2")];e.each(a,function(e){e[(0===t.length?"add":"remove")+"Class"](n);var a=i.length===t.length&&t.length<=50&&t.length>0;e[(a?"add":"remove")+"Class"](l),o(".cart-checkbox",e)[(a?"add":"remove")+"Class"](c),o("input",e).prop("checked",a)})},toggle:function(t){if(t+1){var i=[o("#J_SelectAll1"),o("#J_SelectAll2")];e.each(i,function(e){e.removeClass(s+" "+n)[(t?"add":"remove")+"Class"](l)})}},destroy:function(){d=!1}}},{requires:["node","../../../utils/tip/tip","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/floatbar/tpl/floatbar.tpl",function(e,t,i,a,o,r,n,s){function l(t,i,a){e.use("gallery/switchable/1.3.1/",function(e,o){var r=e.mix({markupType:1,effect:"scrollx",easing:"easeOutStrong",circular:!1,prevBtnCls:"prev",nextBtnCls:"next",panelCls:"J_Item",disableBtnCls:"disable"},i);T=new o.Carousel(t,r),T.on("switch",function(e){Global.temp.floatbarCurIndex=e.currentIndex}),a&&a(T)})}var c="[Template FloatBar] ",d=t.all,u='<div class="float-bar-wrapper"><div id="J_SelectAll2" class="select-all select-all-disabled J_SelectAll"><div class="cart-checkbox"><input class="J_CheckBoxShop" id="J_SelectAllCbx2" type="checkbox" name="select-all" value="true" /><label for="J_SelectAllCbx2">'+s.lang("SELECT_ALL_ITEMS")+"</label></div>&nbsp;"+s.lang("SELECT_ALL")+'</div><div class="operations"><a href="#" hidefocus="true" class="J_DeleteSelected">'+s.lang("DELETE")+'</a><a href="#" hidefocus="true" class="J_ClearInvalid hidden">'+s.lang("CLEAR_INVALID")+'</a><a href="#" hidefocus="true" class="J_BatchFav">'+s.lang("FAV")+'</a><a href="#" hidefocus="true" class="J_BatchShare">'+s.lang("SHARE")+'</a></div><div class="float-bar-right"><div id="J_ShowSelectedItems" class="amount-sum"><span class="txt">'+s.lang("ITEM_NUM_SELECTED")+'</span><em id="J_SelectedItemsCount">0</em><span class="txt">'+s.lang("ITEM_UNIT")+'</span><div class="arrow-box"><span class="selected-items-arrow"></span><span class="arrow"></span></div></div><div id="J_CheckCOD" class="check-cod"><span class="icon-cod"></span><span class="s-checkbox J_CheckCOD"></span>'+s.lang("COD")+'</div><div class="pipe"></div><div class="price-sum"><span class="txt">'+s.lang("TOTAL_MONEY")+':</span><strong class="price"><em id="J_Total">0.00</em></strong></div><div class="btn-area"><a href="javascript:void(0)" id="J_Go" class="submit-btn submit-btn-disabled" aria-label="'+s.lang("TIPS_CHECKOUT")+'"><span>'+s.lang(Global.cfg.isYaoPartner?"SUBMIT_LIST":"CHECKOUT_BIG")+"</span><b></b></a></div></div></div>",p='<div id="J_SelectedItems" class="group-wrapper group-popup hidden"><div id="J_SelectedItemsList" class="group-content"></div><span class="arrow"></span></div>',m='{{#if item.isRedemption === true}}<span class="btn-cancel-select">'+s.lang("ITEM_REDEEMED")+'</span>{{#else}}<a href="javascript:void(0)" class="btn-cancel-select J_CancelSelect" data-index="{{index}}" data-cartid="{{item.cartId}}"{{#if item.comboId}} data-comboid="{{item.comboId}}"{{/if}}>'+s.lang("CANCEL_SELECTION")+"</a>{{/if}}",h='<div class="item-lists single-group carousel"><div class="trigger-bar {{#if showCarousel !== true}} hidden{{/if}}"><a href="javascript:void(0);" title="'+s.lang("PREV_PAGE")+'" class="prev">'+s.lang("PREV_PAGE")+'</a><a href="javascript:void(0);" title="'+s.lang("NEXT_PAGE")+'" class="next">'+s.lang("NEXT_PAGE")+'</a></div><div class="scrollable-content clearfix"><div class="ks-switchable-content">{{#each items as item index}}<div class="s-item J_Item"><a href="{{item.url}}" class="item-pic"><img src="{{item.data.pic}}_80x80.jpg" alt="{{item.title}}" /></a>'+m+"</div>{{/each}}</div></div></div>",f='<div class="group-top-title"><p>\u8bf7\u5206\u5f00\u7ed3\u7b97\u4ee5\u4e0b\u5546\u54c1</p><span id="J_group_close_btn" class="group-close-btn"></span></div><div class="groups-list {{#if !allExpand}}group-expand-one{{/if}}">{{#each groups as group}}<div id="J_Group_{{group.name}}" class="group group-{{group.name}} {{#if group.expand}} group-expanded {{/if}}" {{#if group.groupWrapperWidth}} style="width: {{group.groupWrapperWidth}}px"{{/if}}><div class="group-info"><div class="group-title"><span class="group-title-text" title="{{group.originTitle}}">{{group.title}}</span>&nbsp;(<em class="number">{{group.items.length}}</em>{{#if group.items.length > 1}}'+s.lang("ITEM_UNITS")+"{{#else}}"+s.lang("ITEM_UNIT")+'{{/if}})</div><div class="group-total price"><span class="price-prefix">\u5408\u8ba1(\u4e0d\u542b\u8fd0\u8d39)\uff1a</span><em><span class="price-currency">{{group.currency}}</span>&nbsp;{{group.totalStr}}</em></div><div class="group-op"><a href="javascript:void(0);" class="J_GroupOp J_GroupCheckout group-checkout">'+s.lang("CHECKOUT_SMALL")+'</a><a href="javascript:void(0);" class="J_GroupOp J_GroupExpand group-expand">'+s.lang("EXPAND")+'</a></div></div><div class="group-items {{#if group.useSlide}} carousel {{/if}}" {{#if group.itemsWidth}} style="width: {{group.itemsWidth}}px"{{/if}}>{{#if group.useSlide}}<span class="prev">'+s.lang("PREV_PAGE")+'</span><span class="next">'+s.lang("NEXT_PAGE")+'</span><div class="scroller"><div class="ks-switchable-content">{{/if}}{{#each group.items as item index}}<div class="g-item J_Item"><a href="{{item.url}}" class="item-pic"><img src="{{item.data.pic}}_80x80.jpg" alt="{{item.title}}" /></a>'+m+"</div>{{/each}}{{#if group.useSlide}}</div></div>{{/if}}</div></div>{{/each}}</div>",g=null,_=null,v=null,I=null,T=null;return{renderGroup:function(t){e.isArray(t)&&t.length>1?this.renderMultiGroups(t):this.renderSingleGroup(t[0].items)},renderSingleGroup:function(e){var t=d("#J_SelectedItemsList");v||(v=r(h));var i=7,a=e.length>i,o=n(v,{items:e,showCarousel:a});t.html(o),a?l(t.one(".item-lists"),{steps:i}):Global.temp.floatbarCurIndex=void 0},renderMultiGroups:function(t,i){var a=t.itemsByGroup;I||(I=r(f));var s=7,u=t.items.length<s;if(!i){var p=0;e.each(a,function(e){e.items.length>p&&(p=e.items.length,i=e.name)})}e.each(a,function(t){t.totalStr=parseFloat(t.total/(t.unitFactor||100)).toFixed(2),t.expand=!0,t.useSlide=t.items.length>s,t.itemsWidth=0,t.groupWrapperWidth=0,t.expand===!0&&o.ie<8&&(e.log(c+" group "+t.name+" expand"),t.itemsWidth=90*t.items.length,t.groupWrapperWidth=t.itemsWidth+42)});var m=n(I,{groups:a,allExpand:u}),h=d("#J_SelectedItemsList").html(m);e.each(h.all(".group-expanded"),function(t){var i=d(t),r=i.attr("id").replace("J_Group_",""),n=i.one(".group-items"),u=n.one(".g-item"),p=s*u.outerWidth();e.log(c+"fix group "+r+" width"),n.width(p),o.ie<8&&i.width(p+42),a[r].items.length>s?l(n,{steps:s,viewSize:[p]}):Global.temp.floatbarCurIndex=void 0}),6===o.ie&&setTimeout(function(){d(".group-info",h).hide().show()},100)},render:function(){var e=d("#J_FloatBar");return g=g||r(u),_=_||r(p),e.html(n(g,{})).prepend(d(n(_))),e},removeItem:function(e,t){T?T.remove({index:e,callback:t}):t&&t()}}},{requires:["node","dom","event","ua","gallery/template/1.0/","../../../../utils/tpl/render","../../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/floatbar/delete",function(e,t,i,a,o){var r=(t.all,"[BatchDel] ");return{batchDel:function(t,i){var o=[];e.each(t,function(t){if(t){var i=t.getOrder(),a=t.data.extInfo;i.extInfo=a,e.inArray(i,o)||o.push(i)}}),Global.request({type:"deleteSome",operate:t,orders:o,success:function(o){e.log(r+" result: "+o.success),i!==!0&&a.record(t),e.each(t,function(e){e&&e.remove()})}})},deleteSelected:function(t){var a=this;if(!t.length)return i.alert(o.lang("TIPS_PLEASE_SELECT_ITEM")),!1;var r=null,n=null,s=o.lang("TIPS_CONFIRM_DELETE_ITEMS"),l=o.lang("DELETE_ITEM");return e.each(t,function(e){var t=e.data.extInfo;"1"===t.isPriorityBuy?r=e:n=e}),r&&(s=r.data.extInfo.yxgDelText,l=r.data.extInfo.yxgDelTitle),i.confirm(s,l,void 0,function(){a.batchDel(t)}),!0},clearInvalid:function(e){var t=this;return e.length?(i.confirm(o.lang("TIPS_CONFIRM_CLEAR_INVALID"),o.lang("DELETE_ITEM"),void 0,function(){t.batchDel(e)}),!0):(i.alert(o.lang("TIPS_NO_INVALID_ITEM")),!1)}}},{requires:["node","../../../utils/dialog/dialog","../undo/undo","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/floatbar/go",function(e,t,i,a){function o(i){var o=i.params||{},r=t.create("<form>"),n=i.api||u.normal;r.method=i.submitType||"post",r.action=n+"?spm="+d;for(var l in o){var c=t.create("<input>");c.name=l,c.value=o[l],r.appendChild(c)}t.hide(r),document.body.appendChild(r);var p="";switch(n){case u.HK:p=s.tmallIntlLoginAPI;
break;case u.yiyao:p=s.tmallYiYaoLoginAPI;break;case u.yiyaoZY:p=s.tmallYiYaoZYLoginAPI;break;case u.tmall:p=s.tmallBuyLoginAPI;break;case u.tmallOld:p=s.tmallStayBuyLoginAPI}if(p){p+="?from=cart";var m=a.now();e.getScript(p,{success:function(){try{a.retSuccess(p,a.now()-m)}catch(e){}r.submit()},error:function(){try{a.retError(p,a.now()-m,"\u767b\u9646\u9a8c\u8bc1\u5f02\u5e38")}catch(e){}r.action=u.normal,r.submit()},timeout:10})}else r.submit()}function r(t){var a=[],o=[],r={},n={};e.each(t.items,function(e){var t=e.data,i=t.cartId,s=t.attr||"",l=s?"":";";t.extraItemInfo&&t.extraItemInfo.promotionIdVal&&(s+=l+"promotionIdVal:"+t.extraItemInfo.promotionIdVal+";"),a.push({cartId:i,itemId:t.itemId,skuId:t.skuId,quantity:e.getQuantity(),createTime:t.createTime,attr:s}),o.push(i),r[t.sellerId]=1;var c=e.getOrder();!c||"combo"!==c.type||c.isChecked()&&c.data.isValid||(n[t.cartId]=1)});var s=[];e.each(r,function(e,t){s.push(t)});var l=[];for(var c in n)l.push(c);var d={hex:"n",cartId:o,sellerid:s.join(","),cart_param:i.stringify({items:a}),unbalance:t.unbalance||"",delCartIds:o.concat(l).join(","),use_cod:t.isCod===!0||e.isUndefined(t.isCod)&&"cod"===t.group?1:"false",buyer_from:"cart",page_from:"cart"};return Global.cfg.tpId&&(d.tpId=Global.cfg.tpId),{params:d,api:u.tmall}}function n(t){var a=[],o=[],r=[],n=[],s=[],l=[],c=[],d="",p=[],m=[],h=[];e.each(t.items,function(o){if(o){var u=o.data;switch(u.type){case"redemption":var f=[u.cartId,u.itemId,o.getQuantity(),u.skuId,u.extraItemInfo.promotionIdVal];u.cartActiveInfo&&u.cartActiveInfo.cartBcParams&&f.push(u.cartActiveInfo.cartBcParams),f.push(u.extraItemInfo.type),n.push(f.join("|"));break;default:var g=[u.cartId,u.itemId,o.getQuantity(),u.skuId,u.sellerId,o.attrs&&o.attrs.cbid||0,o.getAttr("cbopt")||0,u.tbComboId||0,u.cartActiveInfo&&u.cartActiveInfo.cartBcParams?u.cartActiveInfo.cartBcParams:"",u.toBuyInfo&&!e.isEmptyObject(u.toBuyInfo)?encodeURIComponent(i.stringify(u.toBuyInfo)):"",Global.cfg.isCuntaoPartner?o.getAttr("ctCartId")||0:0];a.push(g.join("_")),l.push(u.cartId),u.isCod&&c.push(u.cartId),u.verticalParam&&s.push(u.cartId+"|"+u.verticalParam);var _=o.getAttr("ck");(_||u.services)&&p.push(u.cartId);var v=o.getAttr("from");v&&r.push(u.cartId),u.flushingPicId&&m.push(u.flushingPicId)}""===d&&(d=t.group||o.group);var I=o.getAttr("lottery");I&&h.push(u.cartId+":"+I)}});var f={},g="post",_=u.normal;switch(d.substr(0,2)){case"HK":f={cartId:l.join(",")};break;default:f={item:a.join(","),buyer_from:t.buyer_from||"cart"},o.length&&(f.channelInfo=o.join(",")),r.length&&(f.cnData=r.join(",")),n.length&&(f.premium_item=n.join(",")),c.length&&(t.isCod===!0||e.isUndefined(t.isCod)&&"cod"===t.group)&&(f.use_cod=1),s.length&&(f.verticalParams=s.join(",")),m.length&&(f.flushingPictureServiceId=m.join("|")),p.length&&(f.serviceCartIds=p.join(":")),h.length&&(f.awardIds=h.join(","))}return{params:f,api:_,submitType:g}}var s=Global.cfg.api,l="a1z0d.6639537.0.0."+window.g_aplus_pv_id,c="a220l.18.0.0."+window.g_aplus_pv_id,d=window.location.href.indexOf("cart.tmall.com")>-1?c:l,u={normal:s.goAPI,HK:s.tmallIntlBuyAPI,tmall:s.tmallBuyAPI||"//buy.tmall.com/order/confirm_order.htm",tmallOld:s.tmallStayBuyAPI||"//stay.buy.tmall.com/order/confirm_order.htm",yiyao:s.tmallYiYaoBuyAPI||"//buy.tmall.com/order/confirm_order.htm",yiyaoZY:s.tmallYiYaoZYBuyAPI||"//buy.tmall.com/order/confirm_order.htm",aliTrip:s.tripBuyAPI||"//tripbuy.alitrip.com/order/confirmOrder.htm"};return{go:function(t){var i,a={},s={toTmallOldCount:0,toTmallCount:0,toBuyCount:0,toYiYaoCount:0,toYYZYCount:0,toTmallHKCount:0,toAliTripCount:0,toNewGroupCount:0},l=Global.globalData.isTmallIntBuySwitchToCom,c=!1;e.each(t.items,function(e){if(e.data.isDutyFree&&(c=!0),e&&e.data)switch(e.groupTitle?(e.data.toBuy=e.group,a={toBuy:e.group,title:e.groupTitle,url:e.groupToBuy}):"HK"===e.data.host||e.data.host.indexOf("HKGS")!=-1?e.data.toBuy="HK":"YY"===e.data.host?e.data.toBuy="YY":"YYZY"===e.data.host?e.data.toBuy="YYZY":"ALITRIP"===e.data.host&&(e.data.toBuy="ALITRIP"),e.data.toBuy){case"noGray":s.toTmallOldCount++;break;case"tmall":s.toTmallCount++;break;case"YY":s.toYiYaoCount++;break;case"HK":s.toTmallHKCount++;break;case"YYZY":s.toYYZYCount++;break;case"ALITRIP":s.toAliTripCount++;break;case a.toBuy:s.toNewGroupCount++;break;default:s.toBuyCount++}});var d="taobao";if(0===s.toBuyCount&&(s.toNewGroupCount>0?d=a.group:s.toTmallOldCount>0&&0===s.toTmallCount?d="tmallOld":0===s.toTmallOldCount&&s.toTmallCount>0?d="tmall":s.toYiYaoCount>0?d="YY":s.toYYZYCount>0?d="YYZY":s.toAliTripCount>0&&(d="ALITRIP"),s.toTmallHKCount>0&&(s.toTmallOldCount>0||s.toTmallCount>0)?d="tmall":s.toTmallHKCount>0&&0===s.toTmallOldCount&&0===s.toTmallCount&&(c?d="tmallHK":l?d="tmall":l||(d="tmallHK"),c=!1),s.toTmallHKCount>0&&(s.toYiYaoCount>0||s.toYYZYCount>0)&&(d="tmall"),s.toYiYaoCount>0&&s.toYYZYCount>0&&(d="tmall")),"taobao"!==d)try{i=r(t),"tmallOld"===d?i.api=u.tmallOld:"YY"===d?i.api=u.yiyao:"YYZY"===d?i.api=u.yiyaoZY:"tmallHK"===d?(i.params.tmallhk=!0,i.api=u.HK):"ALITRIP"===d?i.api=u.aliTrip:d===a.toBuy&&(i.api=a.url||u.normal)}catch(p){i=null;var m="tmall order data error || fatal";Global.utils.logger("go","error",m)}i||(i=n(t)),i.params&&t.sourceTime&&(i.params.source_time=t.sourceTime),o(i)}}},{requires:["dom","json","../../global/retcode"]}),KISSY.add("cart/mods/cart/floatbar/batch-fav",function(e,t,i,a,o,r,n,s){var l="[batch-fav] ";return{favTriggerEl:null,batchFav:function(t,i,a){var o=this;if(0===t.length)r.alert(n.lang("TIPS_PLEASE_SELECT_ITEM"));else{var s,l,c=!1;e.each(t,function(e){var t=e.data.extInfo;"1"===t.isPriorityBuy?s=e:l=e}),s&&s.data.extInfo.yxgAddFavorText&&(c=!0),c?r.confirm(s.data.extInfo.yxgAddFavorText,s.data.extInfo.yxgAddFavorTitle,void 0,function(){o._sendFavRequest(t,i,a)}):o._sendFavRequest(t,i,a)}},_sendFavRequest:function(i,o,r){var n=this,c=[];n.favTriggerEl=o,e.each(i,function(e){e&&c.push(e.itemId+":"+e.getSkuId())});var d={itemSkuList:c.join(","),_tb_token_:t.val("#_tb_token_")},u=s.now();a({url:Global.cfg.api.favorite,data:d,dataType:"jsonp",success:function(t){e.isObject(t)&&(t.result&&(e.log(l+" result: "+t.result.status),o&&n._showTips(i,t.result.status,t.result.message)),r&&r()),s.retSuccess(Global.cfg.api.favorite,s.now()-u)},error:function(e,t,i){s.retError(Global.cfg.api.favorite,s.now()-u,i)}})},_showTips:function(i,a,r){t.remove("#fav-lay-prefix-batch");var s,l=this,c=t.create('<div id="fav-lay-prefix-batch" class="batch-fav-box"></div>');s=a?t.create('<div class="msg batch-fav-status"><p class="ok">'+n.lang("TIPS_SUCCESS_FAV")+"</p></div>"):8===r.errorCode?t.create('<div class="msg batch-fav-status"><p class="attention">'+r.error+"</p></div>"):t.create('<div class="msg batch-fav-status"><p class="error">'+r.error+"</p></div>"),c.appendChild(s),t.insertAfter(c,l.favTriggerEl),a&&o.batchDel(i,!0),e.later(function(){t.remove(c)},2e3)}}},{requires:["dom","event","ajax","./delete","../../../utils/dialog/dialog","../../../utils/i18n/i18n","../../global/retcode"]}),KISSY.add("cart/mods/cart/floatbar/share",function(e,t,i,a){return{share:function(t){var o=[];e.each(t,function(e){e&&o.push(e.itemId)}),o.length?e.getScript("//g.alicdn.com/tb/snsdk/0.0.9/core.min.js",function(){SNS.login(function(){SNS.ui("batchshare",{itemIds:o,client_id:"77",callback:{init:function(){},success:function(e){},failure:function(e){}}})})}):i.alert(a.lang("TIPS_NO_SELECTION"))}}},{requires:["node","../../../utils/dialog/dialog","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/floatbar/batch-compare",function(e,t,i){function a(e,t,i){var a="//pk"+Global.utils.tbPath+"/index.htm?items=";e.attr("href",t?a+t:"javascript:void(0)").attr("data-tips",i||"")}t.all;return{update:function(t,o){var r=[];o.length>8?a(t,"",i.lang("TIPS_COMPARE_MAX_LIMIT",{num:o.length})):o.length<2?a(t,"",i.lang("TIPS_COMPARE_SELECT_AT_LEAST_TWO_ITEMS")):(e.each(o,function(e){var t=e.data;r.push(t.itemId+"_"+t.skuId+"_"+t.cartId)}),a(t,r.join(",")))}}},{requires:["node","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/floatbar/floatbar",function(e,t,i,a,o,r,n,s,l,c,d,u,p,m,h,f,g){var _,v,I,T=t.all,S=Global.cfg.isYaoPartner,b="[FloatBar] ",E=!1,C=function(){var e=a.viewportHeight(),t=a.scrollTop(),i=a.offset(v).top,o=i-e-t;o>=0?(_.replaceClass("default","fixed-bottom"),_.css("position","fixed"),a.insertAfter(_,v)):(_.replaceClass("fixed-bottom","default"),_.css("position","static"),a.append(_,v))},y=function(){if(E===!1||6===i.ie)return!1;var e=T(v).offset();return e?(I=e.top,C()):void 0};return{init:function(){if(E===!0)return!1;_=T("#J_FloatBar"),v=T("#J_FloatBarHolder");var t=this;return t.floatbarEl=r.render(),t.popupEl=T("#J_SelectedItems",t.floatbarEl),t.selectedItemsCountEl=T("#J_SelectedItemsCount",t.floatbarEl),t.selectedItemsUnitCountEl=t.selectedItemsCountEl.next(".txt"),t.showSelectedItemsEl=T("#J_ShowSelectedItems",t.floatbarEl),t.goEl=T("#J_Go",t.floatbarEl),t.smallGoEl=T("#J_SmallSubmit"),t.checkCodEl=T("#J_CheckCOD",t.floatbarEl),t.popupArrowEl=T(".arrow",t.popupEl),t.floatbarArrowEl=T(".arrow",t.showSelectedItemsEl),t.clearInvalidEl=T(".J_ClearInvalid",t.floatbarEl),Global.listen("G_ShowClearInvalid",function(){t.clearInvalidEl.show()}),S&&h.initItemMutex(Global.getCart().orders),t.showSelectedItemsEl.on("click",function(e){e.preventDefault(),t.togglePopup(),t.update(Global.getCart().getSelectedItemsAndGroups(),!0),Global.utils.makepoint("8.22")}),T(document).delegate("click","#J_group_close_btn",function(){t.hidePopup()}),T(document).delegate("click","#J_multi_currency",function(){t.showPopup()}),T(document).delegate("click",".submit-btn",function(i){i.preventDefault();var a=T(i.currentTarget);if(a.hasClass("submit-btn-disabled"))return void p.show(g.lang("TIPS_PLEASE_SELECT_ITEM_NEED_TO_CHECKOUT"),{align:{node:a,points:["tl","bl"]},elCls:"submit-tips"});if(a.hasClass("combine-not-supported")||a.hasClass("need-separate"))return void t.showPopup();var o={items:Global.getCart().getSelectedItems(),isCod:t.checkCodEl.one(".J_CheckCOD").hasClass("s-checkbox-selected"),sourceTime:e.now()};switch(S&&(h.checkIsCod(Global.getCart().getSelectedItems())||(o.isCod=0)),a.attr("id")){case"J_Go":Global.utils.makepoint("8.2");break;case"J_SmallSubmit":Global.utils.makepoint("8.1")}return o.items&&o.items.length?void l.go(o):(m.alert(g.lang("TIPS_PLEASE_SELECT_ITEM")),!1)}),T(t.floatbarEl).delegate("click",".J_CheckCOD",function(e){e.preventDefault(),T(e.target).toggleClass("s-checkbox-selected"),t.update(Global.getCart().getSelectedItemsAndGroups()),Global.utils.makepoint("8.21")}).delegate("click",".J_ClearInvalid",function(e){e.preventDefault(),s.clearInvalid(Global.getCart().getTruelyInvalidItems()),Global.utils.makepoint("8.18")}).delegate("click",".J_DeleteSelected",function(e){e.preventDefault(),s.deleteSelected(Global.getCart().getSelectedItems()),Global.utils.makepoint("8.17")}).delegate("click",".J_BatchFav",function(e){e.preventDefault();for(var t=Global.getCart().getSelectedItems(),i=!1,a="",o=0,r=t.length;o<r;o++){var n=t[o];if(i=n.data.isPreSell){a=n.data.extInfo&&n.data.extInfo.cannotAdd2FavoritesTipsOfPreSell;break}}i?m.alert(a):(c.batchFav(Global.getCart().getSelectedItems(),T(e.currentTarget)),Global.utils.makepoint("8.20"))}).delegate("click",".J_CancelSelect",function(e){e.preventDefault();var i=T(e.currentTarget),a=i.attr("data-comboid");if(a){var o=Global.getCart().getOrderById(a);o&&o.unselect()}else{var r=i.attr("data-cartid"),n=Global.getCart().getItemByCartId(r);n&&n.unselect()}t.floatbarEl.data("carousel-index",i.attr("data-index")),t.update(Global.getCart().getSelectedItemsAndGroups()),Global.utils.makepoint("8.23")}).delegate("click",".J_BatchShare",function(e){e.preventDefault(),d.share(Global.getCart().getSelectedItems()),Global.utils.makepoint("8.19")}).delegate("click",".J_BatchCompare",function(e){var t=T(e.currentTarget),i=t.attr("data-tips");i&&(e.preventDefault(),p.show(i,{align:{node:t,points:["tl","bl"],offset:[-20,10]},elCls:"submit-tips"}))}),6===i.ie?t.floatbarEl.delegate("mouseenter mouseleave",".J_Item",function(e){e.stopPropagation(),T(e.currentTarget).toggleClass("item-hover")}):e.ready(function(){var e=_.offset();e&&(I=e.top),T(window).on("scroll",function(){C(),t.hidePopup()},this),C()}),E=!0,!0},relocate:y,showPopup:function(){var e=this;if(e.isPopupOpened===!0)return!0;e.floatbarEl.addClass("show-selected-items"),e.popupEl.show(),e.isPopupOpened=!0;var t=f(g.lang("NEED_SEPARATE_CHECKOUT"));return e.goEl.addClass("combine-not-supported").one("span").html(t),6===i.ie&&setTimeout(function(){T(".group-info",e.popupEl).hide().show()},100),!0},hidePopup:function(){var e=this;return e.isPopupOpened!==!1&&(e.floatbarEl.removeClass("show-selected-items"),e.popupEl.hide(),e.isPopupOpened=!1,e.goEl.removeClass("combine-not-supported").one("span").html(f(g.lang(S?"SUBMIT_LIST":"CHECKOUT_BIG"))),!1)},togglePopup:function(){return this[(this.isPopupOpen()?"hide":"show")+"Popup"]()},isPopupOpen:function(){return this.isPopupOpened},update:function(t,i){if(E===!1)return e.log(b+"it will not be updated cause it is no inited."),!1;var a=this,o=t.items,n=t.groups,s=o.length,l=t.itemsByGroup,c=a.goEl,d=a.smallGoEl,u=a.floatbarEl,p=a.checkCodEl,m=a.isPopupOpen(),_=e.inArray("cod",n),v=f(g.lang(S?"SUBMIT_LIST":"CHECKOUT_BIG")),I=f(g.lang("COMBINE_NOT_SUPPORTED"));_?p.show():p.hide().one(".J_CheckCOD").removeClass("s-checkbox-selected"),S&&(p.hide(),p.one(".J_CheckCOD").addClass("s-checkbox-selected")),a.selectedItemsCountEl.html(s),a.selectedItemsUnitCountEl.html(g.lang("ITEM_UNIT"+(s>1?"S":"")));var C=T("#J_SelectedItemsList").empty().html("");if(!S||!h.checkRx(o)){if(Global.cfg.isCuntaoPartner){var P=e.some(o,function(t){var i=0;return e.each(t.data.villagers,function(e){i+=e.quantity}),!t.data.isPreSell&&i!==t.data.amount.now});P&&(o=[])}if(t.showTaxText?(T(".price-sum .txt",a.floatbarEl).html(g.lang("TOTAL_MONEY_NO_TAX")+"\uff1a"),T(".cart-sum .pay-text").html(g.lang("SELECTED_ITEMS_NO_TAX"))):(T(".price-sum .txt",a.floatbarEl).html(g.lang("TOTAL_MONEY")+"\uff1a"),T(".cart-sum .pay-text").html(g.lang("SELECTED_ITEMS"))),!(o.length>0))return c.addClass("submit-btn-disabled").removeClass("combine-not-supported").one("span").html(v),d.addClass("submit-btn-disabled").removeClass("combine-not-supported").html(v),u.removeClass("has-items"),a.hidePopup(),!0;c.removeClass("submit-btn-disabled"),d.removeClass("submit-btn-disabled"),u.addClass("has-items");var A=!1;if(n.length>1){var O=!0,k=m;if(_){var L=p.one(".s-checkbox").hasClass("s-checkbox-selected");L?(m||(k=!0),A=!0):2==n.length?e.inArray("normal",n)?O=!m&&null:(l.normal=l.cod,l.normal.title=g.lang("NORMAL_ITEMS"),l.normal.name="normal",delete l.cod,A=!0,k=!0):e.inArray("normal",n)?(k=!0,e.each(l.cod.items,function(e){e&&l.normal.items.push(e)}),l.normal.total+=l.cod.total,delete l.cod,A=!0):(l.normal=l.cod,l.normal.title=g.lang("NORMAL_ITEMS"),l.normal.name="normal",delete l.cod,A=!0,k=!0)}else A=!0,m||(k=!0);O===!0?(r.renderMultiGroups(t),a.selectedItems=t,C.delegate("click",".J_GroupOp",a.groupEvent,a),!i&&k&&a.showPopup()):O===!1&&r.renderSingleGroup(o)}else m&&r.renderSingleGroup(o);return A?(c.addClass("combine-not-supported").addClass("need-separate").one("span").html(I),d.addClass("combine-not-supported").html(I)):(c.removeClass("combine-not-supported").removeClass("need-separate").one("span").html(v),d.removeClass("combine-not-supported").html(v)),y(),!0}},groupEvent:function(e){e.preventDefault();var t=this,i=T(e.target),a=i.parent(".group"),o=a.attr("id").replace("J_Group_","");i.hasClass("J_GroupCheckout")?(l.go({items:t.selectedItems.itemsByGroup[o].items,group:o}),Global.utils.makepoint("8.3")):i.hasClass("J_GroupExpand")&&(Global.resetTemp(),r.renderMultiGroups(t.selectedItems,o))},destroy:function(){E=!1}}},{requires:["node","ua","dom","event","./tpl/floatbar.tpl","../select/select","./delete","./go","./batch-fav","./share","./batch-compare","../../../utils/tip/tip","../../../utils/dialog/dialog","../../global/yao-qrcode/yao-qrcode","../../../utils/tpl/render","../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/filterbar/status-bar",function(e,t,i,a){var o=t.all,r="status-disabled",n=o("#J_StatusBar");return{init:function(){},update:function(e){},disable:function(){n.html("").addClass(r)}}},{requires:["node","gallery/template/1.0/","../../../utils/tpl/render"]}),KISSY.add("cart/utils/url/url",function(e){return{add:function(e,t){var i=this.remove(e),a="",o=i;return i.indexOf("#")>0&&(a=i.slice(i.indexOf("#")),o=i.slice(0,i.indexOf("#"))),o+(t?(o.indexOf("?")>-1?"&":"?")+e+"="+t:"")+a},remove:function(e){for(var t="",i=location.href,a=0;a<e.length;a++){var o=e.substring(a,a+1);t+=/[A-Z]/.test(o)&&0!==a?"_"+o.toLowerCase():o}if(t){var r=new RegExp("[?&]?"+t+"=[^#&]+");i=i.replace(r,"")}i=i.replace(/[<>'"\s]/g,"");var n=new RegExp("[?&]?"+e+"=[^#&]+");return i.replace(n,"").replace(/#\.?$/,"")}}}),KISSY.add("cart/mods/cart/filterbar/switchMap",function(e,t){return{totleCount:{status:0,name:t.lang("TAB_ALL_ITEMS"),makepoint:"8.35"},villagerViewCartsCount:{status:5,name:t.lang("TAB_VILLAGER_STOCK"),makepoint:"8.37",enableAlways:!0},promotionCount:{status:2,name:t.lang("TAB_DISCOUNT_ITEMS"),makepoint:"8.34"},quailtyTenseCount:{status:4,name:t.lang("TAB_LOW_STOCK"),makepoint:"8.36"}}},{requires:["../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/filterbar/switchTPL",function(e,t,i,a,o){function r(e){return'<li class="btn-switch-cart switch-cart-'+e.type+" "+e._class+'"><a href="'+e.url+'" class="J_MakePoint" data-point="tbcart.'+e.makepoint+'"><em>'+e.name+'</em><span class="number">'+e.value+'</span><span class="pipe"></span></a></li>'}var n=t.all;return{generate:function(t){var n="";return e.each(a,function(e,a){if(5!==e.status||Global.cfg.enableVillagerView){var o="",s=0===e.status?i.remove("extStatus"):i.add("extStatus",e.status);e.status===Global.cfg.type?o="current":e.status>0&&0===t[a]&&!e.enableAlways&&(o="disabled",s="javascript: void(0);"),n+=r({type:e.status,name:e.name,url:s,value:t[a]>0?t[a]:0,_class:o,makepoint:e.makepoint})}}),o(n)},render:function(e){return n(this.generate(e))}}},{requires:["node","../../../utils/url/url","./switchMap","../../../utils/tpl/render"]}),KISSY.add("cart/mods/cart/filterbar/switch-effect",function(e,t){var i=t.all,a=!1;return{init:function(e){if(a!==!0){var t=e.siblings(".wrap-line"),o=t.all(".floater"),r=i(".current",e),n=null,s=r.outerWidth()-1,l=0;o.width(s);try{l=r.offset().left-e.offset().left}catch(c){l=0}o.css("left",l),e.delegate("mouseenter","li.btn-switch-cart",function(t){n&&n.stop(!0);var a=i(t.currentTarget);try{var r=a.offset().left-e.offset().left;o.animate({left:r,width:a.outerWidth()-1},{easing:"easeIn",duration:.2})}catch(s){}}),e.on("mouseleave",function(e){n&&n.stop(!0),n=o.animate({left:l,width:s},{easing:"easeIn",duration:.2})}),a=!0}}}},{requires:["node"]}),KISSY.add("cart/mods/cart/filterbar/switch-cart",function(e,t,i,a,o,r,n){var s,l,c=i.all;return{init:function(){return s?s:(s=c("#J_CartSwitch").delegate("click",".J_SwitchCart",function(e){e.halt();var t=c(e.currentTarget);t.hasClass("disabled")||(location.href=o.add("extStatus",t.attr("data-type")))}),!0)},request:function(t){var i=this;a.jsonp("json/asyncGetMiniCount.do",{t:e.now},function(a){a=a||{},t&&e.mix(a,t),i.render(a)})},render:function(e){s.html(r.generate(e)),n.init(c("#J_CartSwitch"))},update:function(e){var t=this;t.init()===!0;s&&t.render({promotionCount:Global.promotionCount,quailtyTenseCount:Global.stockTenseCount,villagerViewCartsCount:Global.villagerViewCartsCount,totleCount:Global.totalSize})},back:function(e){var t=this;t.init(),l=null,s.html('<a href="cart.htm" class="J_SwitchCart btn-switch-cart J_MakePoint" data-point="tbcart.8.35"><span class="txt"><i class="lt">&lt;&lt;</i>\u8fd4\u56de\u5168\u90e8\u5546\u54c1</span></a> '+e)},to:function(e){switch(e){case"promo":e=1;break;default:e=0}window.location.href=o.add("extStatus",e)}}},{requires:["dom","node","ajax","../../../utils/url/url","./switchTPL","./switch-effect"]}),KISSY.add("cart/mods/global/config",function(e,t){var i;return{init:function(e){i?e&&e(i):new t({url:"//www.taobao.com/go/rgn/cart/config.php",dataType:"jsonp",type:"get",success:function(t){i=t,e&&e(t)},error:function(){e&&e({})}})},get:function(e,t){this.init(function(i){var a={};i&&i[e]&&(a=i[e]),t&&t(a)})}}},{requires:["ajax"]}),KISSY.add("cart/mods/global/plugin",function(e,t,i){var a="[plugin] ",o=[];return{init:function(r){i.get("plugins",function(i){if(i&&i.list&&!e.isEmptyObject(i.list)){var n=i.version||Global.cfg.version;e.config({packages:{plugin:{base:Global.cfg.guiServer+"/tp/cart/"+n+"/",charset:"gbk"}}}),e.each(i.list,function(i,n){var s=a+"["+n+"] ",l=e.now();if(!e.isUndefined(i.startTime)&&l<i.startTime&&(e.log(s+"time < start time, exit;"),i.on=!1),!e.isUndefined(i.endTime)&&l>i.endTime&&(e.log(s+"time > start time, exit;"),i.on=!1),i.mobile===!1&&t.mobile&&(e.log(s+" disabled on mobile devices, exit;"),i.on=!1),i.on!==!1){var c=function(){e.use("plugin/"+n+"/"+n,function(e,t){t&&t.init&&(t.init(i,r),o.push(t),e.log(a+n+" inited."))})};i.version?e.getScript(Global.cfg.guiServer+"/tp/cart/"+i.version+"/plugin/"+n+"/"+n+".js",{success:c}):c()}})}})},update:function(t){o.length&&e.each(o,function(e){e&&e.update&&e.update(t)})},destroy:function(t){o.length&&e.each(o,function(e){e&&e.destroy&&e.destroy(t)})}}},{requires:["ua","./config"]}),KISSY.add("cart/mods/global/footer/footer",function(e,t,i){var a=t.all;return{inited:!1,init:function(){var e=this;e.inited!==!0&&(e.inited=!0,a("#footer").show())}}},{requires:["node","ajax"]}),KISSY.add("cart/mods/global/scrollToCartId",function(e,t){var i=function(){var t=location.hash.match(/#(.*)$/),i=t?t[1]:"",a=e.unparam(i);return a.cartId};return{go:function(e){if(!e){var a=i();if(!a)return;e=a}var o=t.get("#J_Item_"+e);if(o){var r=t.offset(o).top;t.scrollTop("body",r-20)}}}},{requires:["dom"]}),KISSY.add("cart/mods/cart/baseCart",function(e,t,i,a,o,r,n,s,l,c,d,u,p,m,h,f,g,_,v){function I(t){e.mix(this,t),this._init()}var T,S="[baseCart] ",b=t.all,E={normal:v.lang("NORMAL_ITEMS"),HK:v.lang("TMALL_HK_ITEMS"),cod:v.lang("COD"),YY:v.lang("MEDICAL_ITEMS"),LG:v.lang("LIRENGOU_ITEMS"),OSDS:v.lang("TMALL_OSDS_ITEMS")};return e.augment(I,{_init:function(){var e=this;e.orders={},e.cartIdsSelected=[],e.itemsSelected={};var t=!0;e.loader=new r({diff:500,container:"#J_Cart",extraParams:this.loadExtraParams,loadCfg:this.loadCfg||{success:function(e){0===e.globalData.totalSize&&Global.empty()},error:function(e){},end:function(e){t===!0&&Global.utils.goldlog("cart_nums",{totalSize:e.globalData.totalSize,bItemsCount:e.globalData.bItemsCount,cItemsCount:e.globalData.cItemsCount,shopCount:e.list?e.list.length:0,cShopsCount:e.globalData.cShopsCount,bShopsCount:e.globalData.bShopsCount}),setTimeout(_.go,0)}},Cart:e}),setTimeout(function(){d.init(e),c.init()},10)},getTotalPriceInfo:function(){var t=this,i=0,a=100,o="",r="",n={};return e.each(this.itemsSelected,function(e){e&&(i+=e.getPrice()),r?r!=e.getCurrencyCode()&&(r="Mixin"):r=e.getCurrencyCode(),a=e.getUnitFactor(),o=e.getCurrency(),n[e.orderId]=e.orderId}),"SM"===Global.cfg.layout&&e.each(n,function(e){var a=t.orders[e];a&&a.data.promView&&a.data.promView.discount&&(i-=a.data.promView.discount)}),i=i>0?i:0,{total:i,unitFactor:a,symbol:o,code:r}},calc:function(){var e=this.getTotalPriceInfo();s.calc(e.total,e.unitFactor,e.symbol,e.code)},addSelectedItem:function(t){var i=t.cartId;return e.inArray(i,this.cartIdsSelected)||this.cartIdsSelected.unshift(i),this.itemsSelected[i]=t,t},removeSelectedItem:function(t){var i=t.cartId,a=e.indexOf(i,this.cartIdsSelected);return a>-1?(this.cartIdsSelected.splice(a,1),delete this.itemsSelected[i],t):null},getItems:function(t,i,a){var o=[],r=0,n=!1;return e.each(this.orders,function(s){if(e.each(s.bundles,function(s){if(e.each(s.items,function(s){if(s&&n===!1){var l=!0;if(t&&e.each(t,function(e,t){var i=a===!0?s.data[t]:s[t];if(i!==e)return l=!1,!1}),l&&(o.push(s),i>0&&i===o.length))return n=!0,!1;r++}}),n===!0)return!1}),n===!0)return!1}),i<=0&&(this.itemsCount=r),o},getItemsByAttr:function(t,i,a){var o=[],r=!1;return e.each(this.orders,function(n){if(e.each(n.bundles,function(n){if(e.each(n.items,function(n){if(n&&r===!1){var s=!0;if(t&&e.each(t,function(t,i){var o=n.getAttr(i);if(a){if(o!==t)return s=!1,!1}else if(e.isUndefined(o))return s=!1,!1}),s&&(o.push(n),i>0&&o.length===i))return r=!0,!1}}),r===!0)return!1}),r===!0)return!1}),o},getSelectedItems:function(t){var i=this,a=[];return t?e.each(this.cartIdsSelected,function(o){var r=i.itemsSelected[o];r&&e.each(t,function(e,t){r[t]===e&&a.push(r)})}):e.each(this.cartIdsSelected,function(e){a.push(i.itemsSelected[e])}),a},getSelectedItemsLength:function(){return this.cartIdsSelected.length||0},getInvalidItems:function(){return this.getItems({isValid:!1},-1,!0)},getTruelyInvalidItems:function(){var t=this.getInvalidItems(),i=[];return e.each(t,function(e){e.data&&"ju11"!==e.data.type&&"presell"!==e.data.type&&i.push(e)}),i},getSelectedItemsAndGroups:function(){var t=this,i=[],a=[],o={},r=!1,n="",s=function(e){var t="";if(e.groupTitle)t=e.groupTitle,n=e.groupTitle;else if("HK_"===e.group.substr(0,3)){var i=e.data.shopName.split(""),a="";i.length>10?(i.length=9,a=i.join("")+"..."):a=i.join(""),t=v.lang("DUTY_FREE")+a,n=v.lang("DUTY_FREE")+e.data.shopName}else"HKGS-"===e.group.substr(0,5)?(t=e.data.region?'<strong class="s-name">'+e.data.shopName+'</strong><span class="s-region"> , \u4ec5\u552e'+e.data.region.name+"</span>":e.data.shopName,n=e.data.region?e.data.shopName+"\uff0c\u4ec5\u552e"+e.data.region.name:e.data.shopName):"HK"===e.group.substr(0,2)?(t=v.lang("TMALL_HK_ITEMS"),n=v.lang("TMALL_HK_ITEMS")):"SM"===e.group.substr(0,2)?(t=e.data.shopName,n=e.data.shopName):"YYZY"===e.group.substr(0,4)?(t="\u963f\u91cc\u5065\u5eb7",n="\u963f\u91cc\u5065\u5eb7"):"ALITRIP"===e.group.substr(0,7)?(t="\u963f\u91cc\u65c5\u884c\u5546\u54c1",n="\u963f\u91cc\u65c5\u884c\u5546\u54c1"):"CT"===e.group.substr(0,2)?(t="\u6751\u6dd8\u5b98\u65b9\u5e97\u5546\u54c1",n="\u6751\u6dd8\u5b98\u65b9\u5e97\u5546\u54c1"):(t=E[e.group],n=E[e.group]);return t};return e.each(this.cartIdsSelected,function(l){var c=t.itemsSelected[l];if(c&&c.isSelected()&&c.isValid){"HK"!==c.host||c.data.isDutyFree||r||(r=!0),i.push(c);var d=c.group;e.inArray(d,a)||a.push(d);var u,p;try{u=c.data.price.currency.unitFactor}catch(m){u=100}try{p=c.data.price.currency.symbol}catch(m){p="\uffe5"}o[d]=o[d]||{name:d,title:s(c),originTitle:n,items:[],total:0,expand:!0,unitFactor:u,currency:p},o[d].items.push(c),o[d].total+=c.getPrice()}}),{items:i,groups:a,itemsByGroup:o,showTaxText:r}},getSelectedItemsByGroup:function(){var t=this,i={normal:[]},a=[];return e.each(this.cartIdsSelected,function(e){var a=t.itemsSelected[e];a&&a.isSelected()&&a.group&&(i[a.group]=i[a.group]||[],i[a.group].push(a))}),e.each(i,function(e,t){a.push({name:t,title:E[t]||t,items:e})}),a},isAllSelected:function(){var t=!0;return e.each(this.orders,function(e){if(e&&!e.isChecked())return t=!1,!1}),t},check:function(e){if(T&&clearTimeout(T),e+1)this.isChecked=e,c.toggle(e);else{var t=this;T=setTimeout(function(){t.check(t.isAllSelected())},100)}},select:function(t){var i=!0,a=this.getItems({skuStatus:1},1,!0);if(a.length&&(a[0].select(),i=!1),i===!0){var o=[];e.each(this.orders,function(e){if(e){if(!e.select(!1))return i=!1,!1;o.push(e)}}),this.check(i),Global.request({type:"check",orders:o}),Global.updateCart()}return i},unselect:function(t){e.each(this.orders,function(e){e&&e.unselect()}),this.check(!1)},update:function(t){e.log(S+"Start to update Cart.");var i=this;e.each(this.orders,function(e){e.correct(!0)});var a=this.getSelectedItemsAndGroups(),o=this.getItems({isValid:!0},-1,!0);c.update(o,a.items);var r=!1,n=e.isEmptyObject(this.orders);if(f.inited===!1){var s=b("#J_Cart");s&&s.length&&s.offset().top+s.height()<b(window).height()&&(r=!0)}if(Global.utils.isDaily&&n===!0&&(/[\?&]fallback=false/.test(location.href)?(g.error("\u8d2d\u7269\u8f66\u52a0\u8f7d\u5931\u8d25\uff0c\u5bb9\u9519\u673a\u5236\u5173\u95ed"),r=!1,n=!1):g.error("\u8d2d\u7269\u8f66\u52a0\u8f7d\u5931\u8d25\uff0c\u91cd\u8bd5\u4e2d...")),n=!1,n===!0){var u=Global.globalData?parseInt(Global.globalData.page,10):1;u=u||1,e.log(S+"Cart retries loading page: "+u),this.loader.load({page:u},this.retryLoadCfg||{success:function(e){0===e.globalData.totalSize&&Global.empty()},error:function(e){}})}else r===!0?(e.log(S+"Cart empty....Start to load more"),this.loader.load({},{success:function(e){},error:function(e){}})):d.update(a);return this.calc(),l.render(),this._updateFilterBar(e.mix({normal:o.length,invalid:i.itemsCount-o.length},t)),h.update({selectedItems:a,validItems:o,invalidCount:i.itemsCount-o.length}),!0},_updateFilterBar:function(e){u.update(e),p.update(e)},render:function(t,i,a,r){var s=this;e.log(S+"start to render cart."),e.each(t,function(t,o){t.uniqueId=t.id+"_"+i;var l=s.orders[t.uniqueId];l&&(a=a||l.data.startTime,r=r||l.data.endTime,l.orderHolderEl.height(l.orderHolderEl.height()),t=l.mixData(t),delete s.orders[t.uniqueId]),t.startTime=a,t.endTime=r,t.page=i;try{s.orders[t.uniqueId]=n.create({uniqueId:t.uniqueId,id:t.id,data:t})}catch(c){var d="order "+t.id+" construct error: "+c;e.log(d,"warn"),Global.utils.logger("baseCart","warn",d),setTimeout(function(){throw c},15)}}),6===o.ie&&setTimeout(function(){b(".J_Order").css("zoom",1)},150)},getItemByCartId:function(t){var i=this,a=null;return e.each(i.orders,function(e){if(e&&(a=e.getItemByCartId(t)))return!1}),a},getOrderById:function(e){var t=this.getOrders({id:e});return t?t[0]:null},getOrders:function(t){var i=this,a=[];return e.each(i.orders,function(i){e.each(t,function(e,t){if(i&&i[t]===e&&(a.push(i),"id"===t))return!1})}),a},removeOrder:function(e){delete this.orders[e]},destroy:function(){this.loader&&this.loader.disable(),b("#J_OrderList").html(""),l.clear(),h.destroy()}}),I},{requires:["node","dom","event","ua","../global/loader","../order/orderFactory","./floatbar/totalpay","./undo/undo","./select/select","./floatbar/floatbar","./filterbar/status-bar","./filterbar/switch-cart","../../utils/dialog/dialog","../global/plugin","../global/footer/footer","../../utils/debug/debug","../global/scrollToCartId","../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/cartTPL",function(e,t,i,a,o){var r=t.all,n="[cartTPL] ",s={empty:'<div id="crumbs"><strong>'+o.lang("YOUR_POSITION")+'</strong><ol class="crumbs"><li><a href="//www.taobao.com">'+o.lang("INDEX")+'</a></li><li><a href="//i.taobao.com/my_taobao.htm" data-spm-anchor-id="a1z0d.1.0.0">'+o.lang("MY_TAOBAO")+'</a></li><li class="current">'+o.lang("MY_CART")+'</li></ol><span class="cart-tip">'+o.lang("TIPS_CART_INTRO")+'<a href="//service.taobao.com/support/help-11746.htm?spm=a1z0d.1.0.0.ogEwpx" target="_blank" data-spm-anchor-id="a1z0d.1.0.0">'+o.lang("HOW_TO_USE_CART")+'</a></span></div><div id="empty"><h2>'+o.lang("TIPS_CART_EMPTY")+"</h2><ul><li>"+o.lang("TIPS_TO_FAV")+"</li><li>"+o.lang("TIPS_TO_LIST")+"</li></ul></div>"};Global.cfg.isYaoPartner&&(s={empty:'<div class="yao_empty"><h2>\u9700\u6c42\u6e05\u5355\u4e2d\u6682\u65e0\u5546\u54c1</h2></div>'});var l={};return{render:function(e){var t=r("#J_Cart");if(e.type&&s[e.type]){l[e.type]||(l[e.type]=i(s[e.type]));var o=a(l[e.type],e,n);t.html(o)}return t}}},{requires:["node","gallery/template/1.0/","../../utils/tpl/render","../../utils/i18n/i18n"]}),KISSY.add("cart/mods/cart/emptyCart",function(e,t,i,a){function o(t){e.mix(this,t),i.render({type:"empty"}),Global.renderFooter()}t.all;return e.augment(o,{update:function(){a.update()}}),o},{requires:["node","./cartTPL","../global/plugin"]}),KISSY.add("cart/mods/cart/promoCart",function(e,t,i,a,o){function r(t){e.mix(this,t),this._init()}t.all;return e.extend(r,i,{_init:function(){a.to("normal")},_updateFilterBar:function(){o.disable(),a.back('<span class="promo-cart-tips">\u4ee5\u4e0b\u5546\u54c1\u6709\u65b0\u4f18\u60e0\u5566\uff0c\u8d76\u7d27\u53bb\u8d2d\u4e70\u5427</span>')},switchToNormal:function(){
a.to("normal")}}),r},{requires:["node","./baseCart","./filterbar/switch-cart","./filterbar/status-bar"]}),KISSY.add("cart/mods/cart/newPromoCart",function(e,t,i,a){function o(t){e.mix(this,t),this._init()}t.all;return e.extend(o,i,{_init:function(){var e=this;e.loadExtraParams={extStatus:2},e.loadCfg={success:function(t){return e.loader&&e.loader.disable(),0===t.globalData.currentPageSize?(a.to("normal"),!1):(Global.renderFooter(),!0)}},this.retryLoadCfg=this.loadCfg,o.superclass._init.call(this)},update:function(){return e.isEmptyObject(this.orders)?void a.to("normal"):void o.superclass.update.call(this)},switchToNormal:function(){a.to("normal")},_updateFilterBar:function(t){a.update(e.mix(t,{showPipe:!1}))}}),o},{requires:["node","./baseCart","./filterbar/switch-cart"]}),KISSY.add("cart/mods/cart/lowAmountCart",function(e,t,i,a){function o(t){e.mix(this,t),this._init()}t.all;return e.extend(o,i,{_init:function(){var e=this;e.loadExtraParams={extStatus:4},e.loadCfg={success:function(t){return e.loader&&e.loader.disable(),0===t.globalData.currentPageSize?(a.to("normal"),!1):(Global.renderFooter(),!0)}},this.retryLoadCfg=this.loadCfg,o.superclass._init.call(this)},update:function(){return e.isEmptyObject(this.orders)?void a.to("normal"):void o.superclass.update.call(this)},switchToNormal:function(){a.to("normal")},_updateFilterBar:function(t){a.update(e.mix(t,{showPipe:!1}))}}),o},{requires:["node","./baseCart","./filterbar/switch-cart"]}),KISSY.add("cart/mods/cart/villagerCart",function(e,t,i){function a(t){e.mix(this,t),this._init()}t.all;return e.extend(a,i,{_init:function(){this.loadExtraParams={extStatus:this.extStatus},a.superclass._init.call(this)}}),a},{requires:["node","./baseCart"]}),KISSY.add("cart/mods/cart/cartFactory",function(e,t,i,a,o,r,n){var s="[cartFactory] ";return{create:function(l){var c;switch(l.type){case"empty":c=new i(l);break;case"promo":c=new a(l);break;case"newPromo":c=new o(l);break;case"lowAmount":c=new r(l);break;case"villager":c=new n(l);break;default:c=new t(l)}return e.log(s+" current type is "+l.type),c}}},{requires:["./baseCart","./emptyCart","./promoCart","./newPromoCart","./lowAmountCart","./villagerCart"]}),KISSY.add("cart/mods/group/groupRedemptionUpdate",function(e,t,i,a){var o=t.all;return{render:function(e,t,r){var n='{{#if icon}}<img height="16px" style="vertical-align: sub;" src={{icon}} />&nbsp;{{/if}}{{#if text}}<span>{{text}}</span>{{/if}}{{#if url && urlText}}<a href={{url}} class="coudan-v2" target="_blank"><span class="coudan-v2-text">{{urlText}}</span><span>></span></a>{{/if}}';try{o("#J_Group_"+t+"_"+r+" .amount").html(a(i(n),e))}catch(s){}}}},{requires:["node","gallery/template/1.0/","../../utils/tpl/render"]}),KISSY.add("cart/mods/global/request",function(e,t,i,a,o,r,n,s,l,c){function d(t,i){var a={shopId:t.shopId,comboId:t.comboId,shopActId:t.shopActId,cart:[],operate:[],type:i.type},o=t.getItems(),r={},n=!0,s=!1;return e.each(o,function(e){if(e){r[e.cartId]=!0;var t=!1,o="update"===i.type&&e===i.operate?i.quantity:e.getQuantity();if("add_tiny_cart"===i.from&&i.operate&&i.operate.itemId&&i.operate.itemId===e.itemId&&i.operate.skuId===e.getSkuId()&&(s=!0,o+=1),"SM"===Global.cfg.layout?(e.isSelected()||e.isCombo||e.isRedemption||e===i.operate)&&(t=!0):t=!0,t){var l=e.data.extInfo;a.cart.push({isPriorityBuy:l.isPriorityBuy,priorityBuyAttr:l.priorityBuyAttr,quantity:o,cartId:e.cartId,skuId:e.getSkuId(),itemId:e.itemId}),n=!1}}}),s||"add_tiny_cart"!==i.from||a.cart.push({quantity:i.operate.quantity,cartId:i.operate.cartId,skuId:i.operate.skuId,itemId:i.operate.itemId}),"addExtraItem"===i.type&&(r[0]=!0,a.cart.push(i.operate)),"undelete"===i.type&&e.each(e.makeArray(i.operate),function(e){e&&e.orderId===t.uniqueId&&(r[e.cartId]=!0,a.cart.push({quantity:e.getQuantity(),cartId:e.cartId}))}),(!n||"check"!==i.type)&&(e.each(e.makeArray(i.operate),function(e){r[e.cartId]&&"add_tiny_cart"!==i.from&&a.operate.push(e.cartId)}),i.extraParams&&e.mix(a,i.extraParams),a)}function u(t,u){var h=this;e.log(m+"start request, type: "+t.type);var f=[],g={},_=e.unparam(location.search.substr(1)),v=e.now(),I=e.makeArray(t.operate);if(e.each(e.makeArray(t.orders),function(e,i){var a=d(e,t);I[i];if(a){f.push(a);var o=e&&e.data&&e.data.page?e.data.page:1;g[o]=g[o]||[],g[o].push(a)}},this),!f.length)return!1;var T=e.now();return e.each(g,function(d,f){var g=a.stringify(d);e.log(m+"post data for page "+f+": "+g);var I={_input_charset:"utf-8",tk:p("#_tb_token_").val(),data:g,shop_id:Global.data.shopId||_.shop_id||0,t:+new Date,type:t.type,ct:o.get("t"),page:f,_thwlang:s.langConfig};if(Global&&Global.globalData&&Global.globalData.division&&(I.divisionCode=Global.globalData.division.code?Global.globalData.division.code:""),Global.cfg.type&&(I.extStatus=Global.cfg.type),Global.cfg.tpId&&(I.tpId=Global.cfg.tpId),t.globalParams&&e.mix(I,t.globalParams),Global.cfg.isYaoPartner){var S=Global.globalData&&Global.globalData.cartFrom||"alihealth_yao";e.mix(I,{cartFrom:S})}var b=l.now();i({type:"POST",dataType:"json",url:Global.cfg.api.update,data:I,success:e.bind(function(i){var a=e.now();if(e.log("update result got, status is: "+(i.success?"success":"error")),i.success){var o=i.globalData||{};o&&o.totalSize!==-1&&(Global.totalSize=o.totalSize),Global.promotionCount=o.promotionCount,Global.stockTenseCount=o.stockTenseCount,n.transform(i),t.success&&t.success(i),u&&u.render(i.list,o.page),o&&o.bundRela&&o.bundRela.list&&e.each(o.bundRela.list,function(e,t){e&&e.coudanV2&&c.render(e.coudanV2,e.id,o.page)}),l.retSuccess(Global.cfg.api.update,l.now()-b)}else{!t.silent&&i.error&&r.alert(i.error.errorMessage||s.lang("TIPS_ERROR_SYSTEM_FAILED")),t.error&&t.error(i);var d="async update return "+(i&&i.error&&i.error.errorCode?i.error.errorCode:"unknown")+" error: "+g+" || updateCart_return_error";Global.utils.logger("request","error",d),l.retError(Global.cfg.api.update,l.now()-b,"response data exception")}var p=e.now();Global.updateCart({page:f,type:t.type,globalData:i.globalData}),Global.utils.goldlog("cart3-request_time",{dataTime:(T-v)/1e3,requestTime:(a-T)/1e3,renderTime:(p-a)/1e3,updateTime:(e.now()-p)/1e3,updateType:t.type}),Global.queue.next()},h),error:function(e,t,i){try{a&&a.error&&a.error()}catch(a){}Global.queue.next(),Global.utils.logger("request","error","async update request error || updateCart_request_error"),l.retError(Global.cfg.api.update,l.now()-b,i)},timeout:10})}),!0}var p=t.all,m="[Global Request] ",h={};return function(e,t){var i=this;h[e.type]&&clearTimeout(h[e.type]),h[e.type]=setTimeout(function(){u.call(i,e,t)},50)}},{requires:["node","ajax","json","cookie","../../utils/dialog/dialog","./data","../../utils/i18n/i18n","./retcode","../group/groupRedemptionUpdate"]}),KISSY.add("cart/mods/global/makepoint/makepoint",function(e,t,i){var a=document.body,o=function(t){t=t+(t.indexOf("?")===-1?"?":"&")+"cache="+e.now();var i=window["g_makepoint_"+e.guid()]=new Image;i.src=t};return{init:function(){var e=this;i.on(a,"click",function(i){if(i&&i.target)if(t.hasClass(i.target,"J_MakePoint")){var a=t.attr(i.target,"data-point");a&&e.track({data:a})}else t.hasClass(i.target,".ww-inline")&&e.track({data:"tbcart.8.16"})})},track:function(t){if(t&&(t.data||t.url)){e.isString(t)&&(t={data:t});var i=t.data?"//gm.mmstat.com/"+t.data:t.url;o(i)}}}},{requires:["dom","event"]}),KISSY.add("cart/mods/global/sidefloat/sidefloat.tpl",function(e,t){var i="//survey.taobao.com/survey/QwE0mTiCx?type=3";return Global&&Global.cfg&&Global.cfg.isGlobal&&(i="//www.surveymonkey.com/r/taobao_global_mytb"),'<div id="J_SideFloat" class="side-float"><a id="J_GoToTop" class="go-to-top J_GoToTop J_MakePoint" data-point="tbcart.8.28"><span class="iconfont">&#61534</span><em>'+t.lang("BACK_TO_TOP")+'</em></a><a class="suggestion J_Suggestion J_MakePoint" data-point="tbcart.8.29" target="_blank" href="'+i+'"><span class="iconfont">&#61535</span><em>'+t.lang("FEEDBACK")+"</em></a></div>"},{requires:["../../../utils/i18n/i18n"]}),KISSY.add("cart/mods/global/sidefloat/sidefloat",function(e,t,i,a,o){var r,n,s=t.all,l=s(window),c=function(t){var i=t&&t.offset()?t.offset().top:0,a=t.height(),o=500,r=e.later(function(){},0);t.css("top",i+l.scrollTop()),l.on("scroll resize",function(n){var s=l.scrollTop();i=(l.height()-a)/3*2,r.cancel(),r=e.later(function(){l.scrollTop()===s&&t.css("top",i+l.scrollTop())},o)})};return{init:function(){function e(){if(l.width()<1060){var e=s("#J_OrderList"),t=e.offset();t&&r.css({left:t.left+e.width()-20,right:"auto"})}else r.css({left:"auto",right:"6px"})}var t=this;r=s(o).appendTo("body").delegate("click",".J_GoToTop",function(e){e.preventDefault(),i(window,{scrollTop:0},.5,"easeOutStrong").run()}),n=s("#J_GoToTop"),t.toggleGoToTop(),l.on("scroll",t.toggleGoToTop,t),e(),l.on("resize",e),6===a.ie&&c(r)},toggleGoToTop:function(){n.css("visibility",l.scrollTop()?"visible":"hidden")}}},{requires:["node","anim","ua","./sidefloat.tpl"]}),KISSY.add("cart/utils/my-path/my-path",function(e,t,i,a){var o=(t.all,"mtop.taobao.cmin.mypath"),r="//g.alicdn.com/mtb/lib-mtop/2.3.16/mtop.js";return{init:function(t){var i=this;window.lib&&window.lib.mtop?i.mtop(t):e.getScript(r,{success:function(){try{a.retSuccess(r,a.now()-startTime)}catch(e){}i.mtop(t)},error:function(){try{a.retError(r,a.now()-startTime,"\u52a0\u8f7dlibMtop\u5f02\u5e38")}catch(e){}},timeout:10})},mtop:function(t){var i=window.lib.mtop,r=a.now();i.request({api:o,v:"1.0",ecode:"1",timeout:3e3,type:"POST",data:{pageSize:20,endTime:(new Date).getTime()}},function(i){var n=[],s=[];if(i&&i.data&&i.data.result&&i.data.result.length>0){var l={url:"url",id:"itemId",pic:"pic",price:"price",title:"title"};e.each(i.data.result,function(t){e.each(t.dataList,function(t){if(s.indexOf(t.id)===-1){var i={};for(var a in l)i[l[a]]=t[a],i.price=parseFloat(i.price).toFixed(2),i.xid="",i.itemIdStr=t.id,i.isDaily=Global.utils.isDaily;!e.isEmptyObject(i)&&n.push(i),s.push(t.id)}})}),a.retSuccess(o,a.now()-r)}t.callback&&t.callback(n.slice(0,4))},function(e){var t=e&&e.ret&&e.ret[0]||"\u8bf7\u6c42\u51fa\u9519";a.retError(o,a.now()-r,t)})}}},{requires:["node","ajax","../../mods/global/retcode"]}),KISSY.add("cart/mods/global/relative/relative-effect",function(e,t){var i=t.all,a=!1,o=null;return{init:function(e){a||(a=!0,i('<div class="wrap-line"><div class="floater" style="width: 0;"></div></div>').insertAfter(e.one(".tabs")),this.update(e))},update:function(e){var t=e.one(".wrap-line"),a=t.one(".floater"),r=i(".current",e),n=0;try{n=r.offset().left-e.offset().left}catch(s){n=0}o&&o.stop(!0),a.animate({left:n,width:r.outerWidth()-1},{easing:"easeIn",duration:.2})}}},{requires:["node"]}),KISSY.add("cart/utils/price-level/price-level",function(e){return{parse:function(e){var t="0";return e>9999.99?t="w":e>99999.99?t="sw":e>999999.99?t="bw":e>9999999.99?t="qw":e>99999999.99?t="y":e>999999999.99&&(t="sy"),t}}},{requires:[]}),KISSY.add("cart/mods/global/relative/relative",function(e,t,i,a,o,r,n,s,l,c,d,u,p){var m,h=t.all,f="[Relative] ",g={"\u987a\u4fbf\u5e26\u8d70":"ebook","\u6700\u8fd1\u6536\u85cf\u7684":"fav","\u6700\u8fd1\u6d4f\u89c8\u8fc7\u7684":"browser","\u731c\u4f60\u559c\u6b22\u7684":"like"},_='<p class="tip-loading tip"><img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif" />\u6570\u636e\u52a0\u8f7d\u4e2d...</p>',v=h("#interested"),I=(Global.cfg.api.likeAPI,Global.cfg.api.favoriteListAPI),T=(Global.cfg.api.ebookAPI,h("#J_Auctions")),S=T.all(".J_Panel"),b=T.all(".J_Triggers"),E=(h(".J_ClearBrowse",v),{}),C=!1,y={_init:function(){v&&C!==!0&&""==Global.cfg.client&&(v.show(),Global.lazyload(v,this._loadTabData,this))},_initTabs:function(t){var i=this;Global.cfg.isYaoPartner||e.use("gallery/switchable/1.3.1/",function(e,a){m&&m.destroy(!0),m=new a.Tabs("#J_Auctions",{markupType:2,activeTriggerCls:"current",triggers:b,panels:S,autoplay:!0,triggerType:"mouse",pauseOnHover:!0,interval:5,switchTo:t});var o=h("#J_Auctions");s.init(o),m.on("switch",function(e){i._loadTabData(e.currentIndex),s.update(o)},i),o.on("click mouseenter",function(e){m.stop()})})},_loadTabData:function(t){t=parseInt(t,10)||0;var a=e.trim(i.attr(b[t],"data-method"));!a&&b[t]&&(a=g[e.trim(i.text(b[t]))]),E[t]||(E[t]="loading",a&&"_loadData_"+a in this&&this["_loadData_"+a](t),this._initTabs(t))},_loadData_fav:function(t){var a=this,o=function(){i.remove(b[t]),i.remove(S[t]),Array.prototype.splice.call(b,t,1),Array.prototype.splice.call(S,t,1),a._initTabs(t),E[t]="",a._loadTabData(t)},r=p.now();a._showLoading(t),e.getScript(I+"&t="+e.now()+"&_tb_token_="+i.val("#_tb_token_"),{success:function(){try{p.retSuccess("//favorite.taobao.com/collect_list_for_im_json.htm",p.now()-r)}catch(i){}var n=window.result;if(!n||!n.collectList)return o();try{var s=a._parseData(n.collectList.slice(0,5),"fav");s+='<a class="relative-extra gotomyfav" href="//favorite.taobao.com/collect_list.htm?scjjc=d2" target="_blank">'+u.lang("GO_TO_FAV")+'&nbsp;<span class="gt">&gt;&gt;</span></a>',S[t].innerHTML=l(s),e.log(f+"fav data loaded.")}catch(i){o()}},error:function(e,t,i){o();try{p.retError("//favorite.taobao.com/collect_list_for_im_json.htm",p.now()-r,i)}catch(a){}},timeout:2}),C=!0},_loadData_browser:function(e){var t=this;t._showLoading(e),n&&n.init({callback:function(a){var o;a&&a.length?(o=t._parseData(a.slice(0,5),"browser"),o+='<a class="relative-extra btn-to-my-path" href="//www.taobao.com/markets/footmark/tbfoot" target="_blank">'+u.lang("GO_TO_FOOTPRINT")+'&nbsp;<span class="gt">&gt;&gt;</span></a>',S[e||0].innerHTML=l(o)):(i.remove(b[e]),i.remove(S[e]),Array.prototype.splice.call(b,e,1),Array.prototype.splice.call(S,e,1),t._initTabs(e),E[e]="",t._loadTabData(e))},type:"r"})},_loadData_like:function(e){var t=i.get("#J_CartLikeArea");i.html(t,i.val("#J_CartLikeData"),!0)},_loadData_ebook:function(e){var t=i.get("#p4p-block");if(t){if(""===i.html(t)){var a=i.create("<div></div>");i.hide(a),i.html(a,i.val("#J_P4PBlockData"),!0)}}},_parseData:function(t,i){"_formatData_"+i in this&&(t=this["_formatData_"+i](t));var a=/_sum\.jpg|_70x70\.jpg/;e.each(t,function(t){t.imageUrl=t.imageUrl.replace(a,"_220x220.jpg"),t.imageUrl=e.escapeHTML(t.imageUrl),t.title=e.escapeHTML(t.title.replace("\\u"," "))}),t={data:t};var r=o('<ul class="relative-list relative-list-'+i+'">{{#each data as item}}<li class="relative-item"><div class="recommend-item-pic cart-pic s220"><a href="{{item.detailUrl}}" target="_blank" class="pic"><img src="{{item.imageUrl}}" /></a></div><div class="recommend-item-info"><p>{{#if item.extMap}}{{#if item.extMap.presell20141212 === 1}}<span class="tbc-double-12-label tbc-hongbao-label-common tbc-hongbao-label-pc tbc-hongbao-label-presale-normal" data-type="presale" data-render-finish="done" title="1212\u9884\u552e">1212\u9884\u552e</span>{{#elseif item.extMap.redpack20141212}}<span class="tbc-double-12-label" data-type="coupon" data-value="{{item.extMap.redpack20141212}}"></span>{{#elseif item.extMap.mark20141212}}<span class="tbc-double-12-label tbc-hongbao-label-common tbc-hongbao-label-pc tbc-hongbao-label-normal" data-type="label" data-render-finish="done" title="1212\u4e07\u80fd\u76db\u5178">1212\u4e07\u80fd\u76db\u5178</span>{{/if}}{{/if}}<span class="price g_price price-level-{{item.priceLevel}}">&yen;<em>{{item.price}}</em></span></p><p><a href="{{item.detailUrl}}" target="_blank" class="item-title">{{item.title}}</a></p></div></li>{{/each}}</ul>');return r.render(t)},_formatData_browser:function(t){var i=[];return e.each(t,function(e){i.push({title:e.title||"",price:parseFloat(e.price).toFixed(2),detailUrl:e.url,imageUrl:e.pic+"_220x220.jpg"})}),i},_formatData_oldlike:function(t){var i=[];return e.each(t,function(e){i.push({title:e.name,price:parseFloat(e.price).toFixed(2),detailUrl:e.url,imageUrl:e.pic+"_220x220.jpg",extMap:e.extMap})}),i},_formatData_like:function(t){var i=[];return e.each(t,function(e){var t,a=!1;e.extMap&&(e.extMap.price20141212?t=e.extMap.price20141212:e.extMap.preprice20141212&&(t=e.extMap.preprice20141212),e.extMap.redpack20141212&&(e.extMap.redpack20141212=100*e.extMap.redpack20141212,a=!0),(e.extMap.mark20141212||e.extMap.presell20141212)&&(a=!0)),"undefined"==typeof t&&(t=e.promotionPrice||e.price),t=parseFloat(t).toFixed(2),i.push({title:e.itemName,price:t,priceLevel:a===!0?d.parse(t):"00",detailUrl:e.url,imageUrl:e.pic+"_220x220.jpg",extMap:e.extMap})}),i},_showLoading:function(e){S[e].innerHTML=_}};return{init:function(){y._init()}}},{requires:["node","dom","event","gallery/template/1.0/","ajax","../../../utils/my-path/my-path","./relative-effect","../../../utils/tpl/render","../../../utils/20141212/hongbao-label","../../../utils/price-level/price-level","../../../utils/i18n/i18n","../retcode"]}),KISSY.add("cart/mods/global/banner/banner",function(e,t,i){var a=t.all,o="[banner] ";return{inited:!1,init:function(){this.inited!==!0&&(this.inited=!0,"en"!==Global.cfg.lang&&new i({url:"//www.taobao.com/go/rgn/cart/top-banner.php",data:{domain:Global.cfg.domain,tpId:Global.cfg.tpId,layout:Global.cfg.layout,lang:Global.cfg.lang},dataType:"jsonp",type:"get",success:function(t){if(t&&t.result===!0){var i='<a href="'+t.link+'" target="_blank" data-spm="d4916709"><img alt="'+t.text+'" src="'+t.img+'"></a>',r=a('<div class="cart-banner wp" data-spm="1996481313"></div>').insertBefore("#J_Cart").html(i);t.width&&t.height&&(r.height(t.height).addClass("cart-banner-center"),r.one("a").width(t.width).height(t.height)),e.log(o+"inited.")}}}))}}},{requires:["node","ajax"]}),KISSY.add("cart/mods/global/banner/ljms-banner",function(e,t,i,a,o){var r=t.all;return{init:function(){var e=firstData&&firstData.globalData&&firstData.globalData.activityBanner,t=i.get("ljms_url");if(e&&(e.url||(e.url=""),t!=e.url&&i.remove("ljms_visiable"),t&&t==e.url||i.set("ljms_url",e.url,999),1!=i.get("ljms_visiable"))){var n=(e.bgColor?"background-color:"+e.bgColor+";":"")+(e.bgPic?"background-image: url("+e.bgPic+");":""),s='<a class="J_ljms cart-ljms-link" href="{{#if url}}{{url}}{{/if}}{{#if !url}}javascript:;{{/if}}"><div class="cart-ljms-banner" style="'+n+'"><div class="ljms-banner-content">{{#if iconUrl}}<img src="{{iconUrl}}" />{{/if}}<span style="color: {{textColor}}">{{text}} {{#if url}}>{{/if}}</span>{{#if textCloseHours >= 0}}<span class="J_ljms_close ljms-close-btn" style="color: {{textColor}}">X</span>{{/if}}</div></div></a>';try{r(o(a(s),e)).insertBefore("#J_Cart"),r(".J_ljms_close").on("click",function(t){t.preventDefault();var a=e.textCloseHours;a>0&&i.set("ljms_visiable",1,a/24),r(".J_ljms").hide()})}catch(l){}}}}},{requires:["node","cookie","gallery/template/1.0/","../../../utils/tpl/render"]}),KISSY.add("cart/mods/global/search/search",function(e,t){t.all;return{init:function(){var t="6.0.23/",i=",kg/search-suggest/"+t,a=["dom","index","plugin/history","plugin/cloud","plugin/tab","new_suggest.css"];e.use(a.join(i),function(e,t,i,a,o,r){var n=["history","dapei_top","cat","global","list","shop","scene","dapei_bottom","tmall","cloud"],s=[new a,new r({activeCls:"selected",node:"#J_Search li.J_SearchTab"}),new o],l="//suggest.taobao.com/sug?area=c2c&k=1",c="";location.href.indexOf("debug=test")>-1&&(l="//suggest.proxy.taobao.org/sug?area=c2c&k=1");var d=new i({plugins:s,sugConfig:{sourceUrl:l,node:"#q",resultFormat:c,focused:!0,placeholderEl:"#J_TSearchForm label"},mods:{sort:n,tmall:{tmpl:'<div class="{prefixCls}menu-extras-cate extras-mall" data-key="q={tmall}&suggest=tmall_{$index}&tab=mall"><span class="{prefixCls}menu-key">{tmall}</span><b>\u5929\u732b\u76f8\u5173</b></div>'}}});d.on("beforeFocus",function(){var e=d.get("input"),i=t.parent(e,"form"),a=t.parent(e,2),o=t.prev(a,"label"),r=t.next(a,"i");o&&t.css(o,{color:"#ccc"}),r&&t.hide(r),i.className="search-panel-focused"}),d.on("afterQueryChange",function(e){var i=e.query,a=d.get("input"),o=t.parent(a,2),r=t.prev(o,"label");""!==i&&t.hide(r)}),d.on("beforeBlur",function(){var i=d.get("input"),a=t.parent(i,"form"),o=t.parent(i,2),r=t.prev(o,"label"),n=t.next(o,"i");""===e.trim(i.val())&&(r&&(t.show([r]),t.css(r,{color:"#999"})),n&&t.show(n)),a.className=""}),e.one(".search-triggers").on("mouseenter mouseleave",function(e){var i,a=this,o="add";"mouseleave"===e.type&&(o="remove",i=t.query("li",a),t[o+"Class"].call(a,i,"selected"),t.addClass.call(a,i[0],"selected")),t[o+"Class"].call(a,".search-triggers","triggers-hover")});var u=e.all(".J_SearchTab");u.on("mouseenter",function(e){var i=this,a=t.siblings(i);t.addClass(i,"selected"),t.removeClass(a,"selected")}),u.on("click",function(e){var i=this,a=t.parent(i),o=t.children(a)[0];i!==o&&(t.insertBefore(i,o),t.removeClass.call(i,".search-triggers","triggers-hover"),t.addClass.call(i,"#J_TSearchForm","search-panel-focused"),e.halt())})})}}},{requires:["node"]}),KISSY.add("cart/utils/storage/storage",function(e,t){function i(){try{return c in n&&n[c]}catch(e){return!1}}function a(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(r),u.appendChild(r),r.addBehavior("#default#userData"),r.load(c);var i=e.apply(s,t);return u.removeChild(r),i}}function o(e){return e.replace(h,"___")}var r,n=window,s={},l=n.document,c="localStorage",d="script";if(s.disabled=!1,s.set=function(e,t){},s.get=function(e){},s.remove=function(e){},s.clear=function(){},s.transact=function(e,t,i){var a=s.get(e);null==i&&(i=t,t=null),"undefined"==typeof a&&(a=t||{}),i(a),s.set(e,a)},s.getAll=function(){},s.forEach=function(){},s.serialize=function(e){return t.stringify(e)},s.deserialize=function(e){if("string"==typeof e)try{return t.parse(e)}catch(i){return e||void 0}},i())r=n[c],s.set=function(e,t){return void 0===t?s.remove(e):(r.setItem(e,s.serialize(t)),t)},s.get=function(e){return s.deserialize(r.getItem(e))},s.remove=function(e){r.removeItem(e)},s.clear=function(){r.clear()},s.getAll=function(){var e={};return s.forEach(function(t,i){e[t]=i}),e},s.forEach=function(e){for(var t=0;t<r.length;t++){var i=r.key(t);e(i,s.get(i))}};else if(l.documentElement.addBehavior){var u,p;try{p=new ActiveXObject("htmlfile"),p.open(),p.write("<"+d+">document.w=window</"+d+'><iframe src="/favicon.ico"></iframe>'),p.close(),u=p.w.frames[0].document,r=u.createElement("div")}catch(m){r=l.createElement("div"),u=l.body}var h=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");s.set=a(function(e,t,i){return t=o(t),void 0===i?s.remove(t):(e.setAttribute(t,s.serialize(i)),e.save(c),i)}),s.get=a(function(e,t){return t=o(t),s.deserialize(e.getAttribute(t))}),s.remove=a(function(e,t){t=o(t),e.removeAttribute(t),e.save(c)}),s.clear=a(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(c);for(var i,a=0;i=t[a];a++)e.removeAttribute(i.name);e.save(c)}),s.getAll=function(e){var t={};return s.forEach(function(e,i){t[e]=i}),t},s.forEach=a(function(e,t){for(var i,a=e.XMLDocument.documentElement.attributes,o=0;i=a[o];++o)t(i.name,s.deserialize(e.getAttribute(i.name)))})}try{var f="__storejs__";s.set(f,f),s.get(f)!=f&&(s.disabled=!0),s.remove(f)}catch(m){s.disabled=!0}return s.enabled=!s.disabled,s},{requires:["json"]}),KISSY.add("cart/utils/add2cart/add2cart",function(e,t,i,a,o){var r=t.all;return{addItem:function(e,t){var n=o.now();i({url:"/cart/addCartItems.do",data:{_tb_token_:r("#_tb_token_").val(),add:JSON.stringify({tpId:parseInt(Global.cfg.tpId,10),items:[{itemId:e.item_id,skuId:e.sku_id,quantity:e.quantity||1}]})},dataType:"jsonp",success:function(e){var i=null;if(e.success){try{o.retSuccess("/cart/addCartItems.do",o.now()-n)}catch(r){}Global.reload()}else i="CART_ITEM_HAS_SKU_MUST_CHOSE_SKU"===e.errorCode?"\u65e0\u6cd5\u52a0\u5165\u8d2d\u7269\u8f66\uff0c\u8bf7\u5230\u8be5\u5546\u54c1\u9875\u9762\u6dfb\u52a0":e.error||"\u52a0\u5165\u8d2d\u7269\u8f66\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5";if(i){a.alert(i);try{o.retError("/cart/addCartItems.do",o.now()-n,"add item to cart exception")}catch(r){}}return t&&t(i)},error:function(e,i,r){a.alert("\u52a0\u5165\u8d2d\u7269\u8f66\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"),t&&t("\u52a0\u5165\u8d2d\u7269\u8f66\u5931\u8d25");try{o.retError("/cart/addCartItems.do",o.now()-n,r)}catch(s){}}})}}},{requires:["node","ajax","../dialog/dialog","../../mods/global/retcode"]}),KISSY.add("cart/mods/global/relative/sm-rec",function(e,t,i){var a=t.all,o=!1;return{init:function(){if(!o){var t=a("#J_RecTabs");t&&t.length&&(e.use("gallery/switchable/1.3.1/",function(e,t){switchable=new t.Tabs("#J_RecTabs",{switchTo:0,navCls:"recTabsNav",contentCls:"recTabsContent",activeTriggerCls:"recTabsNavActive"})}),t.all("a.j_AddCart").addClass("J_CartPluginTrigger"),e.use("tbc/add-to-cart/1.3.9/",function(e,o){function r(e,t){for(var i=e.split("&"),a=0;a<i.length;a++){var o=i[a].split("=");if(o[0]==t)return o[1]}return null}window.CartPlugin||(window.CartPlugin={}),window.CartPlugin.add2Cart=i.addItem,window.CartPlugin._validItemUrl=function(t){if(t&&e.isString(t)){var i=r(t,"id")||r(t,"item_id");if(i)return{itemId:i,isChaoshi:t.indexOf("chaoshi.")>-1}}},o.init(t,{preventAll:!0}),a("body").on("addToCartSuccess",function(e){a(".J_find_similar.open").length||setTimeout(function(){Global.reload()},100)})}),o=!0)}}}},{requires:["node","../../../utils/add2cart/add2cart"]}),KISSY.add("cart/mods/global/chaoshi/address.tpl",function(e,t,i){var a=(t.all,'<ul class="j_Address address">{{#each areas as area}}<li><b code="{{area.province.code}}">{{area.province.text}}</b><span>{{#each area.cities as city}}<a {{#if city.code == value}}class="selected"{{/if}} href="javascript:;" code="{{city.code}}">{{city.text}}</a>{{/each}}</span></li>{{/each}}</ul>');return i(a)},{requires:["node","gallery/template/1.0/"]}),KISSY.add("cart/mods/global/chaoshi/address",function(e,t,i,a,o){function r(e){r.superclass.constructor.call(this,e||{}),this.get("autoInit")&&this.init()}return e.extend(r,a,{pluginInitializer:function(){this.init()},init:function(){this._render(),this._bindEvents()},_render:function(){var e=this._extractData();if(o&&e){var i=o.render(e),a=t.create(i),r=this.get("container");t.append(a,r),this.set("el",this._node=a)}},_extractData:function(){var e=this.get("broadcast"),t=this.get("channel"),i=this.get("data");return e&&e.fire&&(i=e.fire("address."+t+"extractdata")||i),i},_bindEvents:function(){var e=this._node,a=this;e&&i.delegate(e,"click","a",function(i){i.preventDefault();var o=i.currentTarget,r=t.attr(o,"code"),n=t.text(o),s=a.get("broadcast"),l=a.get("channel");s&&s.fire&&s.fire("address."+l+"itemclick",{city:{code:r,text:n||""},currentTarget:o,el:e})})}},{ATTRS:{pluginId:{value:"address"},container:{value:"",setter:function(e){return t.get(e)}},el:{value:"",setter:function(e){return t.get(e)}},broadcast:{value:null},channel:{value:"",setter:function(t){return e.isString(t)&&t?t+".":""}},autoInit:{value:!0},data:{value:{areas:[{province:{text:"\u6c5f\u82cf",code:"1000"},cities:[{text:"\u5357\u4eac",code:"1001"},{text:"\u5f90\u5dde",code:"1002"},{text:"\u5e38\u5dde",code:"1003"}]}]}}}}),r},{requires:["dom","event","base","./address.tpl"]}),KISSY.add("cart/mods/global/chaoshi/area",function(e,t,i,a,o,r){var n=t.all;return{init:function(){i({url:"//chaoshi.tmall.com/site/getSmSiteInfo.htm",dataType:"jsonp",success:function(t){function i(){l!==!0&&(l=!0,e.use("mui/searchbar/instance/chaoshi",function(e,i){i.build({extraParams:{user_id:t.current.sellerId,cat:"50514008"},autoFocus:!0})}),r.remove(),a.detach("mouseenter",i),o.detach("keydown",i))}if(t&&t.sites&&t.current&&t.current.areaId){e.each(t.sites,function(e){if(e.areas&&e.areas[t.current.areaId])return n("h3","#J_AreaSelector").html(e.siteName+"&nbsp;"+e.areas[t.current.areaId].areaName),!1});var a=n("#mallSearch");if(!a||0===a.length)return!1;var o=n("#mq"),r=n("label",a),s="\u641c\u7d22\u5929\u732b\u8d85\u5e02\u5546\u54c1";e.trim(o.val())||(r.css("visibility","visible"),r.html(s)),n('<input type="hidden" name="user_id" value="'+t.current.sellerId+'"/>').insertAfter(o);var l=!1;a.on("mouseenter",i),o.on("keydown",i)}}})}}},{requires:["node","ajax","dom","event","./address"]}),KISSY.add("cart/mods/global/chaoshi/chaoshi",function(e,t,i){t.all;return{init:function(){Global.cfg.tpId>0&&i.init()}}},{requires:["node","./area"]}),KISSY.add("cart/mods/global/relative/recommend",function(e,t,i,a){function o(){var t=Global.getCart();if(t){var i=t.getItems(null,20),a=[];return e.each(i,function(e){a.push(e.itemId)}),a.join(",")}return""}var r="recentViewItemList",n="interestItemList",s="recentFavItemList",l=function(e,t){if(e.indexOf(".taobaocdn.")===-1){for(var i=0,a=0,o=e.length;a<o;a++)i+=e.charCodeAt(a);i%=4,i+=2,e="//img.alicdn.com/"+(t||"tps")+"/i"+i+"/"+e}return e},c=!1,d=!1,u={init:function(){var a=this;if(a.container=t.get("#interested"),a.container){t.addClass(a.container,"recommendBox"),a.container.innerHTML='<div class="hd"><h2><span>Tmall\u4e3a\u60a8\u63a8\u8350</span></h2><ul class="recommendNav"><li data-idx="0" class="'+r+'">\u6700\u8fd1\u6d4f\u89c8\u8fc7\u7684\u5546\u54c1</li><li data-idx="1" class="'+n+'">\u60a8\u53ef\u80fd\u611f\u5174\u8da3\u7684\u5546\u54c1</li><li data-idx="2" class="'+s+'">\u6700\u8fd1\u6536\u85cf\u7684\u5546\u54c1</li></ul></div><div class="bd"><div class="recommendCont '+r+'"></div><div class="recommendCont '+n+'"></div><div class="recommendCont '+s+'"></div></div>',t.show(a.container),a.carousels=[],a.triggers=t.query("li",a.container),a.panels=t.query("div.recommendCont",a.container),a.length=a.triggers.length,i.on(a.triggers,"click",function(){d=!0,a.switchTo(t.attr(this,"data-idx")-0)}),a.isMouseFocusInPanel=!1,i.on(a.container,"mouseover mouseout",function(e){a.isMouseFocusInPanel="mouseover"===e.type}),a.loadedMod={};var l=e.now(),c=o();e.each(["appId=03038&callback=recommend.renderRecentFavList","appId=03004&callback=recommend.renderRecentViewItemList","appId=03005&callback=recommend.renderInterestItemList"],function(t){e.getScript("//ald.taobao.com/recommend.htm?"+t+"&t="+l+e.guid()+"&itemIds="+c)})}},renderRecentFavList:function(e){this.render(s,e)},renderRecentViewItemList:function(e){this.render(r,e)},renderInterestItemList:function(e){this.render(n,e)},render:function(i,a){if(!e.isArray(a)||0===a.length)return!1;var o=this.container,r=t.get("div."+i,o),s=t.get("li."+i,o);r.innerHTML="<textarea> "+this.renderList(a)+" </textarea>",r.style.display="block",s.style.display="block",t.data(s,"loaded",!0);var l=a[0].area_url;return l&&t.attr(s,"data-area-url",l),c||(c=!0,d=!0,this.container.style.display="block"),n in this.loadedMod||this.switchTo(i),this.loadedMod[i]=!0,!0},switchTo:function(e){if("string"==typeof e){var i=t.get("li."+e,this.container);if(!i)return;e=t.attr(i,"data-idx")-0}if(!(e>=this.length||e==this.idx)){this.checkLazyload(e),this.prevTrigger&&(t.removeClass(this.prevTrigger,"curNav"),this.prevPanel.style.display="none"),this.prevTrigger=this.triggers[e],this.prevPanel=this.panels[e],this.idx=e;for(var o=this.carousels,r=0,n=o.length;r<n;r++){var s=o[r];s.panelIdx===e?s.start():s.stop()}t.addClass(this.prevTrigger,"curNav"),this.prevPanel.style.display="block";var l=t.attr(this.prevTrigger,"data-area-url");l&&(a.track({url:l}),t.attr(this.prevTrigger,"data-area-url",""))}},autoNext:function(){if(!this.isMouseFocusInPanel&&d){for(var e=this.idx,i=this.length;;){e++,e>=i&&(e=0);var a=this.triggers[e];if(t.data(a,"loaded"))break}this.switchTo(e)}},checkLazyload:function(i){var a=this,o=this.panels[i],r=t.get("textarea",o);if(r)if(o.innerHTML=r.value,t.get("ul.ks-switchable-nav",o))e.use("gallery/switchable/1.3.1/,gallery/datalazyload/1.0.1/",function(e,t,r){var n=new t.Carousel(o,{effect:"scrollx",easing:"easeOutStrong",viewSize:[915,297],circular:!0,prevBtnCls:"prev",nextBtnCls:"next",steps:5,interval:5,autoplay:!0,nativeAnim:!1,lazyDataType:"img-src"});n.on("beforeSwitch",function(e){0!==e.toIndex||a.isMouseFocusInPanel||a.autoNext()}),n.panelIdx=i,a.carousels.push(n)});else{var n={panelIdx:i,paused:!1,stop:function(){this.timer&&clearInterval(this.timer),this.paused=!0},start:function(){var e=this;e.stop(),e.paused=!1,e.timer=setInterval(function(){e.paused||a.autoNext()},5e3)}};n.start(),a.carousels.push(n)}},renderHeader:function(e){return'<li data-url="#">'+e+"</li>";
},renderList:function(e){for(var t=[],i=0,a=e.length;i<a;i++){var o=e[i];o.url=o.url.replace(".N","."+i);var r='<li><p class="img"><a target="_blank" href="'+o.url+'" title="'+o.title+'"><img '+(i<5?"src":"data-ks-lazyload-custom")+'="'+l(o.img)+'" alt="'+o.title+'"/></a></p>';r+=o.promotion_price?'<p class="price"><strong>'+o.promotion_price+"</strong><del>"+o.price+"</del>":'<p class="price"><strong>'+o.price+"</strong>",r+="</p>",r+='<p class="title"><a target="_blank" href="'+o.url+'" title="'+o.title+'">'+o.title+"</a></p>";var n="weekly_sell"in o,s="commentNum"in o;(n||s)&&(r+='<p class="summary">',n&&(r+="\u5468\u9500\u91cf:<b>"+o.weekly_sell+"</b>"),s&&(r+='<a target="_blank" title="'+o.commentNum+'\u4e2a\u8bc4\u8bba" class="commentUrl" href="'+o.url+'&on_comment=1&J_TabBar">\u603b\u8bc4\u8bba:'+o.commentNum+"</a>"),r+="</p>"),r+="</li>",t.push(r)}if(t='<div class="recommendList"><ul class="ks-switchable-content">'+t.join("")+"</ul></div>",5<a){for(var c=['<li class="ks-active">&bull;</li>'],d=Math.ceil(a/5)-1;d;)d--,c.push("<li>&bull;</li>");t+='<div class="trigger prev"><s></s></div><div class="trigger next"><s></s></div><ul class="ks-switchable-nav">'+c.join("")+"</ul>"}return t}};return window.recommend=u,u},{requires:["dom","event","../makepoint/makepoint"]}),KISSY.add("cart/mods/global/toolbar",function(e){var t=Global.cfg.guiServer;return KISSY.config({modules:{"toolbar/toolbar":{requires:["./toolbar.css"]}},packages:{toolbar:{base:t+"/tb/toolbar/0.0.3/",ignorePackageNameInUri:!0}}}),{init:function(){KISSY.use("toolbar/toolbar",function(e,t){t.config("feedback",{url:"//survey.taobao.com/survey/QwE0mTiCx?type=3"}),Global.toolbar=new t({items:[{},{list:["pk","feedback","gotop"]}]}),Global.toolbar.render()})}}},{requires:[]}),KISSY.add("cart/mods/global/makepoint/udata",function(e){return{init:function(){e.getScript("//g.alicdn.com/alilog/mlog/xwj.js",function(){try{window._ap_xwj&&_ap_xwj.monitor("201409103146532264",{"sample_rate\u201d:0.01,\u201ddead_line":14259168e5})}catch(e){}})}}},{requires:[]}),KISSY.add("cart/mods/global/makepoint/performance",function(e){function t(e,t){return Math.floor(Math.random()*(t-e))+e}var i=window;return{init:function(){66===t(1,100)&&i.goldlog&&i.goldlog.record&&Global.cfg.from&&Global.cfg.sourceTime&&i.goldlog.record("/xn.10.10","","name="+Global.cfg.from+"_cart&st="+Global.cfg.sourceTime+"&lt="+window.g_config.startTime+"&ft="+e.now(),"H1733390")}}}),KISSY.add("cart/mods/global/other",function(e,t,i,a,o,r,n,s,l,c,d,u,p,m,h,f,g,_,v){var I=t.all;return{init:function(){if(e.ready(function(){i.init(),Global.cfg.period>=2&&a.init(),e.later(function(){n.init(),"TB"!==Global.cfg.layout&&"CUNTAO"!==Global.cfg.layout||s.init(),f.init(),g.init()},100),I(document).on("click",function(e){Global.broadcast("hidePopup",{ev:e,type:"click"})});var t=I("#_tb_token_").val();t||(e.log("[Cart] can not find _tb_token_ in this html file!!","error"),Global.utils.logger("other","error","DO NOT have _tb_token_ in the html!!"));new _;"taobao"===Global.cfg.domain&&v.init(null,{successTip:"\u6dfb\u52a0\u6210\u529f\uff01\u82e5\u5546\u54c1\u672a\u51fa\u73b0\u5728\u8d2d\u7269\u8f66\u91cc\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01"}),I("body").on("addToCartSuccess",function(e){if(e.data){var t=e.data.triggerEl,i=e.data.itemId;if(Global&&(Global.hasAddToCart||(Global.hasAddToCart=[]),Global.hasAddToCart.push(parseInt(i,10))),I(t).hasClass("pool-add-cart")){var a=I(t).attr("order"),o=Global.getCart(),r=null;o&&o.orders&&(r=o.orders[a]),Global.request({updateUnselect:!0,operate:{itemId:e.data.itemId,quantity:e.data.quantity,cartId:e.result.addedCartIds,skuId:e.data.skuId},quantity:e.data.quantity,orders:r,type:"check",from:"add_tiny_cart",silent:!0,success:function(e){},error:function(e){e.message&&self._addError(e.message)}})}if(I(t).hasClass("fsi-addtocart")){var n=I(t).parent(".find-similar-item");n.hasClass("hasshop")&&n.removeClass("hasshop"),n.addClass("addedtocart")}}}),KISSY.UA.ie<8&&I("body").addClass("hidefindsimilar"),I(window).on("resize",function(){I(".J_find_similar.open").length&&(I(".J_find_similar.open .find-similar-body").html('<img src="//gtd.alicdn.com/tps/i2/T1Q2BUXaxFXXXXXXXX-32-32.gif" class="find-similar-loading" />'),I(".J_find_similar.open").removeClass("open").addClass("close"))})}),g_config&&g_config.startTime){var t=(e.now()-g_config.startTime)/1e3;e.log("[Cart] load time: "+t),Global.utils.goldlog("cart3-onload_time",{loadTime:t,useVmData:1})}},renderFooter:function(){"tmall"===Global.cfg.domain?m.init():o.init(),u.init(),l.init()}}},{requires:["node","./makepoint/makepoint","./sidefloat/sidefloat","./relative/relative","./banner/banner","./banner/ljms-banner","./search/search","./footer/footer","./plugin","../../utils/storage/storage","./relative/sm-rec","./chaoshi/chaoshi","./relative/recommend","./toolbar","./makepoint/udata","./makepoint/performance","tbc/doctor/0.2.0/","tbc/add-to-cart/1.3.9/"]}),KISSY.add("cart/mods/global/lazyload",function(e,t,i){function a(e,i){i=i||1e3;var a=t.get(e);if(null===a)return!1;for(;a!=document&&--i;)if(a=a.parentNode||a.parentElement,null==a)return!1;return!0}function o(){l=t.viewportHeight()+ +u+t.scrollTop()}function r(e){function i(i){t.attr(e,"src",i),t.addClass(t.parent(e,".J_ItemPic"),"img-loaded"),t.removeAttr(e,"lazyload")}var a=t.attr(e,"lazyload");if(a){var o=new Image;o.onerror=function(){i("//assets.alicdn.com/p/fp/2011a/assets/space.gif")},o.onload=function(){i(o.src)},o.src=a}}function n(i){var o=i[0];if(!o)return e.log(c+"el not exists."),!1;if(!a(o))return e.log(c+"el not in document."),!1;var n=t.offset(o).top<=l;return n&&("img"===t.nodeName(o)?r(o):i[1].call(i[2])),!n}function s(){if(d.length){o();var t=d.length;d=e.filter(d,n),t!==d.length&&e.log(c+"loadEls, old length: "+t+", new length: "+d.length||0)}else e.log(c+"cache empty.")}var l,c="[lazyload] ",d=[],u=200;return function(t,i,a){var r=e.makeArray(arguments);if(0===r.length)s();else{if(!t)return void i.call(a);o();var l=n(r);l&&d.push(r)}}},{requires:["dom","event"]}),KISSY.add("cart/mods/global/queue",function(e){var t="[queue] ",i=[],a=!1;return{add:function(o,r,n){r=r||window,n=n||[];var s=function(){a=!0,o.apply(r,n)};a===!0||i.length>0?(e.log(t+"processing... add it to queue."),i.push(s)):s()},next:function(){a=!1,this.flush()},flush:function(){if(i.length>0&&a===!1){var e=i.shift();e&&e()}}}}),KISSY.add("cart/mods/global/core",function(e,t,i,a,o,r,n,s,l,c,d,u,p,m){var h="[Global] ",f=window,g=e.mix({},i.Target),_={},v={GLOBAL_RENDERONCE:"G_RenderOnce",GLOBAL_SHOWCLEARINVAILD:"G_ShowClearInvalid",GLOBAL_RECORDUNDO:"G_RecordUndo",USER_RELOCATEBAR:"U_RelocateBar"},I=null,T=null,S=null,b=null,E=!!~location.hostname.indexOf("daily.taobao.net"),C=!!~location.hostname.indexOf("unit."),y=E?".daily.taobao.net":".taobao.com";return e.mix(Global,{init:function(t){var a=this;a.isScrolling=!1;var o="normal",r=parseInt(Global.cfg.type,10);switch(r){case 1:o="promo";break;case 2:o="newPromo";break;case 4:o="lowAmount";break;case 5:o="villager"}var n=Global.firstData;n&&n.success===!0&&(0===n.globalData.totalSize||n.globalData.totalSize>0&&n.globalData.tpId>0&&n.list&&0===n.list.length)&&(o="empty"),i.on(window,"scroll resize",function(){b&&b.cancel(),b=e.later(Global.lazyload,100)}),I=s.create({type:o,extStatus:r}),c.init()},broadcast:function(t,i){return e.log("[global]:broadcast event:"+t),_[t]=i,g.fire(t,i)},listen:function(t,i){g.on(t,i),_[t]&&i.call(this,e.mix(_[t],{target:this,type:t}))},detach:function(e,t){g.detach(e,t)},request:function(e){return l.call(this,e,I)},Evt:v,updateCart:function(t){t=t||{},T&&clearTimeout(T),T=setTimeout(function(){e.log(h+"start to update."),I.update(t),Global.lazyload(),Global.utils.light()},150)},getSelectedItemsLength:function(){return I.getSelectedItemsLength()},getItemByCartId:function(e){return I.getItemByCartId(e)},addSelectedItems:function(t){e.each(e.makeArray(t),function(e){e&&I.addSelectedItem(e)})},removeSelectedItems:function(t){e.each(e.makeArray(t),function(e){e&&I.removeSelectedItem(e)})},selectAll:function(){I.select()},unselectAll:function(){I.unselect()},getViewPortPage:function(){var i=t.scrollTop(f),a=null,o="",r="",n=0;return e.each(I.orders,function(e){if(a=e,e.orderEl.scrollTop()>=i)return o=e.data.startTime,r=e.data.endTime,n=e.data.page,!1}),r||(o=a.data.startTime,r=a.data.endTime,n=a.data.page),{startTime:o,endTime:r,page:n}},utils:{isDaily:E,tbPath:y,cartPath:(C?"unit.":"")+"cart"+y,toMoney:function(e,t){return t=parseInt(t,10)||100,e=parseFloat(e),parseFloat(e/t).toFixed(2)},removePicSuffix:function(e){return e.replace(/_(sum|\d{2,5}x\d{2,5})\.jpg$/,"")},light:function(){"undefined"!=typeof Light?Light.light():(S&&clearTimeout(S),S=setTimeout(function(){Global.utils.light(),e.log("[global] retry light.")},1e3))},isEmpty:function(e){for(var t in e)if(void 0!==t&&void 0!==e[t]&&null!==e[t])return!1;return!0},makepoint:function(e){u.track({data:"tbcart."+e})},goldlog:function(t,i){if(i){var a=n.shell;i.browser=a+(a?" "+n[a]:""),i.os=n.os,i.mobile=n.mobile,i.href=location.href,Global.globalData&&(i.cartSize=Global.globalData.totalSize),Global.cfg.client&&(i.client=Global.cfg.client)}f.goldlog&&goldlog.emit?goldlog.emit(t,i):u.track("ued.1.1.2?type=9&_gm:id="+t+(i?"&"+e.param(i):""))},jstracker:function(e,t,i,a){return!0},logger:function(e,t,i){var a=m.getLogger(e);a.log(t,e,i)}},lazyload:d,renderFooter:function(){c.renderFooter()},switchCart:function(e){"undefined"==typeof e&&(e="normal"),Global.globalData=null,I&&I.destroy&&I.destroy(),I=s.create({type:e})},empty:function(){"promo"===I.type?I.switchToNormal():Global.switchCart("empty")},temp:{},resetTemp:function(){e.each(Global.temp,function(e,t){Global.temp[t]=void 0})},queue:p,getCart:function(){return I},getCartType:function(){return I.type||"normal"},execCart:function(e,arguments){var t;return I&&I[e]&&(t=I[e].apply(I,arguments)),t},reload:function(){I&&"empty"===I.type&&location.reload(),this.switchCart(),t.scrollTop(0)}}),Global},{requires:["dom","event","ajax","cookie","json","ua","../cart/cartFactory","./request","./other","./lazyload","./makepoint/makepoint","./queue","tbc/log/0.4.2/index"]}),KISSY.add("cart/mods/global/layout",function(e,t,i,a){var o=t.all,r='<div id="J_FilterBar" class="cart-filter-bar"><ul id="J_CartSwitch" class="switch-cart"></ul><div class="cart-sum"><span class="pay-text">'+a.lang("SELECTED_ITEMS")+'</span><strong class="price"><em id="J_SmallTotal">0.00</em></strong><a id="J_SmallSubmit" class="submit-btn submit-btn-disabled">'+a.lang(Global.cfg.isYaoPartner?"SUBMIT_LIST":"CHECKOUT_BIG")+'</a></div><div class="wrap-line"><div class="floater" style="width: 0;"></div></div></div><div id="J_CartMain" class="cart-main"><div class="cart-table-th"><div class="wp"><div class="th th-chk"><div id="J_SelectAll1" class="select-all select-all-disabled J_SelectAll"><div class="cart-checkbox"><input class="J_CheckBoxShop" id="J_SelectAllCbx1" type="checkbox" name="select-all" value="true" /><label for="J_SelectAllCbx1">'+a.lang("SELECT_ALL_ITEMS")+"</label></div>&nbsp;&nbsp;"+a.lang("TH_SELECT_ALL")+'</div></div><div class="th th-item"><div class="td-inner">'+a.lang("TH_ITEM_INFO")+'</div></div><div class="th th-info"><div class="td-inner">&nbsp;</div></div><div class="th th-price"><div class="td-inner">'+a.lang("TH_UNIT_PRICE")+'</div></div><div class="th th-amount"><div class="td-inner">'+a.lang("TH_QUANTITY")+'</div></div><div class="th th-sum"><div class="td-inner">'+a.lang("TH_AMOUNT")+'</div></div><div class="th th-op"><div class="td-inner">'+a.lang("TH_OPERATION")+'</div></div><div class="th th-vil hidden"><div class="td-inner">'+a.lang("TH_VILLAGER")+'</div></div></div></div><div id="J_OrderList" data-spm="1997196601"></div><div id="J_Loading" class="loading-bar"><p>'+a.lang("TIPS_LOADING")+'</p></div></div><div id="J_FloatBarHolder" class="float-bar-holder"></div><div id="J_FloatBar" class="float-bar clearfix"></div>';return{init:function(){o("#J_Cart").addClass(".cart").html(i(r))}}},{requires:["node","../../utils/tpl/render","../../utils/i18n/i18n"]}),KISSY.add("cart/cart",function(e,t,i,a){return{init:function(){t.all("body").addClass(Global.cfg.lang),Global.cfg.isCuntaoPartner&&t.all(".cart-logo>a").attr("href","//cun.taobao.com"),a.init(),i.init()}}},{requires:["node","./mods/global/core","./mods/global/layout"]});