KISSY.add("mui/searchbar/instance/detail",function(e,a,r,t,i,o,n,s,u,c,l,m,h,p,d,g,b,f){var v=window,C=v.g_config||{},w=C.bizId||"",x=C.sysId||"detail",y=C.devId||"pc",q=w+"."+x+"."+y,S="//suggest.taobao.com/sug",_=(new b).getCurBt(),k=i.get("unb")||"",I=i.get("tracknick")||"";i.get("login");return window._CTK3417=window._CTK3417||function(){function e(e){var a,r,t,i=0;if(0===e.length)return i;for(a=0,t=e.length;a<t;a++)r=e.charCodeAt(a),i=(i<<5)-i+r,i|=0;return i}var a={},r="",t=0;return function(i,o,n,s){function u(a,r){var i="undefined"+t++,o=window[i]=new Image;o.onload=o.onerror=function(){window[i]=null};var n=["type="+encodeURIComponent(s.type||"normal"),"name="+encodeURIComponent(a),"parent="+encodeURIComponent(r||""),"module="+encodeURIComponent(s.dataId||"30"),"msg="+encodeURIComponent(s.msg||""),"version="+encodeURIComponent("3.3.30"),"sample="+g,"time="+(m>0?m:0)].join("&");o.src="//gm.mmstat.com/tmjs.1.1?"+n+"&hash="+e(n)}if(s=s||{},s.reject){"object"!=typeof s.reject&&(s.reject=[s.reject]);for(var c=s.reject.length-1;c>=0;c--)if(a[s.reject[c]])return}r||(r=o);var l=(new Date).valueOf();a[o]=l;var m;if(o==r){var h=window.g_config&&g_config.startTime;m=h?l-h:0}else m=l-(a[n||r]||a[r]);switch(s.autoGroup){case"time":s.group=s.autoGroup+"_"+(m<=0?0:Math.floor(Math.log(m)/Math.log(2)))}"object"==typeof i&&(i=i[s.group||"_"]||Math.round(Math.log((undefined||8192)/(undefined||1/16))/Math.log(2)));var p=null,d=p&&p[Math.floor((l+288e5)/6e5)%144]||1,g=Math.round(Math.max(Math.pow(2,i)*d/(undefined||8192),1));Math.floor(Math.random()*g)>0||(s.group&&u(o+"|"+s.group,o),u(o,n))}}(),_CTK3417(30,"codetrack.init"),{"build":function(i){if(3==arguments.length||2==arguments.length){var b=arguments[0],v=arguments[1],w=arguments[2];i={},i.node=b,i.inShopAction=v,i.inShopBtn=w}i=i||{};var y=i.node||"#mq",M=i.inShopAction||"",T=i.inShopBtn,j=!!i.autoFocus,U=i.extraParams,B=i.placeholder||{},N=i.query||o.UNKNOWN,P=i.nid,K="//suggest.taobao.com/sug?area=b2c&code=utf-8&k=1&src=tmall_pc",E="detail"!=x,R=i.time||0;S+=E?"?area=tmall-hq&src=userid_"+P:"?area=getdetailsuggest&nid="+P,S+="&u="+I+"&userid="+k+"&bucketid="+_,!!(C.searchbarCfg=C.searchbarCfg||{}).isTestBt&&(K=K.replace(/\barea=b2c\b/gi,"area=b2c_bts"));var D=a.one(y),A=D?D.parent("form"):undefined,O=A?A[0].redirect:undefined,L=O?O.value:"",$=new s({"text":B.text||"\u641c\u7d22 \u5929\u732b \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa","query":B.query||"","redirectUrl":B.redirectUrl||L}),F=B.cfgTMSUrl||S;if(window.shopSearchStartTime&&window.shopSearchEndTime&&R){var W,V;try{W=new Date(shopSearchStartTime).getTime()||0,V=new Date(shopSearchEndTime).getTime()||0,!E&&R>=W&&R<=V&&(F=!1)}catch(Y){_CTK3417(0,"error:suggestSearchTime.error","detail",{"_t":0,"type":"error"})}}var G=new g;G.set("container",A.parent()),F&&r({"url":F,"success":function(a){if(a.success){if(a.model&&a.model.placeholder&&$.update(a.model.placeholder[0]),E)G.set("data",a.model.list);else if(a.result&&a.result[0]&&a.result[0].record&&a.result[0].record[0]){var r=[];e.each(t.parse(a.result[0].record[0].detail_value||"").result,function(e,a){var t=e[0].split("|");r.push({"query":t[0],"cat":t[1]})}),G.set("data",r)}}else $.update(a)},"scriptCharset":"utf-8","dataType":"jsonp"});var H=new o({"plugins":[$,new n({}),new u({"action":M||"","button":T||"#J_CurrShopBtn"}),G],"sugConfig":{"url":K,"node":y||"#mq","autoFocus":j,"autoExpand":!0,"extraParams":U||{}},"templates":{"act":c,"meetingPlace":f,"shipShop":l,"cat":m,"list":h,"shop":p,"quickSearch":d},"query":N,"acceptCharset":"gbk","dim":q,"log":{"pageType":1}});return _CTK3417(30,"app.init"),_CTK3417(30,"detail","app.init",{"group":location.hostname}),H}}},{"requires":["node","ajax","json","cookie","mui/searchbar/base","mui/searchbar/plugin/spm","mui/searchbar/plugin/placeholder","mui/searchbar/plugin/inShop","mui/searchbar/template/act","mui/searchbar/template/shipShop","mui/searchbar/template/cat","mui/searchbar/template/list","mui/searchbar/template/shop","mui/searchbar/template/quickSearch","mui/searchbar/plugin/hq4Pc","mui/bucket/index","mui/searchbar/template/meetingPlace","mui/searchbar/suggest.css"]});KISSY.version>=1.4&&KISSY.config({"modules":{"sizzle":{"alias":["node"]},"rich-base":{"alias":["base"]},"ajax":{"alias":["io"]}}}),KISSY.add("mui/searchbar/base",function(S,Node,RichBase,D,ComboBox,UA,Cookie,E,IO){function makeCacheNum(){return Math.floor(268435456*Math.random()).toString(16)}var TIP="\u8bf7\u8f93\u5165\u641c\u7d22\u6587\u5b57",UNKNOWN="unknown",VALUE="{VALUE}",ltIE9=UA.ie<9,win=window,SearchBar=RichBase.extend([],{"initializer":function(){this._initComboxBox(),this._bindSubmitEvent(),this._other(),this._loadConfig()},"_initComboxBox":function(){var e=this,t=e._buildDataSourceCfg(),a=new ComboBox.RemoteDataSource(t),o=e._buildComboBoxCfg(a),r=e.comboBox=new ComboBox(o),i=r.sendRequest;r.sendRequest=function(t){t=S.trim(t),!1!==e.fire("beforeQueryChange",{"query":t})&&i.call(this,t)},r.normalizeData=function(e){var t,a=this;return t=a.get("format")?a.get("format").call(a,(a.getValueInternal||a.getValueForAutocomplete).call(a),e):[],t.slice(0,a.get("maxItemCount"))},r.render(),e._bindComboBoxEvents()},"_buildDataSourceCfg":function(){var e=this.get("sugConfig"),t=this.get("dataSourceCfg");return t.xhrCfg.url=e.url,t.parse=S.bind(this._parse,this),t},"_parse":function(e,t){var a=this.fire("beforeParse",{"data":t,"query":e});return!1===a?null:(a&&(t=a),t)},"_bindComboBoxEvents":function(){var e=this,t=this.get("templates"),a=this.get("log"),o=function(o){var r=D.children(o),i=D.attr(r,"data-tpl"),n=t[i],s=S.unparam(D.attr(r,"data-params")||""),u=S.merge(e.get("options"),{"$query":S.escapeHTML(e.curQuery),"$pageType":a.pageType,"$index":D.attr(r,"data-index")||"1","$isMobile":a.isMobile});n&&e.clicklog((n.genAtpanel||function(e,t){return S.substitute(n.atpanel,t)})(r,S.merge(u,s)))};this.comboBox.on("click",function(t){var a=t.target;if(/MyIE/i.test(navigator.userAgent)){if(!t._elItem)return;a.set("el",t._elItem)}if(a&&a.get("el")&&a.get("el")[0]&&D.get(".s-mi-ship",a.get("el")[0]))return o(a.get("el")),void(location.href=D.attr(D.get(".s-mi-ship .s-mi-ship-wrap",a.get("el")[0]),"data-url"));if(!(a&&(a.get("el").hasClass(".s-hqHd-menuitem")||a.get("el").hasClass(".s-hyHd-menuitem")||a.get("el").hasClass(".s-loginHd-menuitem"))||a&&a.get("el")[0]&&D.get(".s-mi-meetingPC",a.get("el")[0])||!1===e.fire("itemClick",{"activeitem":a}))){var r=this.get("form"),i=a.get("el"),n=D.attr(D.children(i),"data-params")||"q="+e.query;n=S.merge(this.get("sugConfig").extraParams,S.unparam(n)),this.filterFormParams(n),o(i),r.fire("submit",{"ignoreClicklog":1})}},this)},"filterFormParams":function(e){var t,a,o,r,i=new RegExp("windows phone|windowsphone","i"),n=navigator.userAgent||"";if(!i.test(n))for(t=0,a=this.get("form")[0],o=a.elements,r=o.length;t<r;t++)"hidden"===o[t].type&&o[t].name&&D.attr(o[t],"disabled","disabled");this.modifyFormParams(e,1)},"modifyFormParams":function(params,forceEnable){var form=this.get("form")[0];for(var k in params)if(params.hasOwnProperty(k))if(params[k]=params[k]||"",form[k]&&"INPUT"===form[k].tagName)params[k].indexOf(VALUE)>-1?params[k]!==VALUE&&D.val(form[k],eval(params[k].replace(VALUE,form[k].value))):D.val(form[k],params[k]),Node.one(form[k]).fire("valuechange"),1==forceEnable&&D.removeAttr(form[k],"disabled");else{var value=params[k];params[k].indexOf(VALUE)>-1&&(value=params[k]!==VALUE?eval(params[k].replace(VALUE,"")):""),D.append(D.create('<input type="hidden" name="'+k+'" value="'+S.escapeHTML(value)+'"/>'),form)}},"_bindSubmitEvent":function(){function e(){t.filterFormParams(S.merge(s,{"type":"p","q":VALUE,"from":i+"_1_searchbutton"}))}var t=this,a=t.get("form"),o=t.get("input"),r=t.get("button"),i=t.get("dim"),n=t.get("log"),s=t.get("sugConfig").extraParams,u=t.get("acceptCharset");a.on("submit",function(e){var a=t.fire("beforeSubmit");!1===a&&e.halt(),e.ignoreClicklog||a===t.IGNORE_CLICK_LOG||t.clicklog(","+o.val()+","+o.val()+","+i+"-,"+n.clickId+",searchbutton,"+n.pageType+","+n.isMobile),UA&&UA.ie&&u!==UNKNOWN&&(document.charset=u)}),o.on("keydown",function(t){if(13==t.keyCode){var o=new RegExp("windows phone|windowsphone","i"),r=navigator.userAgent||"";o.test(r)?(t.preventDefault(),E.fire(a,"submit")):e()}}),r.on("click",function(t){e()})},"_buildComboBoxCfg":function(e){var t=this.get("sugConfig");return{"srcNode":this._wrapInput(t.node,t.prefixCls)||"."+t.prefixCls+"combobox","dataSource":e,"format":S.bind(this._format,this),"focused":!!t.autoFocus,"prefixCls":t.prefixCls||"ks-","hasTrigger":!1,"matchElWidth":!!t.matchElWidth,"highlightMatchItem":!1,"menu":{"align":{"overflow":{"adjustY":0}}},"cache":!0,"placeholder":t.placeholder||TIP}},"_wrapInput":function(e,t){var a=this.get("sugConfig"),o=a.enableSpeech;D.attr(e,S.merge({"class":t+"combobox-input","autocomplete":"off","role":"combobox","aria-haspopup":"true","title":TIP,"aria-label":TIP},o?{"x-webkit-speech":"","x-webkit-grammar":"builtin:translate"}:{}));var r,i=D.parent(e,".{cls}combobox".replace(/{cls}/g,t)),n=S.guid(t+"combobox-");return i?(i.id=i.id||n,r=Node.one(i)):(D.wrap(e,D.create('<div id="'+n+'" class="{cls}combobox"><div class="{cls}combobox-input-wrap"></div></div>'.replace(/{cls}/g,t))),r=Node.one("#"+n)),r},"_loadConfig":function(){var e=this;return S.ready(function(){setTimeout(function(){IO({"url":"//pages.tmall.com/wow/list/act/search-act","dataType":"jsonp","scriptCharset":"utf-8","jsonpCallback":"Jsonp_fixed_searchbar_act","success":function(t){var a=e.get("templates").act;a&&(a.text=t.text||"",a.promo="undefined"==typeof t.promo?"49218":t.promo),e&&e.fire("configInit",{"data":t})}})},0)}),!0},"_format":function(e,t){if(!t)return[];var a=this.get("templates"),o=this.get("dim"),r=[],i=this._getDate(),n=this.get("sugConfig").prefixCls,s={"$wq":S.escapeHTML(e),"$query":S.escapeHTML(e),"$index":0,"$date":i,"$prefixCls":n,"$dim":o,"$userId":t.shop_info&&t.shop_info[0]&&t.shop_info[0].user_id||""};this.set("options",s);for(var u in a)a[u]?(S.log("searchbar::to parse template:"+u+"..."),a[u].parse(r,t,S.clone(s))):delete a[u];return r},"_getDate":function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+(e.getDate()+1)},"update":function(e){for(var t,a=this.get("plugins"),o=0,r=a.length;o<r;o++)(t=a[o])&&S.isFunction(t.update)&&t.update(e)},"blur":function(){this.get("input")[0].blur()},"clicklog":function(e){var t=e.split(","),a=win.__header_atpanel_param||"",o={"pos":t[0]||"","q":t[1]||"","wq":t[2]||"","suggest":t[3]||"","clickid":t[4]||"","combo":t[5]||"","page_type":t[6]||"","is_wap":t[7]||"0","type":t[8]||5,"active":"0","search_type":"search"};a+=(S.endsWith(a,"&")?"":a?"&":"")+S.param(o),this.exposelog("/mallsearch","tmallsearch",a,"H1449172242")},"exposelog":function(e,t,a,o){if(win.goldlog&&win.goldlog.record)goldlog.record(e,t,a,o);else{var r=new Image,i="_img_"+e+"_"+(new Date).getTime();win[i]=r,r.onload=r.onerror=function(){win[i]=null},r.src="//gm.mmstat.com"+e+"?goldlog=undefined&cache="+makeCacheNum()+"&gmkey="+encodeURIComponent(t)+"&gokey="+encodeURIComponent(a)+"&cna="+(Cookie.get("cna")||""),S.log(win[i]),r=null}},"_other":function(){var e=this,t=this.get("ignoreChars"),a=new RegExp("["+t.join(",")+"]","gi"),o=this.get("input"),r=this.comboBox,i=this.get("sugConfig"),n=i.autoExpand,s=(i.prefixCls,this.get("query"));s!==UNKNOWN&&(o.attr("value",s),r.set("value",s)),o.on("keyup",function(e){e.shiftKey&&(e.keyCode<37&&16!==e.keyCode||e.keyCode>40)&&(this.value=this.value.replace(a,""))}),n&&o.on("focus",function(){r.sendRequest(S.trim(this.value))}),Node.one(window).on("resize",S.buffer(function(t){var a=e.get("menuContainer");a&&a.width(o.outerWidth())},150));var u=this.get("acceptCharset"),l=this.get("form");u!==UNKNOWN&&l.attr("accept-charset",u),!i.autoSubmitOnItemClick&&this.on("itemClick",function(){return!1}),r.on("afterCollapsedChange",function(t){t.newVal||(r.detach("afterCollapsedChange",arguments.callee),/MyIE/i.test(navigator.userAgent)&&E.delegate(D.get(".s-menu"),"click",".s-menuitem",function(t){e.comboBox.fire("click",{"_elItem":S.one(t.currentTarget)})}))}),o.on("valuechange",function(){e.curQuery=o.val()}),e.curQuery=o.val()},"_event":["beforeSubmit","beforeParse","beforeQueryChange","itemClick","restore","configInit"],"VALUE":VALUE,"IGNORE_CLICK_LOG":"{{ignore_click_log}}","UNKNOWN":UNKNOWN},{"ATTRS":{"sugConfig":{"value":{"extraParams":{},"url":"","node":"","autoFocus":!1,"autoExpand":!1,"prefixCls":"s-","placeholder":TIP,"enableSpeech":!0,"matchElWidth":!0,"autoSubmitOnItemClick":!0},"setter":function(e){var t=this.get("sugConfig");return S.mix(t,e,undefined,undefined,!0)}},"templates":{"value":{},"setter":function(e){return e}},"nodes":{"value":{}},"placeholder":{"getter":function(){var e=this.get("nodes");return e.placeholder||(e.placeholder=this.comboBox.get("placeholderEl")),e.placeholder}},"input":{"getter":function(){var e=this.get("nodes");return e.input||(e.input=this.comboBox.get("input")),e.input}},"button":{"getter":function(){var e=this,t=this.get("nodes");if("undefined"==typeof t.button){var a=this.get("form"),o=a[0].elements;S.each(o,function(t){"submit"===D.attr(t,"type")&&(e.get("nodes").button=Node.one(t))})}return!t.button&&S.log("searchbar::there isn't a button of 'submit' type in this form!","error"),t.button}},"form":{"getter":function(e){var t=this.get("nodes");return t.form||(t.form=this.get("input").parent("form")),t.form}},"container":{"getter":function(){var e=this.get("nodes");return e.container||(e.container=this.comboBox.get("el")),e.container}},"menuContainer":{"getter":function(){var e=this.get("nodes");if(!e.menuContainer){var t=this.get("menu");t&&t.get&&(e.menuContainer=t.get("el"))}return!e.menuContainer&&S.log("searchbar::at so far, popup menu for suggest is nonexistent.","warn"),e.menuContainer}},"menu":{"getter":function(){return this.comboBox.get("menu")}},"dataSourceCfg":{"value":{"xhrCfg":{"url":"","dataType":"jsonp","scriptCharset":"utf-8","data":{"code":"utf-8"}},"allowEmpty":!0,"paramName":"q","cache":!0}},"dim":{"value":".list.pc"},"log":{"value":{"pageType":"1","clickId":"topsearch","isMobile":0},"setter":function(e){var t=this.get("log");return t=S.mix(t,e,undefined,undefined,!0),t.isMobile=t.isMobile?1:0,t}},"ignoreChars":{"value":["<",">","?","\uff1f"]},"acceptCharset":{"value":UNKNOWN},"query":{"value":UNKNOWN,"setter":function(e){if(e){var t=this.get("ignoreChars"),a=new RegExp("["+t.join(",")+"]","gi");e=e.replace(a,"")}else e="";return e}}}});return SearchBar.UNKNOWN=UNKNOWN,SearchBar.VALUE=VALUE,SearchBar.IGNORE_CLICK_LOG="{{ignore_click_log}}",SearchBar},{"requires":["node","rich-base","dom","combobox","ua","cookie","event","io"]});/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("combobox/combobox-xtpl",[],function(){return function(f){var a,d=this;a=this.config.utils;var j=a.runBlockCommand,k=a.renderOutput,g=a.getProperty,h=a.runInlineCommand,e=a.getPropertyOrRunCommand;a='<div id="ks-combobox-invalid-el-';var b=e(d,f,{},"id",0,1);a+=k(b,!0);a+='"\n     class="';var b={},c=[];c.push("invalid-el");b.params=c;b=h(d,f,b,"getBaseCssClasses",2);a+=k(b,!0);a+='">\n    <div class="';b={};c=[];c.push("invalid-inner");b.params=c;b=h(d,f,b,"getBaseCssClasses",3);a+=k(b,
!0);a+='"></div>\n</div>\n\n';var b={},c=[],m=g(d,f,"hasTrigger",0,6);c.push(m);b.params=c;b.fn=function(b){var a;a='\n<div id="ks-combobox-trigger-';var c=e(d,b,{},"id",0,7);a+=k(c,!0);a+='"\n     class="';var c={},g=[];g.push("trigger");c.params=g;c=h(d,b,c,"getBaseCssClasses",8);a+=k(c,!0);a+='">\n    <div class="';c={};g=[];g.push("trigger-inner");c.params=g;b=h(d,b,c,"getBaseCssClasses",9);a+=k(b,!0);return a+'">&#x25BC;</div>\n</div>\n'};a+=j(d,f,b,"if",6);a+='\n\n<div class="';b={};c=[];c.push("input-wrap");
b.params=c;b=h(d,f,b,"getBaseCssClasses",13);a+=k(b,!0);a+='">\n\n    <input id="ks-combobox-input-';b=e(d,f,{},"id",0,15);a+=k(b,!0);a+='"\n           aria-haspopup="true"\n           aria-autocomplete="list"\n           aria-haspopup="true"\n           role="autocomplete"\n           aria-expanded="false"\n\n    ';b={};c=[];m=g(d,f,"disabled",0,22);c.push(m);b.params=c;b.fn=function(){return"\n    disabled\n    "};a+=j(d,f,b,"if",22);a+='\n\n    autocomplete="off"\n    class="';b={};c=[];c.push("input");
b.params=c;b=h(d,f,b,"getBaseCssClasses",27);a+=k(b,!0);a+='"\n\n    value="';b=e(d,f,{},"value",0,29);a+=k(b,!0);a+='"\n    />\n\n\n    <label id="ks-combobox-placeholder-';b=e(d,f,{},"id",0,33);a+=k(b,!0);a+='"\n           for="ks-combobox-input-';b=e(d,f,{},"id",0,34);a+=k(b,!0);a+="\"\n            style='display:";b={};c=[];g=g(d,f,"value",0,35);c.push(g);b.params=c;b.fn=function(){return"none"};b.inverse=function(){return"block"};a+=j(d,f,b,"if",35);a+=";'\n    class=\"";j={};g=[];g.push("placeholder");
j.params=g;j=h(d,f,j,"getBaseCssClasses",36);a+=k(j,!0);a+='">\n    ';f=e(d,f,{},"placeholder",0,37);a+=k(f,!0);return a+"\n    </label>\n</div>\n"}});
KISSY.add("combobox/render",["component/control","./combobox-xtpl"],function(f,a){var d=a("component/control"),j=a("./combobox-xtpl");return d.getDefaultRender().extend({beforeCreateDom:function(a,d){f.mix(d,{input:"#ks-combobox-input-{id}",trigger:"#ks-combobox-trigger-{id}",invalidEl:"#ks-combobox-invalid-el-{id}",placeholderEl:"#ks-combobox-placeholder-{id}"})},getKeyEventTarget:function(){return this.control.get("input")},_onSetCollapsed:function(a){this.control.get("input").attr("aria-expanded",
!a)},_onSetDisabled:function(a,d){this.callSuper(a,d);this.control.get("input").attr("disabled",a)}},{ATTRS:{contentTpl:{value:j}},HTML_PARSER:{value:function(a){return a.one("."+this.getBaseCssClass("input")).val()},input:function(a){return a.one("."+this.getBaseCssClass("input"))},trigger:function(a){return a.one("."+this.getBaseCssClass("trigger"))},invalidEl:function(a){return a.one("."+this.getBaseCssClass("invalid-el"))},placeholderEl:function(a){return a.one("."+this.getBaseCssClass("placeholder"))}}})});
KISSY.add("combobox/control",["node","component/control","./render","menu"],function(f,a){function d(a){for(var b=0;b<a.length;b++)if(!a[b].get("disabled"))return a[b];return null}function j(){c(this)}function k(){var a=this;setTimeout(function(){m(a)},0)}function g(){this.focus();m(this)}function h(){this.setValueFromAutocomplete(this.getValueForAutocomplete(),{force:1})}function e(a){a=a.target;a.isMenuItem&&(a=a.get("textContent"),this.setValueFromAutocomplete(a),this._savedValue=a,this.set("collapsed",
!0))}function b(a,b){var c=a.$el,e=a.view.getBaseCssClasses("invalid"),d=a.get("invalidEl");b?(c.addClass(e),d.attr("title",b),d.show()):(c.removeClass(e),d.hide())}function c(a){a._focusoutDismissTimer||(a._focusoutDismissTimer=setTimeout(function(){a._focusoutDismissTimer&&a.set("collapsed",!0)},50))}function m(a){var b=a._focusoutDismissTimer;b&&(clearTimeout(b),a._focusoutDismissTimer=null)}function s(a){this.set("value",a.newVal,{data:{causedByTimer:1}})}function i(a){var b,c=[],e,d,c=this.get("menu"),
a=this.normalizeData(a);c.removeChildren(!0);(d=c.get("highlightedItem"))&&d.set("highlighted",!1);if(a&&a.length){for(d=0;d<a.length;d++)b=a[d],c.addChild(b);c=c.get("children");a=this.getValueForAutocomplete();if(this.get("highlightMatchItem"))for(d=0;d<c.length;d++)if(c[d].get("textContent")===a){c[d].set("highlighted",!0);e=!0;break}if(!e&&this.get("autoHighlightFirst"))for(d=0;d<c.length;d++)if(!c[d].get("disabled")){c[d].set("highlighted",!0);break}this.set("collapsed",!1);this.fire("afterRenderData")}else this.set("collapsed",
!0)}var t=a("node"),p=a("component/control"),o=a("./render");a("menu");var l=t.KeyCode;return p.extend([],{initializer:function(){this.publish("afterRenderData",{bubbles:!1})},_savedValue:null,normalizeData:function(a){var b,c,d;if(a&&a.length){a=a.slice(0,this.get("maxItemCount"));b=this.get("format")?this.get("format").call(this,this.getValueForAutocomplete(),a):[];for(d=0;d<a.length;d++)c=a[d],b[d]=f.mix({content:c,textContent:c,value:c},b[d])}return b},bindUI:function(){var a=this;a.get("input").on("valuechange",
s,a);a.on("click",e,a);a.get("menu").onRendered(function(b){var c=a.get("input"),d=b.get("el"),b=b.get("contentEl");c.attr("aria-owns",d.attr("id"));d.on("focusout",j,a);d.on("focusin",k,a);b.on("mouseover",g,a);b.on("mousedown",h,a)})},destructor:function(){this.get("menu").destroy()},getValueForAutocomplete:function(){return this.get("value")},setValueFromAutocomplete:function(a,b){this.set("value",a,b)},_onSetValue:function(a,b){var c;b.causedByTimer?(c=this.getValueForAutocomplete(),void 0===
c?this.set("collapsed",!0):(this._savedValue=c,this.sendRequest(c))):this.get("input").val(a)},handleFocusInternal:function(){var a;this.get("invalidEl")&&b(this,!1);(a=this.get("placeholderEl"))&&a.hide()},handleBlurInternal:function(a){var d=this,e=d.get("placeholderEl");d.callSuper(a);c(d);d.get("invalidEl")&&d.validate(function(a,c){a?!d.get("focused")&&c===d.get("value")&&b(d,a):b(d,!1)});e&&!d.get("value")&&e.show()},handleMouseDownInternal:function(a){var b,c;this.callSuper(a);b=a.target;if((c=
this.get("trigger"))&&(c[0]===b||c.contains(b)))this.get("collapsed")?(this.focus(),this.sendRequest("")):this.set("collapsed",!0),a.preventDefault()},handleKeyDownInternal:function(a){var b,c=a.keyCode,e,g,h=this.get("menu");this.get("input");b=this.get("updateInputOnDownUp");if(h.get("visible")){e=h.get("highlightedItem");if(b&&e&&(g=h.get("children"),c===l.DOWN&&e===d(g.concat().reverse())||c===l.UP&&e===d(g)))return this.setValueFromAutocomplete(this._savedValue),e.set("highlighted",!1),!0;g=
h.handleKeyDownInternal(a);e=h.get("highlightedItem");if(c===l.ESC)return this.set("collapsed",!0),b&&this.setValueFromAutocomplete(this._savedValue),!0;b&&f.inArray(c,[l.DOWN,l.UP])&&this.setValueFromAutocomplete(e.get("textContent"));return c===l.TAB&&e&&(e.handleClickInternal(a),this.get("multiple"))?!0:g}if(c===l.DOWN||c===l.UP)if(a=this.getValueForAutocomplete(),void 0!==a)return this.sendRequest(a),!0},validate:function(a){var b=this.get("validator"),c=this.getValueForAutocomplete();b?b(c,function(b){a(b,
c)}):a(!1,c)},sendRequest:function(a){this.get("dataSource").fetchData(a,i,this)},_onSetCollapsed:function(a){var b=this.$el,c=this.get("menu");a?c.hide():(m(this),c.get("visible")||(this.get("matchElWidth")&&(c.render(),a=c.get("el"),a=(parseInt(a.css("borderLeftWidth"))||0)+(parseInt(a.css("borderRightWidth"))||0),c.set("width",b[0].offsetWidth-a)),c.show()))}},{ATTRS:{input:{},value:{value:"",sync:0,view:1},trigger:{},placeholder:{view:1},placeholderEl:{},validator:{},invalidEl:{},allowTextSelection:{value:!0},
hasTrigger:{value:!0,view:1},menu:{value:{},getter:function(a){a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){if(a.isControl){a.setInternal("parent",this);var b={node:this.$el,points:["bl","tl"],overflow:{adjustX:1,adjustY:1}};f.mix(a.get("align"),b,!1)}}},collapsed:{view:1,value:!0},dataSource:{},maxItemCount:{value:99999},matchElWidth:{value:!0},format:{},updateInputOnDownUp:{value:!0},autoHighlightFirst:{},highlightMatchItem:{value:!0},
xrender:{value:o}},xclass:"combobox"})});
KISSY.add("combobox/cursor",["node"],function(f,a){function d(a){var b=g;b||(b=j(k));"textarea"===""+a[0].type.toLowerCase()?b.css("width",a.css("width")):b.css("width",9999);f.each(h,function(c){b.css(c,a.css(c))});g||b.insertBefore(a[0].ownerDocument.body.firstChild);return g=b}var j=a("node").all,k='<div style="z-index:-9999;overflow:hidden;position: fixed;left:-9999px;top:-9999px;opacity:0;white-space:pre-wrap;word-wrap:break-word;"></div>',g,h="paddingLeft,paddingTop,paddingBottom,paddingRight,marginLeft,marginTop,marginBottom,marginRight,borderLeftStyle,borderTopStyle,borderBottomStyle,borderRightStyle,borderLeftWidth,borderTopWidth,borderBottomWidth,borderRightWidth,line-height,outline,height,fontFamily,fontSize,fontWeight,fontVariant,fontStyle".split(",");return function(a){var b=
j(a),a=b[0],c=a.ownerDocument,g=j(c),h=a.scrollTop,i=a.scrollLeft;if(c.selection)return a=c.selection.createRange(),{left:a.boundingLeft+i+g.scrollLeft(),top:a.boundingTop+h+a.boundingHeight+g.scrollTop()};g=b.offset();if("textarea"!==a.type)return g.top+=a.offsetHeight,g;c=d(b);b=a.selectionStart;c.html(f.escapeHtml(a.value.substring(0,b-1))+"<span>x</span>");c.offset(g);g=c.last();a=g.offset();a.top+=g.height();0<b&&(a.left+=g.width());a.top-=h;a.left-=i;return a}});
KISSY.add("combobox/multi-value-combobox",["./cursor","./control"],function(f,a){function d(a,c){return c&&-1!==a.indexOf(c)}function j(a){a.newVal&&a.target===this.get("menu")&&this.alignWithCursor()}function k(a){var c=a.get("input"),e=a.get("value"),f=[],i=[],k=a.get("literal"),j=a.get("separator"),a=a.get("separatorType"),o=!1,l=a!==g,c=c.prop("selectionStart"),q,n,r=-1;for(q=0;q<e.length;q++)(n=e.charAt(q),k&&n===k&&(o=!o),o)?i.push(n):(q===c&&(r=f.length),l&&h.test(n))?(i.length&&f.push(i.join("")),
i=[],i.push(n)):d(j,n)?a===g?(i.push(n),i.length&&f.push(i.join("")),i=[]):(i.length&&f.push(i.join("")),i=[],i.push(n)):i.push(n);i.length&&f.push(i.join(""));f.length||f.push("");-1===r&&(a===g&&d(j,n)&&f.push(""),r=f.length-1);return{tokens:f,cursorPosition:c,tokenIndex:r}}var g="suffix",h=/\s|\xa0/,e=a("./cursor");return a("./control").extend({syncUI:function(){var a;this.get("alignWithCursor")&&(a=this.get("menu"),a.setInternal("align",null),a.on("beforeVisibleChange",j,this))},getValueForAutocomplete:function(){var a=
k(this),c=a.tokens,h=a.tokenIndex,a=this.get("separator"),f=this.get("separatorType"),c=c[h],h=c.length-1;if(f!==g)if(d(a,c.charAt(0)))c=c.slice(1);else return;else f===g&&d(a,c.charAt(h))&&(c=c.slice(0,h));return c},setValueFromAutocomplete:function(a,c){var f=this.get("input"),e=k(this),i=e.tokens,e=Math.max(0,e.tokenIndex),j=this.get("separator"),p;p=this.get("separatorType");var o=i[e+1]||"",l=i[e];if(p!==g){if(i[e]=l.charAt(0)+a,a&&(!o||!h.test(o.charAt(0))))i[e]+=" "}else i[e]=a,p=l.length-
1,d(j,l.charAt(p))?i[e]+=l.charAt(p):1===j.length&&(i[e]+=j);e=i.slice(0,e+1).join("").length;this.set("value",i.join(""),c);f.prop("selectionStart",e);f.prop("selectionEnd",e)},alignWithCursor:function(){var a=this.get("menu"),c;c=this.get("input");c=e(c);a.move(c.left,c.top)}},{ATTRS:{separator:{value:",;"},separatorType:{value:g},literal:{value:'"'},alignWithCursor:{}},xclass:"multi-value-combobox"})});
KISSY.add("combobox/filter-select",["./control"],function(f,a,d,j){f=a("./control");j.exports=f.extend({validate:function(a){var d=this;d.callSuper(function(h,e){h?a(h,e):d.get("dataSource").fetchData(e,function(b){a:{if(b=d.normalizeData(b))for(var c=0;c<b.length;c++)if(b[c].textContent===e){b=b[c];break a}b=!1}a(b?"":d.get("invalidMessage"),e,b)})})}},{ATTRS:{invalidMessage:{value:"invalid input"}}})});
KISSY.add("combobox/local-data-source",["attribute"],function(f,a){return a("attribute").extend({fetchData:function(a,f,k){var g=this.get("parse"),h=this.get("data"),h=g(a,h);f.call(k,h)}},{ATTRS:{data:{value:[]},parse:{value:function(a,j){var k=[],g=0;if(!a)return j;f.each(j,function(f){-1!==f.indexOf(a)&&k.push(f);g++});return k}}}})});
KISSY.add("combobox/remote-data-source",["io","attribute"],function(f,a){var d=a("io");return a("attribute").extend({fetchData:function(a,f,g){var h=this,e,b=h.get("paramName"),c=h.get("parse"),m=h.get("cache"),s=h.get("allowEmpty");h.caches=h.caches||{};h.io&&(h.io.abort(),h.io=null);if(!a&&!0!==s)return f.call(g,[]);if(m&&(e=h.caches[a]))return f.call(g,e);e=h.get("xhrCfg");e.data=e.data||{};e.data[b]=a;e.success=function(b){c&&(b=c(a,b));h.setInternal("data",b);m&&(h.caches[a]=b);f.call(g,b)};
h.io=d(e)}},{ATTRS:{paramName:{value:"q"},allowEmpty:{},cache:{},parse:{},xhrCfg:{value:{}}}})});
KISSY.add("combobox",["combobox/control","combobox/multi-value-combobox","combobox/filter-select","combobox/local-data-source","combobox/remote-data-source"],function(f,a){var d=a("combobox/control"),j=a("combobox/multi-value-combobox"),k=a("combobox/filter-select"),g=a("combobox/local-data-source"),h=a("combobox/remote-data-source");d.LocalDataSource=g;d.RemoteDataSource=h;d.FilterSelect=k;d.MultiValueComboBox=j;return d});
/*
Copyright 2014, KISSY v1.42
MIT Licensed
build time: Mar 6 13:34
*/
KISSY.add("component/control/process",["base","promise"],function(e,b){function g(b){b.fire("beforeSyncUI");b.syncUI();b.__callPluginsMethod("pluginSyncUI");b.fire("afterSyncUI")}var n=b("base"),m=b("promise").Defer,h=n.prototype.__getHook,c=e.noop,i=n.extend({bindInternal:c,syncInternal:c,initializer:function(){this._renderedDefer=new m},renderUI:c,syncUI:c,bindUI:c,onRendered:function(b){return this._renderedDefer.promise.then(b)},create:function(){this.get("created")||(this.fire("beforeCreateDom"),
this.createInternal(),this.__callPluginsMethod("pluginCreateDom"),this.fire("afterCreateDom"),this.setInternal("created",!0));return this},createInternal:function(){this.createDom()},render:function(){this.get("rendered")||(this.create(),this.fire("beforeRenderUI"),this.renderUI(),this.__callPluginsMethod("pluginRenderUI"),this.fire("afterRenderUI"),this.fire("beforeBindUI"),i.superclass.bindInternal.call(this),this.bindUI(),this.__callPluginsMethod("pluginBindUI"),this.fire("afterBindUI"),i.superclass.syncInternal.call(this),
g(this),this.setInternal("rendered",!0));return this},sync:function(){g(this)},plug:function(b){var c=this.get("plugins");this.callSuper(b);b=c[c.length-1];this.get("rendered")?(b.pluginCreateDom&&b.pluginCreateDom(this),b.pluginRenderUI&&b.pluginCreateDom(this),b.pluginBindUI&&b.pluginBindUI(this),b.pluginSyncUI&&b.pluginSyncUI(this)):this.get("created")&&b.pluginCreateDom&&b.pluginCreateDom(this);return this}},{__hooks__:{createDom:h("__createDom"),renderUI:h("__renderUI"),bindUI:h("__bindUI"),
syncUI:h("__syncUI")},name:"ComponentProcess",ATTRS:{rendered:{value:!1,setter:function(b){b&&this._renderedDefer.resolve(this)}},created:{value:!1}}});return i});
KISSY.add("component/control/render-xtpl",[],function(){return function(e){var b,g=this;b=this.config.utils;var n=b.runBlockCommand,m=b.renderOutput,h=b.getProperty,c=b.runInlineCommand,i=b.getPropertyOrRunCommand;b='<div id="';var j=i(g,e,{},"id",0,1);b+=m(j,!0);b+='"\n class="';var j={},l=[];l.push("");j.params=l;c=c(g,e,j,"getBaseCssClasses",2);b+=m(c,!0);b+="\n";c={};j=[];l=h(g,e,"elCls",0,3);j.push(l);c.params=j;c.fn=function(b){var a;a="\n ";b=i(g,b,{},".",0,4);a+=m(b,!0);return a+"  \n"};b+=
n(g,e,c,"each",3);b+='\n"\n\n';c={};j=[];l=h(g,e,"elAttrs",0,8);j.push(l);c.params=j;c.fn=function(b){var a;a=" \n ";var d=i(g,b,{},"xindex",0,9);a+=m(d,!0);a+='="';b=i(g,b,{},".",0,9);a+=m(b,!0);return a+'"\n'};b+=n(g,e,c,"each",8);b+='\n\nstyle="\n';c={};j=[];h=h(g,e,"elStyle",0,13);j.push(h);c.params=j;c.fn=function(b){var a;a=" \n ";var d=i(g,b,{},"xindex",0,14);a+=m(d,!0);a+=":";b=i(g,b,{},".",0,14);a+=m(b,!0);return a+";\n"};b+=n(g,e,c,"each",13);return b+'\n">'}});
KISSY.add("component/control/render",["node","xtemplate/runtime","./process","./render-xtpl","component/manager"],function(e,b){function g(k){"number"===typeof k&&(k+="px");return k}function n(k){k||(k=[""]);"string"===typeof k&&(k=k.split(/\s+/));return k}function m(k,a,b){for(var d="",f=0,c=b.length,a=k+a;f<c;f++)k=(k=b[f])?"-"+k:k,d+=" "+a+k;return d}function h(a){var b;a.target===this.control&&(b=this[q+a.type.slice(5).slice(0,-6)],b.call(this,a.newVal,a))}function c(a,b){return this.config.view.getBaseCssClasses(b.params[0])}
function i(a,b){return this.config.view.getBaseCssClass(b.params[0])}var j=b("node"),l=b("xtemplate/runtime"),o=b("./process"),a=b("./render-xtpl"),d=b("component/manager"),q="_onSet",r=e.trim,s=j.all,t=e.UA,u=e.Env.host.document;return o.extend({isRender:!0,createInternal:function(){var a=this.control.get("srcNode");a?this.decorateDom(a):this.callSuper()},beforeCreateDom:function(a){var b=this.control,d,c,f,e=b.get("elAttrs"),j=b.get("elCls"),h;d=b.getAttrs();h=b.get("elStyle");var m=b.get("elCls");
for(c in d)f=d[c],f.view&&(a[c]=b.get(c));d=a.width;c=a.height;f=a.visible;a=a.zIndex;d&&(h.width=g(d));c&&(h.height=g(c));a&&(h["z-index"]=a);f||m.push(this.getBaseCssClasses("hidden"));if(h=b.get("disabled"))j.push(this.getBaseCssClasses("disabled")),e["aria-disabled"]="true";b.get("highlighted")&&j.push(this.getBaseCssClasses("hover"));b.get("focusable")&&(9>t.ieMode&&(e.hideFocus="true"),e.tabindex=h?"-1":"0")},createDom:function(){this.beforeCreateDom(this.renderData={},this.childrenElSelectors=
{},this.renderCommands={getBaseCssClasses:c,getBaseCssClass:i});var b=this.control,p;p=this.renderTpl(a)+this.renderTpl(this.get("contentTpl"))+"</div>";b.setInternal("el",this.$el=s(p));this.el=this.$el[0];this.fillChildrenElsBySelectors()},decorateDom:function(a){var b=this.control;a.attr("id")||a.attr("id",b.get("id"));var d=this.constructor.HTML_PARSER,c,f;for(c in d)f=d[c],"function"===typeof f?(f=f.call(this,a),void 0!==f&&b.setInternal(c,f)):"string"===typeof f?b.setInternal(c,a.one(f)):e.isArray(f)&&
f[0]&&b.setInternal(c,a.all(f[0]));b.setInternal("el",this.$el=a);this.el=a[0]},renderUI:function(){var a=this.control,b=this.$el;if(!a.get("srcNode")){var d=a.get("render");(a=a.get("elBefore"))?b.insertBefore(a,void 0):d?b.appendTo(d,void 0):b.appendTo(u.body,void 0)}},bindUI:function(){var a=this.control,b=a.getAttrs(),d,c;for(d in b){c=b[d];var f=e.ucfirst(d),g=this[q+f];if(c.view&&g)a.on("after"+f+"Change",h,this)}},destructor:function(){this.$el&&this.$el.remove()},$:function(a){return this.$el.all(a)},
fillChildrenElsBySelectors:function(a){var b=this.$el,d=this.control,c,f,a=a||this.childrenElSelectors;for(c in a)f=a[c],"function"===typeof f?d.setInternal(c,f(b)):d.setInternal(c,this.$(e.substitute(f,this.renderData))),delete a[c]},renderTpl:function(a,b,d){b=b||this.renderData;d=d||this.renderCommands;return(new (this.get("xtemplate"))(a,{control:this.control,view:this,commands:d})).render(b)},getComponentConstructorByNode:function(a,b){var c=b[0].className;return c?(c=c.replace(RegExp("\\b"+
a,"ig"),""),d.getConstructorByXClass(c)):null},getComponentCssClasses:function(){if(this.componentCssClasses)return this.componentCssClasses;for(var a=this.control.constructor,b,d=[];a&&!a.prototype.hasOwnProperty("isControl");)(b=a.xclass)&&d.push(b),a=a.superclass&&a.superclass.constructor;return this.componentCssClasses=d},getBaseCssClasses:function(a){for(var a=n(a),b=this.getComponentCssClasses(),d=0,c=this.get("control"),f="",e=b.length,c=c.get("prefixCls");d<e;d++)f+=m(c,b[d],a);return r(f)},
getBaseCssClass:function(a){return r(m(this.control.get("prefixCls"),this.getComponentCssClasses()[0],n(a)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(a){this.$el.width(a)},_onSetHeight:function(a){this.$el.height(a)},_onSetContent:function(a){var b=this.$el;b.html(a);this.get("allowTextSelection")||b.unselectable()},_onSetVisible:function(a){var b=this.$el,d=this.getBaseCssClasses("hidden");a?b.removeClass(d):b.addClass(d)},_onSetHighlighted:function(a){var b=this.getBaseCssClasses("hover");
this.$el[a?"addClass":"removeClass"](b)},_onSetDisabled:function(a){var b=this.control,d=this.getBaseCssClasses("disabled");this.$el[a?"addClass":"removeClass"](d).attr("aria-disabled",a);b.get("focusable")&&this.getKeyEventTarget().attr("tabindex",a?-1:0)},_onSetActive:function(a){var b=this.getBaseCssClasses("active");this.$el[a?"addClass":"removeClass"](b).attr("aria-pressed",!!a)},_onSetFocused:function(a){var b=this.$el,d=this.getBaseCssClasses("focused");b[a?"addClass":"removeClass"](d)},_onSetZIndex:function(a){this.$el.css("z-index",
a)}},{__hooks__:{decorateDom:o.prototype.__getHook("__decorateDom"),beforeCreateDom:o.prototype.__getHook("__beforeCreateDom")},extend:function p(a,b,d){var c,g={};c=o.extend.apply(this,arguments);c.HTML_PARSER=c.HTML_PARSER||{};e.isArray(a)&&(e.each(a.concat(c),function(a){a&&e.each(a.HTML_PARSER,function(a,b){g[b]=a})}),c.HTML_PARSER=g);e.mix(c.HTML_PARSER,this.HTML_PARSER,!1);c.extend=p;return c},ATTRS:{control:{setter:function(a){this.control=a}},xtemplate:{value:l},contentTpl:{value:function(a){return a.get("content")||
""}}},HTML_PARSER:{id:function(a){return(a=a[0].id)?a:void 0},content:function(a){return a.html()},disabled:function(a){return a.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})});
KISSY.add("component/control",["node","./control/process","component/manager","./control/render"],function(e,b){function g(){var a,b=this;do a=b.ATTRS,b=b.superclass;while(!a||!a.xrender);return a.xrender.value}var n=b("node"),m=b("./control/process"),h=b("component/manager"),c=b("./control/render"),i=e.UA.ieMode,j=e.Features,l=n.Gesture,o=j.isTouchGestureSupported();j.isTouchEventSupported();c=m.extend({isControl:!0,createDom:function(){var a=this.get("xrender"),b=this.get("view"),c=this.get("id");
b?b.set("control",this):this.set("view",this.view=b=new a({control:this}));b.create();a=b.getKeyEventTarget();this.get("allowTextSelection")||a.unselectable();h.addComponent(c,this)},renderUI:function(){this.view.render()},bindUI:function(){var a=this.view.getKeyEventTarget();if(this.get("focusable"))a.on("focus",this.handleFocus,this).on("blur",this.handleBlur,this).on("keydown",this.handleKeydown,this);if(this.get("handleMouseEvents")){a=this.$el;a.on("mouseenter",this.handleMouseEnter,this).on("mouseleave",
this.handleMouseLeave,this).on("contextmenu",this.handleContextMenu,this);a.on(l.start,this.handleMouseDown,this).on(l.end,this.handleMouseUp,this).on(l.tap,this.handleClick,this);if(l.cancel)a.on(l.cancel,this.handleMouseUp,this);if(9>i)a.on("dblclick",this.handleDblClick,this)}},sync:function(){this.fire("beforeSyncUI");this.syncUI();this.view.sync();this.__callPluginsMethod("pluginSyncUI");this.fire("afterSyncUI")},createComponent:function(a,b){return h.createComponent(a,b||this)},_onSetFocused:function(a){var b=
this.view.getKeyEventTarget()[0];a?b.focus():b.ownerDocument.activeElement===b&&b.ownerDocument.body.focus()},_onSetX:function(a){this.$el.offset({left:a})},_onSetY:function(a){this.$el.offset({top:a})},_onSetVisible:function(a){this.fire(a?"show":"hide")},show:function(){this.render();this.set("visible",!0);return this},hide:function(){this.set("visible",!1);return this},focus:function(){this.get("focusable")&&this.set("focused",!0)},blur:function(){this.get("focusable")&&this.set("focused",!1)},
move:function(a,b){this.set({x:a,y:b})},handleDblClick:function(a){this.get("disabled")||this.handleDblClickInternal(a)},handleDblClickInternal:function(a){this.handleClickInternal(a)},handleMouseEnter:function(a){this.get("disabled")||this.handleMouseEnterInternal(a)},handleMouseEnterInternal:function(a){this.set("highlighted",!!a)},handleMouseLeave:function(a){this.get("disabled")||this.handleMouseLeaveInternal(a)},handleMouseLeaveInternal:function(a){this.set("active",!1);this.set("highlighted",
!a)},handleMouseDown:function(a){this.get("disabled")||this.handleMouseDownInternal(a)},handleMouseDownInternal:function(a){var b;if(1===a.which||o)this.get("activeable")&&this.set("active",!0),this.get("focusable")&&this.focus(),!this.get("allowTextSelection")&&-1!==a.type.indexOf("mouse")&&(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!==b&&"textarea"!==b&&"button"!==b&&a.preventDefault())},handleMouseUp:function(a){this.get("disabled")||this.handleMouseUpInternal(a)},handleMouseUpInternal:function(a){this.get("active")&&
(1===a.which||o)&&this.set("active",!1)},handleContextMenu:function(a){this.get("disabled")||this.handleContextMenuInternal(a)},handleContextMenuInternal:function(){},handleFocus:function(){this.get("disabled")||this.handleFocusInternal()},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){this.get("disabled")||this.handleBlurInternal()},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(a){if(!this.get("disabled")&&this.handleKeyDownInternal(a))return a.halt(),
!0},handleKeyDownInternal:function(a){if(a.keyCode===n.KeyCode.ENTER)return this.handleClickInternal(a)},handleClick:function(a){this.get("disabled")||this.handleClickInternal(a)},handleClickInternal:function(){this.get("focusable")&&this.focus()},destructor:function(){h.removeComponent(this.get("id"));this.view?this.view.destroy():this.get("srcNode")&&this.get("srcNode").remove()}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return e.guid("ks-component")}},content:{view:1,value:""},width:{view:1},
height:{view:1},elCls:{view:1,value:[],setter:function(a){"string"===typeof a&&(a=a.split(/\s+/));return a||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(a){this.$el=a;this.el=a[0]}},x:{},y:{},xy:{setter:function(a){var b=e.makeArray(a);b.length&&(void 0!==b[0]&&this.set("x",b[0]),void 0!==b[1]&&this.set("y",b[1]));return a},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:!0,view:1},srcNode:{setter:function(a){return n.all(a)}},
handleMouseEvents:{value:!0},focusable:{value:!0,view:1},allowTextSelection:{value:!1},activeable:{value:!0},focused:{view:1},active:{view:1,value:!1},highlighted:{view:1,value:!1},prefixCls:{view:1,value:e.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(a,b){(b=this.get("parent"))&&this.removeTarget(b);a&&this.addTarget(a)}},disabled:{view:1,value:!1},xrender:{value:c},view:{setter:function(a){this.view=a}}}});c.getDefaultRender=g;c.extend=function d(b,c,j){var i=e.makeArray(arguments),
l,k=i[i.length-1];if(l=k.xclass)k.name=l;i=m.extend.apply(this,i);l&&h.setConstructorByXClass(l,i);i.extend=d;i.getDefaultRender=g;return i};return c});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:05
*/
KISSY.add("component/manager",[],function(){var h=0,e,g={},c={};return e={__instances:c,addComponent:function(a,b){c[a]=b},removeComponent:function(a){delete c[a]},getComponent:function(a){return c[a]},createComponent:function(a,b){var f,d;if(a){if(!a.isControl&&b&&(a.prefixCls||(a.prefixCls=b.get("prefixCls")),!a.xclass&&a.prefixXClass))a.xclass=a.prefixXClass,a.xtype&&(a.xclass+="-"+a.xtype);if(!a.isControl&&(d=a.xclass))(f=e.getConstructorByXClass(d))||"can not find class by xclass desc : "+d,
a=new f(a);a.isControl&&b&&a.setInternal("parent",b)}return a},getConstructorByXClass:function(a){var a=a.split(/\s+/),b=-1,f,d,c,e=null;for(d=0;d<a.length;d++)if((c=g[a[d]])&&(f=c.priority)>b)b=f,e=c.constructor;return e},setConstructorByXClass:function(a,b){g[a]={constructor:b,priority:h++}}}});
/*
Copyright 2014, KISSY v1.42
MIT Licensed
build time: Mar 7 12:41
*/
KISSY.add("xtemplate/runtime/scope",[],function(g){function l(e,f){this.data=e||{};this.affix=f;this.root=this}l.prototype={isScope:1,setParent:function(e){this.parent=e;this.root=e.root},getParent:function(){return this.parent},getRoot:function(){return this.root},set:function(e,f){this.affix||(this.affix={});this.affix[e]=f},setData:function(e){this.data=e},getData:function(){return this.data},mix:function(e){this.affix||(this.affix={});g.mix(this.affix,e)},has:function(e){var f=this.data,h=this.affix;
return h&&e in h?!0:"object"===typeof f&&e in f},get:function(e){var f=this.data,h=this.affix;if(h&&e in h)return h[e];if("object"===typeof f&&e in f)return f[e]},resolve:function(e,f){"."===e&&(e="this");var h=e.split("."),d=this,c,b,a,g,k;if("root"===h[0])h.shift(),d=d.root;else if(f)for(;d&&f--;)d=d.parent;var i=0;for(c=h.length;d;){k=1;a=d;for(b=0;b<c;b++)if(g=h[b],"this"===g)i=1;else if(a===d)if(d.has(g))a=d.get(g),i=1;else{k=0;break}else{if(null==a||"object"!==typeof a||!(g in a)){k=0;break}a=
a[g]}if(k)return a&&a.isScope&&(a=a.data),"function"===typeof a&&(a=a.call(this.data)),[a];if(i)break;d=d.parent}return!1}};return l});
KISSY.add("xtemplate/runtime/commands",["path","./scope"],function(g,l){var e,f=l("path"),h=l("./scope");return e={"debugger":g.noop,each:function(d,c){var b=c.params,a=b[0],e=b[2]||"xindex",b=b[1],f="",i,j,m;if(a)if(j=new h,g.isArray(a)){i=a.length;for(var n=0;n<i;n++)j.data=a[n],m=j.affix={xcount:i},m[e]=n,b&&(m[b]=a[n]),j.setParent(d),f+=c.fn(j)}else for(i in a)j.data=a[i],m=j.affix={},m[e]=i,b&&(m[b]=a[i]),j.setParent(d),f+=c.fn(j);else c.inverse&&(f=c.inverse(d));return f},"with":function(d,
c){var b=c.params[0],a="";b?(b=new h(b),b.setParent(d),a=c.fn(b)):c.inverse&&(a=c.inverse(d));return a},"if":function(d,c){var b="";c.params[0]?c.fn&&(b=c.fn(d)):c.inverse&&(b=c.inverse(d));return b},set:function(d,c){d.mix(c.hash);return""},include:function(d,c){var b=c.params;if(!b||1!==b.length)return"include must has one param","";if(c.hash){var a=new h(c.hash);a.setParent(d);d=a}a=this.config.name;b=b[0];if("."===b.charAt(0)){if("unspecified"===a)return"parent template does not have name for relative sub tpl name: "+
b,"";b=f.resolve(a,"../",b)}a=this.config.loader.call(this,b);c=g.merge(this.config);c.name=b;c.commands=this.config.commands;c.macros=this.config.macros;return this.invokeEngine(a,d,c)},macro:function(d,c){var b=c.params,a=b[0],e=b.slice(1),b=this.config.macros;if(c.fn)b[a]||(b[a]={paramNames:e,fn:c.fn});else{var f={};(a=b[a])||"can not find macro:"+name;g.each(a.paramNames,function(b,j){f[b]=e[j]});b=new h(f);return a.fn.call(this,b)}return""},parse:function(d,c){return e.include.call(this,new h,
c)}}});
KISSY.add("xtemplate/runtime",["./runtime/commands","./runtime/scope"],function(g,l){function e(j){j}function f(j,b){for(var a=b.split("."),c=j,e=a.length,d=0;d<e&&!(c=c[a[d]],!c);d++);return c}function h(j,b,a,c,d,e){var g,h=f(j.config.commands,c);if(h){try{g=h.call(j,b,a)}catch(i){i.message+': "'+c+'" at line '+d}return{find:!0,value:g}}e&&"can not find command: "+c+'" at line '+d;return{find:!1}}function d(j,b,a,c,d){var f,j=j.config.silent?e:g.error,b=b.resolve(a,c);!1===b?j('can not find property: "'+a+
'" at line '+d,"warn"):f=b[0];return f}function c(j,a){this.tpl=j;a=g.merge(i,a);a.commands=g.merge(a.commands,b);a.utils=k;a.macros=a.macros||{};this.config=a}var b=l("./runtime/commands"),a=l("./runtime/scope"),p=g.escapeHtml,k={runBlockCommand:function(a,b,c,d,h){var i=a.config,l=i.silent?e:g.error,i=i.commands,o=f(i,d);if(!o)if(!c.params&&!c.hash){var k=b.resolve(d);!1===k?(l('can not find property: "'+d+'" at line '+h),k=""):k=k[0];o=i["if"];g.isArray(k)?o=i.each:"object"===typeof k&&(o=i["with"]);
c.params=[k]}else return"can not find command: "+d+'" at line '+h,"";var q;try{q=o.call(a,b,c)}catch(p){p.message+': "'+d+'" at line '+h}return q},renderOutput:function(a,b){void 0===a&&(a="");return b&&a?p(a):a},getProperty:function(a,b,c,e,f){return d(a,b,c,e,f)},runInlineCommand:function(a,b,c,d,e){var f="",a=h(a,b,c,d,e);a.find&&(f=a.value);return f},getPropertyOrRunCommand:function(a,b,c,e,f,g){var i,k=c.hash||c.params,c=h(a,b,c,e,g,k);c.find?i=c.value:k||(i=d(a,b,e,f,g));return i}},i={silent:!0,
name:"unspecified",loader:function(a){var b=g.require(a);b||'template "'+a+'" does not exist, need to be required or used first!';return b}};g.mix(c,{commands:b,utils:k,addCommand:function(a,c){b[a]=c},removeCommand:function(a){delete b[a]}});c.prototype={constructor:c,invokeEngine:function(a,b,c){return(new this.constructor(a,c)).render(b,!0)},removeCommand:function(a){delete this.config.commands[a]},addCommand:function(a,b){this.config.commands[a]=b},render:function(b){var c=b;if(!c||!c.isScope)c=
new a(b);return this.tpl(c,g)}};c.Scope=a;return c});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:16
*/
KISSY.add("menu/menu-render",["component/container"],function(e,a){return a("component/container").getDefaultRender().extend({beforeCreateDom:function(a){a.elAttrs.role="menu"},containsElement:function(a){var c=this.$el;return c&&(c[0]===a||c.contains(a))}})});
KISSY.add("menu/control",["node","component/container","component/extension/delegate-children","./menu-render"],function(e,a){function b(a){a.target.isMenu&&(a=a.newVal,this.el.setAttribute("aria-activedescendant",a&&a.el.id||""))}var c=a("node"),h=a("component/container"),d=a("component/extension/delegate-children"),g=a("./menu-render"),i=c.KeyCode;return h.extend([d],{isMenu:1,_onSetHighlightedItem:function(a,f){var d;a&&f&&(d=f.prevVal)&&d.set("highlighted",!1,{data:{byPassSetHighlightedItem:1}})},
_onSetVisible:function(a,f){this.callSuper(f);var d;!a&&(d=this.get("highlightedItem"))&&d.set("highlighted",!1)},bindUI:function(){this.on("afterHighlightedItemChange",b,this)},getRootMenu:function(){return this},handleMouseEnterInternal:function(a){this.callSuper(a);if((a=this.getRootMenu())&&a._popupAutoHideTimer)clearTimeout(a._popupAutoHideTimer),a._popupAutoHideTimer=null;this.focus()},handleBlurInternal:function(a){this.callSuper(a);var f;(f=this.get("highlightedItem"))&&f.set("highlighted",
!1)},_getNextEnabledHighlighted:function(a,f){var d=this.get("children"),b=d.length,c=a;do{var g=d[a];if(!g.get("disabled")&&!1!==g.get("visible"))return d[a];a=(a+f+b)%b}while(a!==c)},handleKeyDownInternal:function(a){var f=this.get("highlightedItem");if(f&&f.handleKeyDownInternal(a))return!0;var d=this.get("children"),b=d.length;if(0!==b){var c;switch(a.keyCode){case i.ESC:(f=this.get("highlightedItem"))&&f.set("highlighted",!1);break;case i.HOME:c=this._getNextEnabledHighlighted(0,1);break;case i.END:c=
this._getNextEnabledHighlighted(b-1,-1);break;case i.UP:f?(a=e.indexOf(f,d),b=(a-1+b)%b):b-=1;c=this._getNextEnabledHighlighted(b,-1);break;case i.DOWN:f?(a=e.indexOf(f,d),b=(a+1+b)%b):b=0,c=this._getNextEnabledHighlighted(b,1)}if(c)return c.set("highlighted",!0,{data:{fromKeyboard:1}}),!0}},containsElement:function(a){if(!this.get("visible")||!this.$el)return!1;if(this.view.containsElement(a))return!0;for(var f=this.get("children"),b=0,d=f.length;b<d;b++){var c=f[b];if(c.containsElement&&c.containsElement(a))return!0}return!1}},
{ATTRS:{highlightedItem:{value:null},xrender:{value:g},defaultChildCfg:{value:{xclass:"menuitem"}}},xclass:"menu"})});
KISSY.add("menu/menuitem-render",["component/control"],function(e,a){return a("component/control").getDefaultRender().extend({beforeCreateDom:function(a){a.elAttrs.role=a.selectable?"menuitemradio":"menuitem";a.selected&&a.elCls.push(this.getBaseCssClasses("selected"))},_onSetSelected:function(a){var c=this.getBaseCssClasses("selected");this.$el[a?"addClass":"removeClass"](c)},containsElement:function(a){var c=this.$el;return c&&(c[0]===a||c.contains(a))}},{HTML_PARSER:{selectable:function(a){return a.hasClass(this.getBaseCssClass("selectable"))}}})});
KISSY.add("menu/menuitem",["component/control","./menuitem-render","node"],function(e,a){var b=a("component/control"),c=a("./menuitem-render"),h=a("node").all;return b.extend({isMenuItem:1,handleClickInternal:function(){this.callSuper();this.get("selectable")&&this.set("selected",!0);this.fire("click");return!0},_onSetHighlighted:function(a,c){var b=this.get("parent");if(!c||!c.byPassSetHighlightedItem)this.get("rendered")?b.set("highlightedItem",a?this:null):a&&b.set("highlightedItem",this);if(a){var e=
this.$el;(b=e.parent(function(a){return"visible"!==h(a).css("overflow")},b.get("el").parent()))&&e.scrollIntoView(b,{alignWithTop:!0,allowHorizontalScroll:!0,onlyScrollIfNeeded:!0})}},containsElement:function(a){return this.view.containsElement(a)}},{ATTRS:{focusable:{value:!1},handleMouseEvents:{value:!1},selectable:{view:1},value:{},selected:{view:1},xrender:{value:c}},xclass:"menuitem"})});
KISSY.add("menu/check-menuitem-xtpl",["component/extension/content-xtpl"],function(e,a,b,c){return function(b){var d,g;d=this.config.utils;"undefined"!==typeof c&&c.kissy&&(g=c);var e=d.renderOutput,j=d.runInlineCommand;d='<div class="';var f={},k=[];k.push("checkbox");f.params=k;f=j(this,b,f,"getBaseCssClasses",1);d+=e(f,!0);d+='">\n</div>\n';f={};k=[];k.push("component/extension/content-xtpl");f.params=k;g&&(a("component/extension/content-xtpl"),f.params[0]=g.resolveByName(f.params[0]));b=j(this,
b,f,"include",3);return d+=e(b,!1)}});KISSY.add("menu/check-menuitem-render",["./menuitem-render","component/extension/content-render","./check-menuitem-xtpl"],function(e,a){var b=a("./menuitem-render"),c=a("component/extension/content-render"),h=a("./check-menuitem-xtpl");return b.extend([c],{beforeCreateDom:function(a){a.checked&&a.elCls.push(this.getBaseCssClasses("checked"))},_onSetChecked:function(a){var b=this.getBaseCssClasses("checked");this.$el[a?"addClass":"removeClass"](b)}},{ATTRS:{contentTpl:{value:h}}})});
KISSY.add("menu/check-menuitem",["./menuitem","./check-menuitem-render"],function(e,a){var b=a("./menuitem"),c=a("./check-menuitem-render");return b.extend({handleClickInternal:function(){this.callSuper();this.set("checked",!this.get("checked"));this.fire("click");return!0}},{ATTRS:{checked:{view:1},xrender:{value:c}},xclass:"check-menuitem"})});
KISSY.add("menu/submenu-xtpl",[],function(){return function(e){var a;a=this.config.utils;var b=a.renderOutput,c=a.runInlineCommand,h=a.getPropertyOrRunCommand;a='<div id="ks-content-';var d=h(this,e,{},"id",0,1);a+=b(d,!0);a+='"\n     class="';var d={},g=[];g.push("content");d.params=g;c=c(this,e,d,"getBaseCssClasses",2);a+=b(c,!0);a+='">';c=h(this,e,{},"content",0,2);a+=b(c,!1);a+='</div>\n<span class="';e=h(this,e,{},"prefixCls",0,3);a+=b(e,!0);return a+'submenu-arrow">\u25ba</span>'}});
KISSY.add("menu/submenu-render",["./submenu-xtpl","./menuitem-render","component/extension/content-render"],function(e,a){var b=a("./submenu-xtpl"),c=a("./menuitem-render"),h=a("component/extension/content-render");return c.extend([h],{decorateDom:function(a){var b=this.control,c=b.get("prefixCls"),a=a.one("."+c+"popupmenu"),e=a[0].ownerDocument.body;e.insertBefore(a[0],e.firstChild);e=this.getComponentConstructorByNode(c,a);b.setInternal("menu",new e({srcNode:a,prefixCls:c}))}},{ATTRS:{contentTpl:{value:b}}})});
KISSY.add("menu/submenu",["node","./menuitem","./submenu-render"],function(e,a){function b(a){var b=a.target;b!==this&&b.isMenuItem&&a.newVal&&(this.clearHidePopupMenuTimers(),this.get("highlighted")||(this.set("highlighted",!0),b.set("highlighted",!1),b.set("highlighted",!0)))}function c(){var a=this.get("menu"),b={node:this.$el,points:["tr","tl"],overflow:{adjustX:1,adjustY:1}};e.mix(a.get("align"),b,!1);a.show();this.el.setAttribute("aria-haspopup",a.get("el").attr("id"))}function h(){this.get("menu").hide()}
var d=a("node"),g=a("./menuitem"),i=a("./submenu-render"),j=d.KeyCode;return g.extend({isSubMenu:1,clearShowPopupMenuTimers:function(){var a;if(a=this._showTimer)a.cancel(),this._showTimer=null},clearHidePopupMenuTimers:function(){var a;if(a=this._dismissTimer)a.cancel(),this._dismissTimer=null},clearSubMenuTimers:function(){this.clearHidePopupMenuTimers();this.clearShowPopupMenuTimers()},bindUI:function(){this.on("afterHighlightedChange",b,this)},handleMouseLeaveInternal:function(){this.set("highlighted",
!1,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")&&(this._dismissTimer=e.later(h,1E3*this.get("menuDelay"),!1,this))},handleMouseEnterInternal:function(){this.set("highlighted",!0,{data:{fromMouse:1}});this.clearSubMenuTimers();this.get("menu").get("visible")||(this._showTimer=e.later(c,1E3*this.get("menuDelay"),!1,this))},_onSetHighlighted:function(a,b){b&&(this.callSuper(b),b.fromMouse||(a&&!b.fromKeyboard?c.call(this):a||h.call(this)))},handleClickInternal:function(){c.call(this);
this.callSuper()},handleKeyDownInternal:function(a){var b=this.get("menu"),d,e=b.get("visible"),g=a.keyCode;if(e){if(!b.handleKeyDownInternal(a))if(g===j.LEFT)this.set("highlighted",!1),this.set("highlighted",!0,{data:{fromKeyboard:1}});else return}else if(g===j.RIGHT)c.call(this),a=b.get("children"),(d=a[0])&&d.set("highlighted",!0,{data:{fromKeyboard:1}});else{if(g===j.ENTER)return this.handleClickInternal(a);return}return!0},containsElement:function(a){return this.get("menu").containsElement(a)},
destructor:function(){var a=this.get("menu");this.clearSubMenuTimers();a.destroy()}},{ATTRS:{menuDelay:{value:0.15},menu:{value:{},getter:function(a){a.isControl||(a.xclass=a.xclass||"popupmenu",a=this.createComponent(a),this.setInternal("menu",a));return a},setter:function(a){a.isControl&&a.setInternal("parent",this)}},xrender:{value:i}},xclass:"submenu"})});
KISSY.add("menu/popupmenu-render",["component/extension/content-render","./menu-render"],function(e,a){var b=a("component/extension/content-render");return a("./menu-render").extend([b])});
KISSY.add("menu/popupmenu",["component/extension/align","component/extension/shim","./control","./popupmenu-render"],function(e,a){var b=a("component/extension/align"),c=a("component/extension/shim"),h=a("./control"),d=a("./popupmenu-render");return h.extend([c,b],{getRootMenu:function(){var a=this,b;do b=a,a=a.get("parent");while(a&&(a.isMenuItem||a.isMenu));return b===this?null:b},handleMouseLeaveInternal:function(a){this.callSuper(a);if(this.get("autoHideOnMouseLeave")){var b=this.getRootMenu();
b&&(clearTimeout(b._popupAutoHideTimer),b._popupAutoHideTimer=setTimeout(function(){var a;(a=b.get("highlightedItem"))&&a.set("highlighted",!1)},1E3*this.get("parent").get("menuDelay")))}},isPopupMenu:1,handleBlurInternal:function(a){this.callSuper(a);this.hide()}},{ATTRS:{focusable:{value:!1},autoHideOnMouseLeave:{},contentEl:{},visible:{value:!1},xrender:{value:d}},xclass:"popupmenu"})});
KISSY.add("menu",["menu/control","menu/menuitem","menu/check-menuitem","menu/submenu","menu/popupmenu"],function(e,a){var b=a("menu/control"),c=a("menu/menuitem"),h=a("menu/check-menuitem"),d=a("menu/submenu"),g=a("menu/popupmenu");b.Item=c;b.CheckItem=h;b.SubMenu=d;b.PopupMenu=g;return b});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("component/container/render",["component/control","component/manager"],function(g,d){var f=d("component/control"),i=d("component/manager");return f.getDefaultRender().extend([],{decorateDom:function(){var d=this,f=d.getChildrenContainerEl(),a=d.control,b=a.get("defaultChildCfg"),c=b.prefixCls,e=b.xclass,h=[];f.children().each(function(a){var f=d.getComponentConstructorByNode(c,a)||e&&i.getConstructorByXClass(e);f&&h.push(new f(g.merge(b,{srcNode:a})))});a.set("children",h)},getChildrenContainerEl:function(){return this.$el}},
{name:"ContainerRender"})});
KISSY.add("component/container",["component/control","./container/render"],function(g,d){function f(a){if(a.target===this){var b=a.component,c=this.get("children"),a=a.index;c.splice(a,0,b);c=this.get("children");b=c[a];b.setInternal("parent",this);this.get("rendered")&&this.renderChild(a);this.fire("afterAddChild",{component:b,index:a})}}function i(a){if(a.target===this){var b=a.component,c,e,h=a.destroy,d=this.get("children"),a=a.index;-1!==a&&d.splice(a,1);b.setInternal("parent",null);if(h)b.destroy&&
b.destroy();else if(b.get&&(e=b.el))(c=e.parentNode)&&c.removeChild(e);this.fire("afterRemoveChild",{component:b,index:a})}}var j=d("component/control"),k=d("./container/render");return j.extend({isContainer:!0,initializer:function(){var a=this.get("prefixCls"),b=this.get("defaultChildCfg");this.publish("beforeAddChild",{defaultFn:f});this.publish("beforeRemoveChild",{defaultFn:i});b.prefixCls=b.prefixCls||a},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var a,
b=this.get("children");for(a=0;a<b.length;a++)this.renderChild(a)},createChildren:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)this.createChild(a)},addChild:function(a,b){var c=this.get("children");void 0===b&&(b=c.length);this.fire("beforeAddChild",{component:a,index:b})},renderChild:function(a){var b=this.get("children");this.createChild(a).render();this.fire("afterRenderChild",{component:b[a],index:a})},createChild:function(a){var b,c,e,d;b=this.get("children")[a];d=this.view.getChildrenContainerEl();
e=d[0];c=e.children[a]||null;b.get("rendered")?(d=b.el,d.parentNode!==e&&e.insertBefore(d,c)):(c?b.set("elBefore",c):b.set("render",d),b.create());this.fire("afterCreateChild",{component:b,index:a});return b},removeChild:function(a,b){void 0===b&&(b=!0);this.fire("beforeRemoveChild",{component:a,index:g.indexOf(a,this.get("children")),destroy:b})},removeChildren:function(a){var b,c=[].concat(this.get("children"));for(b=0;b<c.length;b++)this.removeChild(c[b],a);return this},getChildAt:function(a){return this.get("children")[a]||
null},destructor:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)b[a].destroy&&b[a].destroy()}},{ATTRS:{children:{value:[],getter:function(a){var b=null,c,d;for(c=0;c<a.length;c++)d=a[c],d.isControl||(b=b||this.get("defaultChildCfg"),g.mix(d,b,!1),a[c]=this.createComponent(d));return a},setter:function(a){var b,c;for(b=0;b<a.length;b++)c=a[b],c.isControl&&c.setInternal("parent",this)}},defaultChildCfg:{value:{}},xrender:{value:k}},name:"container"})});
/*
Copyright 2014, KISSY v1.42
MIT Licensed
build time: Feb 25 15:53
*/
KISSY.add("component/extension/delegate-children",["node","component/manager"],function(d,e){function h(a){a.target===this&&a.component.$el.addClass(this.__childClsTag)}function i(a){a.target===this&&(a=a.component.$el)&&a.removeClass(this.__childClsTag)}function f(){this.__childClsTag=d.guid("ks-component-child");this.on("afterRenderChild",h,this).on("afterRemoveChild",i,this)}var j=e("node"),k=e("component/manager"),g=d.UA.ieMode,c=j.Gesture;d.Features.isTouchEventSupported();d.augment(f,{handleChildrenEvents:function(a){if(!this.get("disabled")){var b=
this.getOwnerControl(a);if(b&&!b.get("disabled"))switch(a.stopPropagation(),a.type){case c.start:b.handleMouseDown(a);break;case c.end:b.handleMouseUp(a);break;case c.tap:b.handleClick(a);break;case "mouseenter":b.handleMouseEnter(a);break;case "mouseleave":b.handleMouseLeave(a);break;case "contextmenu":b.handleContextMenu(a);break;case "dblclick":b.handleDblClick(a);break;default:a.type+" unhandled!"}}},__bindUI:function(){var a=c.start+" "+c.end+" "+c.tap;c.cancel&&(a+=" "+c.cancel);a+=" mouseenter mouseleave contextmenu "+
(g&&9>g?"dblclick ":"");this.$el.delegate(a,"."+this.__childClsTag,this.handleChildrenEvents,this)},getOwnerControl:function(a){return k.getComponent(a.currentTarget.id)}});return f});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:05
*/
KISSY.add("component/extension/content-render",["component/extension/content-xtpl"],function(e,g){function f(a){var b=a.control,c=b.get("contentEl");a.$contentEl=b.$contentEl=c;a.contentEl=b.contentEl=c[0]}function d(){}var h=g("component/extension/content-xtpl");d.prototype={__beforeCreateDom:function(a,b){e.mix(b,{contentEl:"#ks-content-{id}"})},__createDom:function(){f(this)},__decorateDom:function(){f(this)},getChildrenContainerEl:function(){return this.control.get("contentEl")},_onSetContent:function(a){var b=
this.control,c=b.$contentEl;c.html(a);b.get("allowTextSelection")||c.unselectable()}};e.mix(d,{ATTRS:{contentTpl:{value:h}},HTML_PARSER:{content:function(a){return a.one("."+this.getBaseCssClass("content")).html()},contentEl:function(a){return a.one("."+this.getBaseCssClass("content"))}}});return d});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:05
*/
KISSY.add("component/extension/content-xtpl",[],function(){return function(b){var a;a=this.config.utils;var d=a.renderOutput,e=a.runInlineCommand,f=a.getPropertyOrRunCommand;a='<div id="ks-content-';var c=f(this,b,{},"id",0,1);a+=d(c,!0);a+='"\n           class="';var c={},g=[];g.push("content");c.params=g;e=e(this,b,c,"getBaseCssClasses",2);a+=d(e,!0);a+='">';b=f(this,b,{},"content",0,2);a+=d(b,!1);return a+"</div>"}});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 10 01:46
*/
KISSY.add("component/extension/align",["node"],function(k,u){function m(a){var c=a.ownerDocument.body,d=j(a).css("position");if(!("fixed"===d||"absolute"===d))return"html"===a.nodeName.toLowerCase()?null:a.parentNode;for(a=a.parentNode;a&&a!==c;a=a.parentNode)if(d=j(a).css("position"),"static"!==d)return a;return null}function n(a){var c,d,b={left:0,right:Infinity,top:0,bottom:Infinity},f;f=a.ownerDocument;d=j(f).getWindow();c=f.body;for(f=f.documentElement;a=m(a);)if((!v.ie||0!==a.clientWidth)&&
a!==c&&a!==f&&"visible"!==j(a).css("overflow")){var h=j(a).offset();h.left+=a.clientLeft;h.top+=a.clientTop;b.top=Math.max(b.top,h.top);b.right=Math.min(b.right,h.left+a.clientWidth);b.bottom=Math.min(b.bottom,h.top+a.clientHeight);b.left=Math.max(b.left,h.left)}f=d.scrollLeft();a=d.scrollTop();b.left=Math.max(b.left,f);b.top=Math.max(b.top,a);c=d.width();d=d.height();b.right=Math.min(b.right,f+c);b.bottom=Math.min(b.bottom,a+d);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}function o(a,
c,d,b){var f,h;f=a.left;h=a.top;c=p(c,d[0]);a=p(a,d[1]);a=[a.left-c.left,a.top-c.top];return{left:f-a[0]+ +b[0],top:h-a[1]+ +b[1]}}function q(a,c,d){var b=[];k.each(a,function(a){b.push(a.replace(c,function(a){return d[a]}))});return b}function l(){}function r(a){var c,d;c=a[0];k.isWindow(c)?(a=j(c).getWindow(),c={left:a.scrollLeft(),top:a.scrollTop()},d=a.width(),a=a.height()):(c=a.offset(),d=a.outerWidth(),a=a.outerHeight());c.width=d;c.height=a;return c}function p(a,c){var d=c.charAt(0),b=c.charAt(1),
f=a.width,h=a.height,e,g;e=a.left;g=a.top;"c"===d?g+=h/2:"b"===d&&(g+=h);"c"===b?e+=f/2:"r"===b&&(e+=f);return{left:e,top:g}}function w(a){a.target===this&&a.newVal&&this._onSetAlign(this.get("align"))}function s(){this.get("visible")&&this._onSetAlign(this.get("align"))}var t=u("node"),x=k.Env.host,j=t.all,v=k.UA;l.__getOffsetParent=m;l.__getVisibleRectForElement=n;l.ATTRS={align:{value:{}}};l.prototype={__bindUI:function(){this.on("beforeVisibleChange",w,this);this.$el.getWindow().on("resize",s,
this)},_onSetAlign:function(a){a&&a.points&&this.align(a.node,a.points,a.offset,a.overflow)},align:function(a,c,d,b){var a=t.one(a||x),d=d&&[].concat(d)||[0,0],b=b||{},f=this.$el,h=0,e=n(f[0]),g=r(f),j=r(a),a=o(g,j,c,d),i=k.merge(g,a);if(e&&(b.adjustX||b.adjustY)){if(a.left<e.left||a.left+g.width>e.right)h=1,c=q(c,/[lr]/ig,{l:"r",r:"l"}),d[0]=-d[0];if(a.top<e.top||a.top+g.height>e.bottom)h=1,c=q(c,/[tb]/ig,{t:"b",b:"t"}),d[1]=-d[1];h&&(a=o(g,j,c,d),k.mix(i,a));c=b.adjustX&&(a.left<e.left||a.left+
g.width>e.right);b=b.adjustY&&(a.top<e.top||a.top+g.height>e.bottom);if(c||b)a=k.clone(a),i={width:g.width,height:g.height},c&&a.left<e.left&&(a.left=e.left),c&&a.left+i.width>e.right&&(a.left=Math.max(e.right-i.width,e.left)),b&&a.top<e.top&&(a.top=e.top),b&&a.top+i.height>e.bottom&&(a.top=Math.max(e.bottom-i.height,e.top)),i=k.mix(a,i)}this.set({x:i.left,y:i.top},{force:1});i.width!==g.width&&this.set("width",f.width()+i.width-g.width);i.height!==g.height&&this.set("height",f.height()+i.height-
g.height);return this},center:function(a){this.set("align",{node:a,points:["cc","cc"],offset:[0,0]});return this},__destructor:function(){this.$el&&this.$el.getWindow().detach("resize",s,this)}};return l});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:05
*/
KISSY.add("component/extension/shim",[],function(a){function b(){}var a=6===a.UA.ie,c='<iframe style="position: absolute;border: none;width: '+(a?"expression(this.parentNode.clientWidth)":"100%")+";top: 0;opacity: 0;filter: alpha(opacity=0);left: 0;z-index: -1;height: "+(a?"expression(this.parentNode.clientHeight)":"100%")+';"/>';b.ATTRS={shim:{value:a}};b.prototype.__createDom=function(){this.get("shim")&&this.get("el").prepend(c)};return b});
KISSY.add("mui/searchbar/plugin/spm",function(e,t,a){function r(t){r.superclass.constructor.call(this,e.merge({"spm":c},t||{}))}function i(e){for(var t;e&&"HTML"!=e.tagName&&"BODY"!=e.tagName&&e.getAttribute&&!(t=e.getAttribute(o))&&(e=e.parentNode););return t}function n(e){try{return t.get('meta[name="'+e+'"]')}catch(o){for(var a=t.query("meta"),r="",i=0,n=a.length;i<n;i++)if(a[i].name==e){r=a[i];break}return r}}var o="data-spm",s="spm",c="0.0.a2227oh.d100";return e.extend(r,a,{"pluginInitializer":function(e){this.set("caller",e),this.init()},"init":function(){var e=this.get("caller");e&&(e.get("sugConfig").extraParams[s]=this.get("spm"))}},{"ATTRS":{"pluginId":{"value":"spm"},"spm":{"value":c,"setter":function(e){var a=(e.split(".")||[]).reverse(),r={};r.d=a[0]||"0",r.c=a[1]||"0",r.b=a[2]||"0",r.a=a[3]||"0";var i=n("spm-id"),s=i?i.content:"";s||(i=n(o),s=i?i.content:"",s+="."+(t.attr(document.body,o)||""));var c=s.split(".")||[];return r.a=c[0]||r.a,r.b=c[1]||r.b,[r.a,r.b,r.c,r.d].join(".")},"getter":function(e){var t=(e.split(".")||[]).reverse(),a={},r=this.get("caller");if(r){var n,c=r.get("form"),u=c[0][s];if(u&&"INPUT"===u.tagName&&(n=(u.value.split(".")||[]).reverse(),t[0]=n[0]||t[0],t[1]=n[1]||t[1]),!t[1]&&"0"===a.c){var l=r.get("input"),m=r.get("container");t[1]=m.attr(o)||c.attr(o)||i(l[0])||t[1]}}return t.reverse().join(".")}}}}),r},{"requires":["dom","base"]});KISSY.add("mui/searchbar/plugin/placeholder",function(e,t,a){function r(e){this._tasks=[],r.superclass.constructor.call(this,e||{})}var i=window;return e.extend(r,a,{"pluginInitializer":function(t){if(this.set("caller",t),!t.get("placeholder")){var a=this.get("text"),r=t.get("input"),i=t.get("container"),n=r.attr("id"),o=t.get("sugConfig").prefixCls;!n&&r.attr("id",n=e.guid(o+"combobox-input")),t.comboBox.set("placeholderEl",e.all('<label for="'+n+'" class="'+o+'combobox-placeholder">'+a+"</label>").appendTo(i))}this._customizeText(),this._customizeInteraction(),this._customizeSearch()},"_customizeText":function(){var e=this.get("caller"),t=e.comboBox,a=t.get("placeholderEl"),r=this.get("text");a&&a.html(r),t.set("placeholder",r)},"_customizeInteraction":function(){function t(){""===e.trim(i.val())?r.css({"visibility":"visible"}):r.css({"display":"none","visibility":"hidden"})}var a=this.get("caller"),r=a.get("placeholder"),i=a.get("input"),n=this.get("colors");setTimeout(t,100),i.on("valuechange",t),r.css("color",n[1]),a.get("sugConfig").autoFocus&&r.css("color",n[0]),i.on("focus",function(){r.css("color",n[0]),""===e.trim(this.value)&&r.css({"display":"inline","visibility":"visible"})}),i.on("blur",function(){""===e.trim(this.value)&&""===e.trim(i.attr("value"))&&r.css({"color":n[1],"visibility":"visible"})}),i.on("keydown",function(t){var a=t.keyCode;32==a&&""===e.trim(this.value)?r.css({"visibility":"hidden"}):(a<13||a>37&&a<112||a>123)&&r.css({"visibility":"hidden"})}),i.on("keyup",function(e){var t=e.keyCode;""===this.value&&!(8==t||46==t)&&r.css({"display":"inline","visibility":"visible"})})},"_customizeSearch":function(){var a=this,r=this.get("query"),i=(this.get("text"),this.get("redirectUrl")),n=this.get("xiaoer"),o=this.get("caller"),s=o.get("input"),c=o.get("form"),u=o.get("dim"),l=o.get("log");if(r&&!this._eQueryFn?(o.on("beforeSubmit",this._eQueryFn=function(t){if(""===e.trim(s.val()))return s.val(a.get("query")),o.modifyFormParams({"from":u+"_"+n+"_placeholder"}),o.clicklog(","+a.get("query")+","+a.get("query")+","+u+"-,"+l.clickId+",placeholder,"+l.pageType+","+l.isMobile),setTimeout(function(){s.val("")},0),o.IGNORE_CLICK_LOG}),setTimeout(function(){o.exposelog("/msearch.3.3","searchbar-placeholder","dim="+u+"&q="+r+"&xiaoer="+n,"H46777406")},0)):!r&&this._eQueryFn&&(o.detach("beforeSubmit",this._eQueryFn),this._eQueryFn=null),r)this._eRedirectFn&&(o.detach("beforeSubmit",this._eRedirectFn),this._eRedirectFn=null);else{if(i&&!this._eRedirectFn)return c[0].redirect||c.append(t.create('<input type="hidden" name="redirect" value="" disabled="disabled" />')),void o.on("beforeSubmit",this._eRedirectFn=function(a){if(""===e.trim(s.val()))return c[0].redirect.value=i,t.removeAttr(c[0].redirect,"disabled"),o.modifyFormParams({"from":u+"_1_placeholder"}),o.clicklog(","+i+","+i+","+u+"-,"+l.clickId+",placeholder,"+l.pageType+","+l.isMobile),o.IGNORE_CLICK_LOG;c[0].redirect.value="",t.attr(c[0].redirect,"disabled","disabled")});!i&&this._eRedirectFn&&(o.detach("beforeSubmit",this._eRedirectFn),this._eRedirectFn=null)}!this._eEmptyFn&&o.on("beforeSubmit",this._eEmptyFn=function(t){return a._eQueryFn||a._eRedirectFn?(o.detach("beforeSubmit",a._eEmptyFn),void(a._eEmptyFn=null)):""===e.trim(s.val())?(a._emptyNotice(),!1):void 0})},"_reviseUrl":function(e){var t=i.TB&&TB.globalToolFn&&TB.globalToolFn.isDaily&&TB.globalToolFn.isDaily(),a="?spm=0.0.0.0",r=e.indexOf("?"),n=e.indexOf("#"),o=n<0?e.length:n;return t&&e.replace(/\b\/\/list.tmall.com\b/,"//list.daily.tmall.net"),r>0?e.replace("?",a+(r==o-1?"":"&")):e+a},"_emptyNotice":function(){var e=this.get("caller"),t=e.get("placeholder"),a=e.get("input");a._inFlash||(a._inFlash=!0,t.html("\u8bf7\u8f93\u5165\u5173\u952e\u5b57"),t.css("visibility","visible"),this._flashBackground())},"_flashBackground":function(){var a=this.get("caller"),r=a.get("input"),i={"background":r.css("background"),"borderLeftColor":r.css("border-left-color"),"zIndex":r.css("z-index")};r.css({"background":"none #fff","borderLeftColor":"#fdbd78","zIndex":e.UA.ie<8?-1:0}),this._flashBackgroundAnim(r,4,function(){t.css(r,i),r._inFlash=!1})},"_flashBackgroundAnim":function(t,a,r){var i=this;if(a<=0)return void(r&&r.call());new e.Anim(t,{"backgroundColor":a%2==0?"#fdbd78":"#fff"},.3,"easeNone",function(){i._flashBackgroundAnim(t,--a,r)}).run()},"renderPlugin":function(e){},"update":function(e){if(e&&"object"==typeof e){if(!this.get("caller"))return void this._tasks.push(["update",arguments]);e.text&&this.set("text",e.text),e.query&&this.set("query",e.query),e.redirectUrl&&this.set("redirectUrl",e.redirectUrl),e.xiaoer&&this.set("xiaoer",e.xiaoer),this._customizeText(),this._customizeSearch()}}},{"ATTRS":{"pluginId":{"value":"placeholder"},"colors":{"value":["#ccc","#666"]},"text":{"value":"\u641c\u7d22 \u5929\u732b \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa","setter":function(e){return"string"==typeof e?e:"\u641c\u7d22 \u5929\u732b \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa"}},"query":{"value":"","setter":function(e){return"string"==typeof e?e:""}},"redirectUrl":{"value":"","setter":function(e){return"string"==typeof e&&"notRedirect"!==e?e:""}},"xiaoer":{"value":0,"setter":function(e){return e?1:0}},"caller":{"value":undefined,"setter":function(e){if(e){var t=this;return setTimeout(function(){for(var e,a=t._tasks,r=0,i=a.length;r<i;r++)e=a.shift(),t[e[0]].apply(t,e[1])},10),e}}}}}),r},{"requires":["dom","base"]});KISSY.add("mui/searchbar/plugin/inShop",function(e,a,t,r){function i(e){i.superclass.constructor.call(this,e||{})}return e.extend(i,t,{"pluginInitializer":function(e){this.set("caller",e),this.init()},"init":function(){var a=this.get("caller");if(a){var t=a.get("input"),r=a.get("form"),i=a.get("dim"),n=a.get("log"),o=this.get("action"),s=this.get("button"),u=a.get("sugConfig").extraParams;s&&o&&s.on("click",function(){var s=e.trim(t.val());r.attr("data-action",r.attr("action")),r.attr("action",o);var c={"q":s,"type":"p","search":"y","newHeader_b":"s_from","searcy_type":"item","from":i+"_2_searchbutton"};u.spm&&(c.spm=u.spm.substr(0,u.spm.lastIndexOf(".")+1)+"d101"),a.filterFormParams(c),a.clicklog(","+t.val()+","+t.val()+","+i+"-,"+n.clickId+",inshopsrchbtn,2,"+n.isMobile),r.fire("submit",{"ignoreClicklog":1}),setTimeout(function(){r.attr("action",r.attr("data-action")),r.removeAttr("data-action")},0)})}}},{"ATTRS":{"pluginId":{"value":"inShop"},"action":{"value":"","setter":function(e){return e}},"button":{"value":"","setter":function(e){return r.one(e)}}}}),i},{"requires":["event","base","node"]});KISSY.add("mui/searchbar/template/act",function(e,t){return{"name":"act","text":"","promo":"49218","tpl":'<div class="{$prefixCls}mi-act" data-tpl="act" data-params="q={$query}&promo={promo}&type=p&xl={$wq}_1&from={$dim}_1_suggest"><span class="{$prefixCls}mi-cont-key">{$query}</span><span class="{$prefixCls}mi-cont-text">\u5728<b>{text}</b>\u4e0b\u641c\u7d22</span></div>',"atpanel":"{$index},{q},{$wq},{$dim}-sugAct,option,suggest,{$pageType},{$isMobile}","parse":function(t,a,r){var i=r.$query||"";if("undefined"!==i&&""!==e.trim(i)&&this.text){r.text=this.text,r.promo=this.promo;var n=e.substitute(this.tpl,r);t.push({"textContent":i,"content":n})}}}},{"requires":["ajax"]});KISSY.add("mui/searchbar/template/shipShop",function(e){return{"name":"shipShop","tpl":'<div class="{$prefixCls}mi-ship" data-tpl="shipShop" data-index="0" data-params="q={$query}&type=2&style=w&xl={$wq}_2&from={$dim}_2_suggest"><span class="{$prefixCls}mi-ship-wrap" data-url="{$shopUrl}"><img class="{$prefixCls}mi-ship-img" src="{$logo}"><span class="{$prefixCls}mi-ship-key">{$shopName}</span><i class="{$prefixCls}mi-ship-icon"></i></span></div>',"atpanel":"{$index},{q},{$wq},{$dim}-sugShop,{$userId},suggest,{$pageType},{$isMobile},2","parse":function(t,a,r){var i=r.$query,n=this;if(i&&a.shop_info&&a.shop_info.length)for(var o=0;o<a.shop_info.length;o++){e.each(a.shop_info[o],function(e,t){switch(t){case"shop_name":r.$shopName=e;break;case"logo":r.$logo="//img.alicdn.com/tfscom/"+e;break;case"shop_url":r.$shopUrl=e}}),r.$query=e.urlEncode(i);var s=e.substitute(n.tpl,r);t.push({"textContent":i,"content":s})}}}});KISSY.add("mui/searchbar/template/cat",function(e,t){return{"name":"cat","tpl":'<div class="{$prefixCls}mi-cat" data-tpl="cat" data-index="{$index}" data-params="q={$2}&cat={$1}&type=p&xl={$wq}_{$index}&from={$dim}_1_suggest"><span class="{$prefixCls}mi-cont-text">\u5728<b>{$0}</b>\u5206\u7c7b\u4e0b\u641c\u7d22</span></div>',"atpanel":"{$index},{q},{$wq},{$dim}-sugCat,{cat},suggest,{$pageType},{$isMobile}","parse":function(t,a,r){var i=a.cat;if(!a.tmall_noresult&&i&&e.isArray(i)&&!(a.result.length<1)){var n={"textContent":"","content":'<div class="{$prefixCls}mi-cat" data-tpl="cat" data-index="0" data-params="q={$2}&type=p&xl={$wq}_{$index}&from={$dim}_1_suggest"><span class="{$prefixCls}mi-cont-key">{$2}</span></div>'};t.push(n);for(var o=0,s=Math.min(i.length,2),c="";o<s;o++){r.$index=1+o;var u=i[o];if(e.isArray(u))for(var l=0;l<3;l++)r["$"+l]=u[l]||r.$query;c=e.substitute(this.tpl,r),n.textContent=r.$2,n.content=e.substitute(n.content,r),t.push({"textContent":r.$2,"content":c})}t.push({"content":'<div class="hr"/>',"disabled":!0})}}}},{"requires":["dom"]});KISSY.add("mui/searchbar/template/list",function(e){return{"name":"list","tpl":'<div class="{$prefixCls}mi-list" data-tpl="list" data-index="{$index}" data-params="q={$query}&type=p&xl={$wq}_{$index}&from={$dim}_1_suggest"><span class="{$prefixCls}mi-cont-key">{text}</span><span class="{$prefixCls}mi-cont-count">\u7ea6{count}\u4e2a\u7ed3\u679c</span><a class="{$prefixCls}mi-btn-backfill" href="javascript:;">\u56de\u586b</a></div>',"atpanel":"{$index},{q},{$wq},{$dim}-sugQuery,query,suggest,{$pageType},{$isMobile}","parse":function(t,a,r){var i=this,n=r.$query;a.tmall_noresult&&t.push({"content":'<div class="'+r.$prefixCls+'mi-noresult-tip">\u56e7\uff0c\u60a8\u8f93\u5165\u7684\u5173\u952e\u8bcd\u4e0b\u6ca1\u6709\u7ed3\u679c\uff0c\u8bd5\u8bd5\u8fd9\u4e9b\u5427\uff1a</div>',"disabled":!0}),e.each(a.result,function(o,s){if(!o||!o[0])return void a.result.splice(s,1);for(var c in t)if(t[c].textContent===o[0])return;var u=o[0],l=n;if(!u.match(/\<(\/)?\w\>/gi)){for(;u.indexOf(l)<0;)l=l.substr(0,l.length-1);var p=u.indexOf(l),d=p+l.length,m=u.substr(0,p),h=u.substr(d);m=m?"<b>"+m+"</b>":"",h=h?"<b>"+h+"</b>":"",u=m+l+h}r.$query=e.urlEncode(o[0].replace(/\<(\/)?\w\>/gi,"")),r.$index=s+1,r.text=u,r.count=o[1];var g=e.substitute(i.tpl,r);t.push({"textContent":e.urlDecode(r.$query),"content":g})})}}});KISSY.add("mui/searchbar/template/shop",function(e){return{"name":"shop","tpl":'<div class="{$prefixCls}mi-tip" data-tpl="shop" data-params="q={$query}&type=p&style=w&xl={$wq}_2&from={$dim}_2_suggest"><i></i>\u627e\u201c<b>{$text}</b>\u201d\u76f8\u5173<em>\u5e97\u94fa</em></div>',"atpanel":"{$index},{q},{$wq},{$dim}-sugShop,option,suggest,{$pageType}","parse":function(t,a,r){var i=r.$query;if(""!==e.trim(i)&&"undefined"!=i){r.$query=e.urlEncode(i),r.$text=i;var n=e.substitute(this.tpl,r);t.push({"textContent":i,"content":n})}}}});KISSY.add("mui/searchbar/template/quickSearch",function(e){return{"name":"quickSearch","tpl":'<p class="{$prefixCls}mi-qs"><i></i>\u6309\u5feb\u6377\u952e <em>shift</em> + <em>?</em> \u53ef\u4ee5\u968f\u65f6\u6253\u5f00\u5feb\u6377\u641c\u7d22\u6846\uff0c\u8d76\u7d27\u8bd5\u8bd5\u5427~</p>',"parse":function(t,a,r){var i=r.$query;if(""!==e.trim(i)){var n=e.substitute(this.tpl,r);t.push({"content":n,"disabled":!0})}}}});KISSY.add("mui/searchbar/plugin/hq4Pc",function(e,a,t,r,i){function o(e){o.superclass.constructor.call(this,e||{})}return e.extend(o,r,{"pluginInitializer":function(e){this.set("caller",e),this.init()},"init":function(){var e=this;this.get("url");e.get("data")&&e.get("data").length?this.fire("dataReady",{"data":e.get("data")}):this._render()},"_render":function(){var r=this;this.on("dataReady",function(i){var o=r.get("caller");if(o){var n=i.data,s=o.get("dim"),u={},c=[];c.push('<ul class="s-hot-query">'),u.dim=s,e.each(n,function(a,t){u.xiaoer=a.xiaoer?"1":"0",u.index=t+1,u.query=a.query,u.highlight=a.highlight?"hot-query-highlight":"",u.cat=a.cat;var r=e.substitute('<li class="{highlight}"><a href="javascript:;" data-params="q={query}&type=p&cat={cat}&click_id={query}&from={dim}_{xiaoer}.{index}_hq">{query}</a></li>',u);c.push(r)}),c.push("</ul>");var l=a.create(c.join("")),m=r.get("container");a.append(l,m),e.log("searchbar::show hot queries successfully!");var h=o.get("form"),d=o.get("sugConfig").extraParams,p=o.get("log");t.delegate(l,"click","a",function(t){var r=e.unparam(a.attr(t.currentTarget,"data-params"));d.spm&&(r.spm=d.spm.substr(0,d.spm.lastIndexOf(".")+1)+"d102"),o.filterFormParams(r),o.clicklog(","+r.q+","+r.q+","+s+"-,"+p.clickId+",hq,1,"+p.isMobile),h.attr("target","_blank"),h.fire("submit",{"ignoreClicklog":1}),h.attr("target","_self")})}})},"update":function(e){e&&"object"==typeof e&&(e.url&&this.set("url",e.url),e.data&&this.set("data",e.data),e.container&&this.set("container",e.container))}},{"ATTRS":{"pluginId":{"value":"hq4Pc"},"url":{"value":""},"container":{"value":document.body},"data":{"value":[],"setter":function(a){return e.isArray(a)?(this.fire("dataReady",{"data":a}),a):[]}}}}),o},{"requires":["dom","event","base","ajax"]});KISSY.add("mui/searchbar/template/meetingPlace",function(e,t,a){function r(){var e,a=t.query("meta")||[],r="0.0";for(e=0;e<a.length;e++)if("spm-id"===t.attr(a[e],"name")){r=t.attr(a[e],"content");break}return r}return{"name":"meetingPlace","tpl":'<div class="{$prefixCls}mi-meetingPC" data-tpl="meetingPlace" data-index="0" data-params="q={$query}&type=2&style=w&xl={$wq}_2&from={$dim}_2_suggest"><a class="{$prefixCls}mi-meetingPC-wrap" target="_blank" href="{$actionUrl}"><img class="{$prefixCls}mi-meetingPC-img" src="{$imgUrl}"></a></div>',"atpanel":"{$index},{q},{$wq},{$dim}-sugShop,{$userId},suggest,{$pageType},{$isMobile},2","parse":function(t,i,n){var o=n.$query,s=this;if(o&&i.banner&&i.banner.length)for(var c=0;c<i.banner.length;c++){e.each(i.banner[c],function(e,t){switch(t){case"bannerText":n.$bannerText=e;break;case"imgUrl":n.$imgUrl=e;break;case"actionUrl":n.$actionUrl=e}}),n.$query=e.urlEncode(o);var u=n.$actionUrl;try{var l=new a(n.$actionUrl),p=r()+".banner.1";l.query&&l.query.add("spm",p),n.$actionUrl=l.toString(!1)}catch(m){n.$actionUrl=u}var d=e.substitute(s.tpl,n);t.push({"textContent":o,"content":d})}}}},{"requires":["dom","uri"]});/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:17
*/
KISSY.add("overlay/extension/loading",["node"],function(h,e){function c(){}var g=e("node");c.prototype={loading:function(){this._loadingExtEl||(this._loadingExtEl=(new g('<div class="'+this.get("prefixCls")+'ext-loading" style="position: absolute;border: none;width: 100%;top: 0;left: 0;z-index: 99999;height:100%;*height: expression(this.parentNode.offsetHeight);"/>')).appendTo(this.$el));this._loadingExtEl.show()},unloading:function(){var b=this._loadingExtEl;b&&b.hide()}};return c});
KISSY.add("overlay/extension/mask",["node"],function(h,e){function c(a,b){var i=a.view.getBaseCssClasses("mask"),i=m('<div  style="width:'+(f?"expression(KISSY.DOM.docWidth())":"100%")+";left:0;top:0;height:"+(f?"expression(KISSY.DOM.docHeight())":"100%")+";position:"+(f?"absolute":"fixed")+';" class="'+i+" "+b+'">'+(f?'<iframe style="position:absolute;left:0;top:0;background:red;width: expression(this.parentNode.offsetWidth);height: expression(this.parentNode.offsetHeight);filter:alpha(opacity=0);z-index:-1;"></iframe>':
"")+"</div>").prependTo("body");i.unselectable();i.on("mousedown",function(a){a.preventDefault()});return i}function g(){}function b(a,i){var b=a.get("maskNode"),d=a.view.getBaseCssClasses("mask-hidden");i?b.removeClass(d):b.addClass(d)}function a(a,i,d,c){var f=a.effect||l;b(c,d);if(f!==l){var c=a.duration,a=a.easing,e=d?1:0;i.stop(1,1);i.css("display",d?l:"block");i[f+j[f][e]](c,function(){i.css("display","")},a)}}function i(i){var d=this.get("maskNode");if(i=i.newVal){var b=Number(this.$el.css("z-index"));
isNaN(b)||d.css("z-index",b)}a(this.get("mask"),d,i,this)}var d=h.UA,o=e("node"),f=6===d.ie,m=o.all;g.ATTRS={mask:{value:!1},maskNode:{}};var l="none",j={fade:["Out","In"],slide:["Up","Down"]};g.prototype={__renderUI:function(){this.get("mask")&&this.set("maskNode",c(this,this.get("visible")?"":this.view.getBaseCssClasses("mask-hidden")))},__bindUI:function(){var a,d;if(d=this.get("mask")){a=this.get("maskNode");if(d.closeOnClick)a.on(o.Gesture.tap,this.close,this);this.on("afterVisibleChange",i)}},
__destructor:function(){var a;(a=this.get("maskNode"))&&a.remove()}};return g});
KISSY.add("overlay/close-xtpl",[],function(){return function(h){var e,c=this;e=this.config.utils;var g=e.runBlockCommand,b=e.renderOutput,a=e.getProperty,i=e.runInlineCommand,d=e.getPropertyOrRunCommand;e="";var o={},f=[],a=a(c,h,"closable",0,1);f.push(a);o.params=f;o.fn=function(a){var f;f='\n<a href="javascript:void(\'close\')"\n   id="ks-overlay-close-';var e=d(c,a,{},"id",0,3);f+=b(e,!0);f+='"\n   class="';var e={},g=[];g.push("close");e.params=g;e=i(c,a,e,"getBaseCssClasses",4);f+=b(e,!0);f+=
"\"\n   role='button'>\n    <span class=\"";e={};g=[];g.push("close-x");e.params=g;a=i(c,a,e,"getBaseCssClasses",6);f+=b(a,!0);return f+'">close</span>\n</a>\n'};e+=g(c,h,o,"if",1);return e+"\n"}});
KISSY.add("overlay/overlay-xtpl",["overlay/close-xtpl","component/extension/content-xtpl"],function(h,e,c,g){return function(b){var a,i;a=this.config.utils;"undefined"!==typeof g&&g.kissy&&(i=g);var d=a.renderOutput,c=a.runInlineCommand;a="";var f={},m=[];m.push("overlay/close-xtpl");f.params=m;i&&(e("overlay/close-xtpl"),f.params[0]=i.resolveByName(f.params[0]));f=c(this,b,f,"include",1);a+=d(f,!1);a+="\n";f={};m=[];m.push("component/extension/content-xtpl");f.params=m;i&&(e("component/extension/content-xtpl"),
f.params[0]=i.resolveByName(f.params[0]));b=c(this,b,f,"include",2);return a+=d(b,!1)}});
KISSY.add("overlay/overlay-render",["component/container","./overlay-xtpl","component/extension/content-render"],function(h,e){var c=e("component/container"),g=e("./overlay-xtpl"),b=e("component/extension/content-render");return c.getDefaultRender().extend([b],{createDom:function(){this.fillChildrenElsBySelectors({closeBtn:"#ks-overlay-close-{id}"})}},{ATTRS:{contentTpl:{value:g}},HTML_PARSER:{closeBtn:function(a){return a.one("."+this.getBaseCssClass("close"))}}})});
KISSY.add("overlay/extension/overlay-effect",[],function(h){function e(a){var d=a.$el.clone(!0);d.css({visibility:"visible",overflow:"hidden"}).addClass(a.get("prefixCls")+"overlay-ghost");return a.__afterCreateEffectGhost(d)}function c(a,d,b){a.__effectGhost&&a.__effectGhost.stop(1,1);var f=a.$el,c=h.all,g=a.get("effect"),j=c(g.target),c=g.duration,j=h.mix(j.offset(),{width:j.width(),height:j.height()}),k=h.mix(f.offset(),{width:f.width(),height:f.height()}),n=e(a),g=g.easing;n.insertAfter(f);d?
(d=j,j=k):d=k;f.css("visibility","hidden");n.css(d);a.__effectGhost=n;n.animate(j,{duration:c,easing:g,complete:function(){a.__effectGhost=null;n.remove();f.css("visibility","");b()}})}function g(b,d,e){var f=b.$el,g=b.get("effect"),h=g.effect||"none",j=g.target;"none"===h&&!j?e():j?c(b,d,e):(b=g.duration,g=g.easing,j=d?1:0,f.stop(1,1),f.css({visibility:"visible",display:d?"none":"block"}),f[h+a[h][j]](b,function(){f.css({display:"block",visibility:""});e()},g))}function b(){}var a={fade:["Out","In"],
slide:["Up","Down"]};b.ATTRS={effect:{value:{effect:"",target:null,duration:0.5,easing:"easeOut"},setter:function(b){var d=b.effect;"string"===typeof d&&!a[d]&&(b.effect="")}}};b.prototype={__afterCreateEffectGhost:function(a){return a},_onSetVisible:function(a){var b=this;g(b,a,function(){b.fire(a?"show":"hide")})}};return b});
KISSY.add("overlay/control","component/container,component/extension/shim,component/extension/align,./extension/loading,./extension/mask,./overlay-render,./extension/overlay-effect".split(","),function(h,e){var c=e("component/container"),g=e("component/extension/shim"),b=e("component/extension/align"),a=e("./extension/loading"),i=e("./extension/mask"),d=e("./overlay-render"),o=e("./extension/overlay-effect"),f={hide:"hide",destroy:"destroy"};return c.extend([g,a,b,i,o],{bindUI:function(){var a=this,
b=a.get("closeBtn");if(b)b.on("click",function(b){a.close();b.preventDefault()})},close:function(){this[f[this.get("closeAction")]||"hide"]();return this}},{ATTRS:{contentEl:{},closable:{value:false,view:1},closeBtn:{view:1},closeAction:{value:"hide"},focusable:{value:false},allowTextSelection:{value:true},handleMouseEvents:{value:false},visible:{value:false},xrender:{value:d}},xclass:"overlay"})});
KISSY.add("overlay/dialog-xtpl",["overlay/close-xtpl"],function(h,e,c,g){return function(b){var a,c=this,d;a=this.config.utils;"undefined"!==typeof g&&g.kissy&&(d=g);var h=a.runBlockCommand,f=a.renderOutput,m=a.getProperty,l=a.runInlineCommand,j=a.getPropertyOrRunCommand;a="";var k={},n=[];n.push("overlay/close-xtpl");k.params=n;d&&(e("overlay/close-xtpl"),k.params[0]=d.resolveByName(k.params[0]));d=l(c,b,k,"include",1);a+=f(d,!1);a+='\n<div id="ks-content-';d=j(c,b,{},"id",0,2);a+=f(d,!0);a+='"\n     class="';
d={};k=[];k.push("content");d.params=k;d=l(c,b,d,"getBaseCssClasses",3);a+=f(d,!0);a+='">\n    <div class="';d={};k=[];k.push("header");d.params=k;d=l(c,b,d,"getBaseCssClasses",4);a+=f(d,!0);a+='"\n         style="\n';d={};k=[];n=m(c,b,"headerStyle",0,6);k.push(n);d.params=k;d.fn=function(a){var b;b=" \n ";var d=j(c,a,{},"xindex",0,7);b=b+f(d,true);b=b+":";a=j(c,a,{},".",0,7);b=b+f(a,true);return b+";\n"};a+=h(c,b,d,"each",6);a+='\n"\n         id="ks-stdmod-header-';d=j(c,b,{},"id",0,10);a+=f(d,!0);
a+='">';d=j(c,b,{},"headerContent",0,10);a+=f(d,!1);a+='</div>\n\n    <div class="';d={};k=[];k.push("body");d.params=k;d=l(c,b,d,"getBaseCssClasses",12);a+=f(d,!0);a+='"\n         style="\n';d={};k=[];n=m(c,b,"bodyStyle",0,14);k.push(n);d.params=k;d.fn=function(a){var b;b=" \n ";var d=j(c,a,{},"xindex",0,15);b=b+f(d,true);b=b+":";a=j(c,a,{},".",0,15);b=b+f(a,true);return b+";\n"};a+=h(c,b,d,"each",14);a+='\n"\n         id="ks-stdmod-body-';d=j(c,b,{},"id",0,18);a+=f(d,!0);a+='">';d=j(c,b,{},"bodyContent",
0,18);a+=f(d,!1);a+='</div>\n\n    <div class="';d={};k=[];k.push("footer");d.params=k;l=l(c,b,d,"getBaseCssClasses",20);a+=f(l,!0);a+='"\n         style="\n';l={};d=[];m=m(c,b,"footerStyle",0,22);d.push(m);l.params=d;l.fn=function(a){var b;b=" \n ";var d=j(c,a,{},"xindex",0,23);b=b+f(d,true);b=b+":";a=j(c,a,{},".",0,23);b=b+f(a,true);return b+";\n"};a+=h(c,b,l,"each",22);a+='\n"\n         id="ks-stdmod-footer-';h=j(c,b,{},"id",0,26);a+=f(h,!0);a+='">';b=j(c,b,{},"footerContent",0,26);a+=f(b,!1);
return a+'</div>\n</div>\n<div tabindex="0"></div>'}});
KISSY.add("overlay/dialog-render",["./overlay-render","./dialog-xtpl"],function(h,e){var c=e("./overlay-render"),g=e("./dialog-xtpl");return c.extend({beforeCreateDom:function(b){h.mix(b.elAttrs,{role:"dialog","aria-labelledby":"ks-stdmod-header-"+this.control.get("id")})},createDom:function(){this.fillChildrenElsBySelectors({header:"#ks-stdmod-header-{id}",body:"#ks-stdmod-body-{id}",footer:"#ks-stdmod-footer-{id}"})},getChildrenContainerEl:function(){return this.control.get("body")},_onSetBodyStyle:function(b){this.control.get("body").css(b)},
_onSetHeaderStyle:function(b){this.control.get("header").css(b)},_onSetFooterStyle:function(b){this.control.get("footer").css(b)},_onSetBodyContent:function(b){var a;a=this.control.get("body");a.html(b)},_onSetHeaderContent:function(b){var a;a=this.control.get("header");a.html(b)},_onSetFooterContent:function(b){var a;a=this.control.get("footer");a.html(b)}},{ATTRS:{contentTpl:{value:g}},HTML_PARSER:{header:function(b){return b.one("."+this.getBaseCssClass("header"))},body:function(b){return b.one("."+
this.getBaseCssClass("body"))},footer:function(b){return b.one("."+this.getBaseCssClass("footer"))},headerContent:function(b){return b.one("."+this.getBaseCssClass("header")).html()},bodyContent:function(b){return b.one("."+this.getBaseCssClass("body")).html()},footerContent:function(b){return(b=b.one("."+this.getBaseCssClass("footer")))&&b.html()}}})});
KISSY.add("overlay/dialog",["./control","./dialog-render","node"],function(h,e){var c=e("./control"),g=e("./dialog-render"),b=e("node"),c=c.extend({__afterCreateEffectGhost:function(a){var b=this.get("body");a.all("."+this.get("prefixCls")+"stdmod-body").css({height:b.height(),width:b.width()}).html("");return a},handleKeyDownInternal:function(c){if(this.get("escapeToClose")&&c.keyCode===b.KeyCode.ESC){if("select"!==c.target.nodeName.toLowerCase()||c.target.disabled)this.close(),c.halt()}else a:if(c.keyCode===
a){var d=this.$el,e=b.all(c.target),f=d.last();if(e.equals(d)&&c.shiftKey)f[0].focus(),c.halt();else if(e.equals(f)&&!c.shiftKey)this.focus(),c.halt();else if(e.equals(d)||d.contains(e))break a;c.halt()}},_onSetVisible:function(a,b){var c=this.el;if(a)this.__lastActive=c.ownerDocument.activeElement,this.focus(),c.setAttribute("aria-hidden","false");else{c.setAttribute("aria-hidden","true");try{this.__lastActive&&this.__lastActive.focus()}catch(f){}}this.callSuper(a,b)}},{ATTRS:{header:{view:1},body:{view:1},
footer:{view:1},bodyStyle:{value:{},view:1},footerStyle:{value:{},view:1},headerStyle:{value:{},view:1},headerContent:{value:"",view:1},bodyContent:{value:"",view:1},footerContent:{value:"",view:1},closable:{value:!0},xrender:{value:g},focusable:{value:!0},escapeToClose:{value:!0}},xclass:"dialog"}),a=b.KeyCode.TAB;return c});
KISSY.add("overlay/popup",["./control"],function(h,e){return e("./control").extend({initializer:function(){var c=this;c.get("trigger")&&("mouse"===c.get("triggerType")?(c._bindTriggerMouse(),c.on("afterRenderUI",function(){c._bindContainerMouse()})):c._bindTriggerClick())},_bindTriggerMouse:function(){var c=this,e=c.get("trigger"),b;c.__mouseEnterPopup=function(a){c._clearHiddenTimer();b=h.later(function(){c._showing(a);b=void 0},1E3*c.get("mouseDelay"))};e.on("mouseenter",c.__mouseEnterPopup);c._mouseLeavePopup=
function(){b&&(b.cancel(),b=void 0);c._setHiddenTimer()};e.on("mouseleave",c._mouseLeavePopup)},_bindContainerMouse:function(){this.$el.on("mouseleave",this._setHiddenTimer,this).on("mouseenter",this._clearHiddenTimer,this)},_setHiddenTimer:function(){var c=this;c._hiddenTimer=h.later(function(){c._hiding()},1E3*c.get("mouseDelay"))},_clearHiddenTimer:function(){this._hiddenTimer&&(this._hiddenTimer.cancel(),this._hiddenTimer=void 0)},_bindTriggerClick:function(){var c=this;c.__clickPopup=function(e){e.preventDefault();
if(c.get("toggle"))c[c.get("visible")?"_hiding":"_showing"](e);else c._showing(e)};c.get("trigger").on("click",c.__clickPopup)},_showing:function(c){this.set("currentTrigger",h.one(c.target));this.show()},_hiding:function(){this.set("currentTrigger",void 0);this.hide()},destructor:function(){var c=this.$el,e=this.get("trigger");e&&(this.__clickPopup&&e.detach("click",this.__clickPopup),this.__mouseEnterPopup&&e.detach("mouseenter",this.__mouseEnterPopup),this._mouseLeavePopup&&e.detach("mouseleave",
this._mouseLeavePopup));c.detach("mouseleave",this._setHiddenTimer,this).detach("mouseenter",this._clearHiddenTimer,this)}},{ATTRS:{trigger:{setter:function(c){return h.all(c)}},triggerType:{value:"click"},currentTrigger:{},mouseDelay:{value:0.1},toggle:{value:!1}},xclass:"popup"})});KISSY.add("overlay",["overlay/control","overlay/dialog","overlay/popup"],function(h,e){var c=e("overlay/control"),g=e("overlay/dialog"),b=e("overlay/popup");c.Dialog=g;h.Dialog=g;c.Popup=b;return h.Overlay=c});
!function(){function n(n,t,e){var r,i,a,o,f;r=function(n){function t(){var n="";for(var t in r)n+=t+"|";return n=n.slice(0,-1),a=new RegExp(n,"g")}var e,r={"&":"&amp;",">":"&gt;","<":"&lt;","`":"&#x60;","/":"&#x2F;",'"':"&quot;","'":"&#x27;"},i=/[&<>"'`]/,a=t(),o=/\\?\{([^{}]+)\}/g,f="undefined"!=typeof global?global:window,u=Object.prototype.toString;return n=e={isArray:Array.isArray||function(n){return"[object Array]"===u.call(n)},keys:Object.keys||function(n){var t,e=[];for(t in n)n.hasOwnProperty(t)&&e.push(t);return e},each:function(n,t,r){if(n){var i,a,o,f=0,u=n&&n.length,s=void 0===u||"[object Function]"===Object.prototype.toString.call(n);if(r=r||null,s)for(o=e.keys(n);f<o.length&&(i=o[f],t.call(r,n[i],i,n)!==!1);f++);else for(a=n[0];u>f&&t.call(r,a,f,n)!==!1;a=n[++f]);}return n},mix:function(n,t){for(var e in t)n[e]=t[e];return n},globalEval:function(n){f.execScript?f.execScript(n):!function(n){f.eval.call(f,n)}(n)},substitute:function(n,t,e){return"string"==typeof n&&t?n.replace(e||o,function(n,e){return"\\"===n.charAt(0)?n.slice(1):void 0===t[e]?"":t[e]}):n},escapeHtml:function(n){return n=""+n,i.test(n)?(n+"").replace(a,function(n){return r[n]}):n},merge:function(){for(var n=0,t=arguments.length,r={};t>n;n++){var i=arguments[n];i&&e.mix(r,i)}return r}}}(),i=function(n){function t(n,t,e){this.data=void 0!==n?n:{},e?(this.parent=e,this.root=e.root):(this.parent=void 0,this.root=this),this.affix=t||{},this.ready=!1}return t.prototype={isScope:1,constructor:t,setParent:function(n){this.parent=n,this.root=n.root},set:function(n,t){this.affix[n]=t},setData:function(n){this.data=n},getData:function(){return this.data},mix:function(n){var t=this.affix;for(var e in n)t[e]=n[e]},get:function(n){var t,e=this.data,r=this.affix;return null!=e&&(t=e[n]),void 0!==t?t:r[n]},resolveInternalOuter:function(n){var t,e=n[0],r=this,i=r;if("this"===e)t=r.data;else if("root"===e)i=i.root,t=i.data;else{if(!e)return[i.data];do t=i.get(e);while(void 0===t&&(i=i.parent))}return[void 0,t]},resolveInternal:function(n){var t=this.resolveInternalOuter(n);if(1===t.length)return t[0];var e,r=n.length,i=t[1];if(void 0===i)return void 0;for(e=1;r>e;e++)i=i[n[e]];return i},resolveLooseInternal:function(n){var t=this.resolveInternalOuter(n);if(1===t.length)return t[0];var e,r=n.length,i=t[1];for(e=1;null!=i&&r>e;e++)i=i[n[e]];return i},resolveUp:function(n){return this.parent&&this.parent.resolveInternal(n)},resolveLooseUp:function(n){return this.parent&&this.parent.resolveLooseInternal(n)},resolveOuter:function(n,t){var e,r=this,i=r;if(!t&&1===n.length){if(e=r.get(n[0]),void 0!==e)return[e];t=1}if(t)for(;i&&t--;)i=i.parent;return i?[void 0,i]:[void 0]},resolveLoose:function(n,t){var e=this.resolveOuter(n,t);return 1===e.length?e[0]:e[1].resolveLooseInternal(n)},resolve:function(n,t){var e=this.resolveOuter(n,t);return 1===e.length?e[0]:e[1].resolveInternal(n)}},n=t}(),a=function(n){function t(n,t,e){this.list=n,this.init(),this.next=t,this.ready=!1,this.tpl=e}function e(n,e){var r=this;r.config=e,r.head=new t(r,void 0),r.callback=n,this.init()}var i=r;return t.prototype={constructor:t,isBuffer:1,init:function(){this.data=""},append:function(n){return this.data+=n,this},write:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=n}return this},writeEscaped:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=i.escapeHtml(n)}return this},insert:function(){var n=this,e=n.list,r=n.tpl,i=new t(e,n.next,r),a=new t(e,i,r);return n.next=a,n.ready=!0,a},async:function(n){var t=this.insert(),e=t.next;return n(t),e},error:function(n){var t=this.list.callback;if(t){var e=this.tpl;if(e){n instanceof Error||(n=new Error(n));var r=e.name,i=e.pos.line,a="XTemplate error in file: "+r+" at line "+i+": ";n.stack=a+n.stack,n.message=a+n.message,n.xtpl={pos:{line:i},name:r}}this.list.callback=null,t(n,void 0)}},end:function(){var n=this;return n.list.callback&&(n.ready=!0,n.list.flush()),n}},e.prototype={constructor:e,init:function(){this.data=""},append:function(n){this.data+=n},end:function(){this.callback(null,this.data),this.callback=null},flush:function(){for(var n=this,t=n.head;t;){if(!t.ready)return n.head=t,void 0;this.data+=t.data,t=t.next}n.end()}},e.Buffer=t,n=e}(),o=function(n){var t=i,e=r,a={range:function(n,t){var e=t.params,r=e[0],i=e[1],a=e[2];a?(r>i&&a>0||i>r&&0>a)&&(a=-a):a=r>i?-1:1;for(var o=[],f=r;i>r?i>f:f>i;f+=a)o.push(f);return o},foreach:function(n,e,r){var i,a,o,f,u=e.params,s=u[0],l=u[2]||"xindex",c=u[1];if(s)for(i=s.length,f=0;i>f;f++)a=new t(s[f],{xcount:i,xindex:f},n),o=a.affix,"xindex"!==l&&(o[l]=f,o.xindex=void 0),c&&(o[c]=s[f]),r=e.fn(a,r);return r},forin:function(n,e,r){var i,a,o,f=e.params,u=f[0],s=f[2]||"xindex",l=f[1];if(u)for(o in u)i=new t(u[o],{xindex:o},n),a=i.affix,"xindex"!==s&&(a[s]=o,a.xindex=void 0),l&&(a[l]=u[o]),r=e.fn(i,r);return r},each:function(n,t,r){var i=t.params,o=i[0];return o?e.isArray(o)?a.foreach(n,t,r):a.forin(n,t,r):r},"with":function(n,e,r){var i=e.params,a=i[0];if(a){var o=new t(a,void 0,n);r=e.fn(o,r)}return r},"if":function(n,t,e){var r=t.params,i=r[0];if(i){var a=t.fn;a&&(e=a(n,e))}else{var o=!1,f=t.elseIfs,u=t.inverse;if(f)for(var s=0,l=f.length;l>s;s++){var c=f[s];if(o=c.test(n)){e=c.fn(n,e);break}}!o&&u&&(e=u(n,e))}return e},set:function(n,t,e){for(var r=t.hash,i=r.length,a=0;i>a;a++){var o=r[a],f=o.key,u=o.depth,s=o.value;if(1===f.length){for(var l=n.root;u&&l!==n;)n=n.parent,--u;n.set(f[0],s)}else{var c=n.resolve(f.slice(0,-1),u);c&&(c[f[f.length-1]]=s)}}return e},include:1,parse:1,extend:1,block:function(n,t,e){var r,i=this,a=i.runtime,o=t.params,f=o[0];2===o.length&&(r=o[0],f=o[1]);var u,s=a.blocks=a.blocks||{},l=s[f],c={fn:t.fn,type:r};if(l){if(l.type)if("append"===l.type)c.next=l,s[f]=c;else if("prepend"===l.type){var d;for(u=l;u&&"prepend"===u.type;)d=u,u=u.next;c.next=u,d.next=c}}else s[f]=c;if(!a.extendTpl)for(u=s[f];u;)u.fn&&(e=u.fn.call(i,n,e)),u=u.next;return e},macro:function(n,e,r){var i=e.hash,a=e.params,o=a[0],f=a.slice(1),u=this,s=u.runtime,l=s.macros=s.macros||{},c=l[o];if(e.fn)l[o]={paramNames:f,hash:i,fn:e.fn};else if(c){var d,v=c.hash||{};if(d=c.paramNames)for(var h=0,p=d.length;p>h;h++){var m=d[h];v[m]=f[h]}if(i)for(var g in i)v[g]=i[g];var x=new t(v);x.root=n.root,r=c.fn.call(u,x,r)}else{var y="can not find macro: "+o;r.error(y)}return r}};return a["debugger"]=function(){},n=a}(),f=function(n){function t(n,t,e,r,i,a,o,f){this.name=n,this.originalName=a||n,this.runtime=t,this.root=e,this.pos={line:1},this.scope=r,this.buffer=i,this.fn=o,this.parent=f}function e(n,t,e){var r=e[0],i=n&&n[r]||t&&t[r]||g[r];if(1===e.length)return i;if(i)for(var a=e.length,o=1;a>o;o++)if(i=i[e[o]],!i)return!1;return i}function f(n,t){var e=n.split("/"),r=t.split("/");e.pop();for(var i=0,a=r.length;a>i;i++){var o=r[i];"."===o||(".."===o?e.pop():e.push(o))}return e.join("/")}function u(n,t,r,i,a,o){var f,u,s;if(o||(s=e(n.runtime.commands,n.root.config.commands,a)),s)return s.call(n,t,r,i);if(s!==!1&&(f=t.resolve(a.slice(0,-1),o),u=f[a[a.length-1]]))try{return u.apply(f,r.params||[])}catch(l){return i.error("Execute function `"+a.join(".")+"` Error: "+l.message),i}return i.error("Command Not Found: "+a.join(".")),i}function s(n,t){var e=this;e.fn=n,e.config=p.merge(s.globalConfig,t),this.subNameResolveCache={}}function l(n,t,e){if("."!==t.charAt(0))return t;var r=e+"_ks_"+t,i=n.subNameResolveCache,a=i[r];return a?a:t=i[r]=f(e,t)}function c(n,t,e,r,i,a){var o=l(n,a,i.name),f=r.insert(),u=f.next;return v(n,o,i.runtime,t,f,a,e,r.tpl),u}function d(n,e,r,i,a){var o=r.insert(),f=o.next,u=new t(a.TPL_NAME,i.runtime,n,e,o,void 0,a,r.tpl);return o.tpl=u,h(u),f}function v(n,e,r,i,a,o,f,u){var s=new t(e,r,n,i,a,o,void 0,u);a.tpl=s,n.config.loader.load(s,function(n,t){"function"==typeof t?(s.fn=t,h(s)):n?a.error(n):(t=t||"",f?a.writeEscaped(t):a.data+=t,a.end())})}function h(n){var t=n.fn();if(t){var e,r=n.runtime,i=r.extendTpl;if(i&&(e=i.params[0],!e))return t.error("extend command required a non-empty parameter");var a=r.extendTplFn,o=r.extendTplBuffer;return a?(r.extendTpl=null,r.extendTplBuffer=null,r.extendTplFn=null,d(n.root,n.scope,o,n,a).end()):e&&(r.extendTpl=null,r.extendTplBuffer=null,c(n.root,n.scope,0,o,n,e).end()),t.end()}}var p=r,m=o,g={},x=i,y=a,w={callFn:u,callDataFn:function(n,t){for(var e=t[0],r=e,i=1;i<t.length;i++){var a=t[i];if(!r||null==r[a])return"";e=r,r=r[a]}return r.apply(e,n||[])},callCommand:function(n,t,e,r,i){return u(n,t,e,r,i)}};return p.mix(s,{config:function(n,t){var e=this.globalConfig=this.globalConfig||{};return arguments.length?(void 0!==t?e[n]=t:p.mix(e,n),void 0):e},nativeCommands:m,utils:w,util:p,addCommand:function(n,t){g[n]=t},removeCommand:function(n){delete g[n]}}),s.prototype={constructor:s,Scope:x,nativeCommands:m,utils:w,removeCommand:function(n){var t=this.config;t.commands&&delete t.commands[n]},addCommand:function(n,t){var e=this.config;e.commands=e.commands||{},e.commands[n]=t},include:function(n,t,e,r){var i,a=t.params;i=n;var o=t.hash,f=t&&t.escape;return o&&(i=new x(o,void 0,n)),a[0]?e=c(this,i,f,e,r,a[0]):e.error("include command required a non-empty parameter")},includeModule:function(n,t,e,r){var i=t.params,a=n,o=t.hash;return o&&(a=new x(o,void 0,n)),i[0]?e=d(this,a,e,r,i[0]):e.error("include command required a non-empty parameter")},render:function(n,e,r){var i="",a=this,o=a.fn,f=a.config;"function"==typeof e&&(r=e,e=null),e=e||{},r=r||function(n,t){if(n)throw n instanceof Error||(n=new Error(n)),n;i=t};var u=a.config.name;!u&&o&&o.TPL_NAME&&(u=o.TPL_NAME);var l;l=n instanceof x?n:new x(n);var c=new s.LinkedBuffer(r,f).head,d=new t(u,{commands:e.commands},a,l,c,u,o);return c.tpl=d,o?(h(d),i):(f.loader.load(d,function(n,t){t?(d.fn=a.fn=t,h(d)):n&&c.error(n)}),i)}},s.Scope=x,s.LinkedBuffer=y,n=s}(),e.exports=f}if(window.KISSY)KISSY.add("kg/xtemplate/4.1.4/runtime",[],function(t,e,r,i){n(e,r,i)});else{if(!window.define)throw new Error("Can't found any module manager, such like Kissy CMD AMD SeaJS and etc.");define("kg/xtemplate/4.1.4/runtime",[],n)}}();