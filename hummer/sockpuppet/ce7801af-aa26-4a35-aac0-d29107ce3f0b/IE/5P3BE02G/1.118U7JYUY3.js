KISSY.add("malldetail/other/a11y",function(e,t,a,n,i){var o=e.all,r=n.instance(),l=function(){};l.prototype={"constructor":l,"init":function(){a.attr("#J_DetailMeta","role","form"),a.attr("#mainwrap","role","main"),a.attr("#footer,#page-footer","role","contentinfo"),a.attr("#J_DcShopArchive","role","complementary")}};var c=function(){};c.prototype={"constructor":c,"init":function(){var e=a.query("#J_UlThumb img");a.attr(e,"alt","\u5546\u54c1\u9884\u89c8\u56fe")}};var s=function(){};s.prototype={"constructor":s,"init":function(){var e=a.query("textarea.ks-datalazyload");a.attr(e,"tabindex","-1")}};var d=function(){};d.prototype={"constructor":d,"select":function(e,t){if(t){var n=a.text(e)||null;n&&a.attr(e,"aria-label",n+"\uff0c\u5df2\u9009\u62e9")}else a.removeAttr(e,"aria-label")},"init":function(){var t=this,n=a.query(".tb-sku","#detail"),i=a.query("ul.J_TSaleProp li,ul.tm-relate-list li,ul.serviceList li,ul li.j_CateTab,ul.j_Area li,ul li[data-planid]",n),o=a.query("a,span[title]",i);a.attr(o,"role","button"),a.attr(o,"tabindex","0"),r.onChange(["selectedSkuProp","skuPropSelectivity","thirdPartyInventory"],function(n){e.each(o,function(e){var i=a.parent(e,function(e){return!0}),o=i&&i.getAttribute("data-value")?i.getAttribute("data-value"):"",l=o.split(":");l[1]?(n[l[0]]==l[1]?t.select(e,!0):t.select(e,!1),r.canSelectSkuProp(o,"",function(t){t<=0?a.attr(e,"aria-disabled",!0):a.removeAttr(e,"aria-disabled")})):a.hasClass(i,"tm-relate-current")||a.hasClass(i,"tb-selected")?t.select(e,!0):t.select(e,!1),a.hasClass(e,"wt-area-name")&&a.attr(e,"aria-haspopup",!0)})})}};var u=function(){};u.prototype={"init":function(){var t=a.query(".tb-sku","#detail"),n=a.query("ul.serviceList",t),i=a.query("li",n),o=a.query("a",i),l=function(t){e.each(o,function(e){var n=a.parent(e,function(e){return!!e.getAttribute("data-value")}),i=n?n.getAttribute("data-value"):"";if(t&&t[i]&&t[i].checked||a.hasClass(n,"tb-selected")){var o=a.text(e)||null;o&&a.attr(e,"aria-label",o+"\uff0c\u5df2\u9009\u62e9")}else a.removeAttr(e,"aria-label")})};l(),r.onChange(["cacheSelectedService","currentService"],function(e){e&&l(e)})}};var m=function(){};m.prototype={"constructor":m,"init":function(){o(".tb-action a").attr("role","button")}};var p=function(){};p.prototype={"constructor":p,"init":function(){setTimeout(function(){try{var e=o('#J_TabBar li[role="tab"]');e.each(function(e,t){a.prop(this,"index",t)});var n=o("#J_TabBar li.tm-selected").item(0).prop("index");t.delegate(document,"keydown","#J_TabBar",function(a){function i(){n++,n==e.length&&(n=0),e[n]&&(t.fire(e[n],"click"),e[n].focus())}function r(){n--,-1==n&&(n=e.length-1),e[n]&&(t.fire(e[n],"click"),e[n].focus())}var l=a.keyCode;switch(n=o("#J_TabBar li.tm-selected").item(0).prop("index"),l){case 37:case 38:r(),a.preventDefault(),a.stopPropagation();break;case 39:case 40:i()}})}catch(i){}},1e3)}};var f=function(t){var a=0,n={"objs":[]};this.config=e.mix(n,t),this.keyCount=function(){return++a}};return f.prototype={"init":function(){this.initEvent(),this.load(this.config)},"load":function(e){if(e&&e.objs)for(var t=e.objs,a=0;a<t.length;a++)try{t[a].init()}catch(n){}},"initEvent":function(){var e=this,a=function(n){9==n.keyCode&&e.keyCount()>2&&(t.detach("body","keyup",a),window.goldlog&&goldlog.record("/tmalldetail.a11y.tab","CLK","","H47671267"))};t.delegate(document,"keydown","[role=button],[role=tab]",function(e){32!=e.keyCode&&13!=e.keyCode||(e.preventDefault(),e.target.click())}),t.on("body","keyup",a)}},new f({"objs":[new d,new m,new u,new s,new c,new l,new p]})},{"requires":["event","dom","detail-model/product","ua"]});